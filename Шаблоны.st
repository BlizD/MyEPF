{1,
{117,
{"Мой",1,0,"",""},
{0,
{"Коммент",0,1,"Ком[мент]","// { АЛП Иванов А.Б., <?"""", ДатаВремя, ""ДФ='dd.MM.yyyy HH:mm'""> №АЛП027305 ИсправитьФормулировкиВОтчетахПоВидамКонтроля
<?>                                                                        
// } АЛП Иванов А.Б., <?"""", ДатаВремя, ""ДФ='dd.MM.yyyy HH:mm'""> №АЛП027305 ИсправитьФормулировкиВОтчетахПоВидамКонтроля"}
},
{11,
{"СКД",1,0,"",""},
{0,
{"СКД_ПриКомпановкеРезультата",0,0,"","Процедура ПриКомпоновкеРезультата(ДокументРезультат, ДанныеРасшифровки, СтандартнаяОбработка)
	СтандартнаяОбработка=Ложь;
	Схема=ЭтотОбъект.ПолучитьМакет(""ОсновнаяСхемаКомпоновкиДанных"");
	//Настройки=Схема.НастройкиПоУмолчанию;
	Настройки = ЭтотОбъект.КомпоновщикНастроек.ПолучитьНастройки();
	ДанныеРасшифровки=Новый ДанныеРасшифровкиКомпоновкиДанных;
	
	Параметр=Настройки.ПараметрыДанных.НайтиЗначениеПараметра(Новый ПараметрКомпоновкиДанных(""ДатаНач""));
	Если Параметр<>Неопределено тогда
		Параметр.Значение=НачалоДня(ДатаНач);
		Параметр.Использование=Истина;
	конецесли;
	Параметр=Настройки.ПараметрыДанных.НайтиЗначениеПараметра(Новый ПараметрКомпоновкиДанных(""ДатаКон""));
	Если Параметр<>Неопределено тогда
		Параметр.Значение=Новый Граница(КонецДня(ДатаКон),ВидГраницы.Включая);
		//Параметр.Значение=КонецДня(ДатаКон);
		Параметр.Использование=Истина;
	конецесли;
	
	Параметр=Настройки.ПараметрыДанных.НайтиЗначениеПараметра(Новый ПараметрКомпоновкиДанных(""ТипЦен""));
	Если ТипЦен.БазовыйТипЦен<>Справочники.ТипыЦенНоменклатуры.ПустаяСсылка() тогда
		Параметр.Значение=ТипЦен.БазовыйТипЦен;
	иначе
		Параметр.Значение=ТипЦен;
	конецесли;
	Параметр.Использование=Истина;
	
	Параметр=Настройки.ПараметрыДанных.НайтиЗначениеПараметра(Новый ПараметрКомпоновкиДанных(""ПроцентСкидки""));
	Если ТипЦен.БазовыйТипЦен<>Справочники.ТипыЦенНоменклатуры.ПустаяСсылка() тогда
		Параметр.Значение=-ТипЦен.ПроцентСкидкиНаценки/100;
		Параметр.Использование=Истина;
	Иначе
		Параметр.Значение=0;
		Параметр.Использование=Истина;			
	конецесли;
	
	
	
	Параметр=Настройки.ПараметрыДанных.НайтиЗначениеПараметра(Новый ПараметрКомпоновкиДанных(""СписокСкладов""));
	//СписокСкладов=Новый СписокЗначений();
	//СписокСкладов.Добавить(Справочники.Склады.НайтиПоКоду(""000000020""));  //Склад ГП №1
	//СписокСкладов.Добавить(Справочники.Склады.НайтиПоКоду(""000000021""));  //Склад ГП №5
	СписокСкладов=новый Массив();
	СписокСкладов.Добавить(Справочники.Склады.НайтиПоКоду(""000000020""));
	СписокСкладов.Добавить(Справочники.Склады.НайтиПоКоду(""000000021""));
	Параметр.Значение=СписокСкладов;
	Параметр.Использование=Истина;
	
	Параметр=Настройки.ПараметрыДанных.НайтиЗначениеПараметра(Новый ПараметрКомпоновкиДанных(""ДатаЦены""));
	Параметр.Значение=ДатаКон;
	Параметр.Использование=Истина;
	
	
	Параметр=Настройки.ПараметрыДанных.НайтиЗначениеПараметра(Новый ПараметрКомпоновкиДанных(""Организация""));
	Параметр.Значение=Справочники.Организации.НайтиПоКоду(""000000001"");
	Параметр.Использование=Истина;
	
	//Заголовок
	Заголовок=Настройки.ПараметрыВывода.НайтиЗначениеПараметра(Новый ПараметрКомпоновкиДанных(""Заголовок""));
	Заголовок.Значение=""Выпущено и перемещено на Склады ГП с ""+Формат(ДатаНач,""ДФ=dd.MM.yyyy"") + "" по "" +Формат(ДатаКон,""ДФ=dd.MM.yyyy"")+Символы.ПС+""Тип цен: ""+ ТипЦен;
	
	
	КомпоновщикМакета=Новый КомпоновщикМакетаКомпоновкиДанных;	
	Макет=КомпоновщикМакета.Выполнить(Схема,Настройки,ДанныеРасшифровки);
	ПроцессорКомпоновки=Новый ПроцессорКомпоновкиДанных;
	ПроцессорКомпоновки.Инициализировать(Макет,,ДанныеРасшифровки);
	
	
	ПроцессорВывода=Новый ПроцессорВыводаРезультатаКомпоновкиДанныхВТабличныйДокумент;
	//ТабДок=Новый ТабличныйДокумент;
	ПроцессорВывода.УстановитьДокумент(ДокументРезультат);
	ПроцессорВывода.Вывести(ПроцессорКомпоновки);
	//ТабДок.Показать();
КонецПроцедуры"}
},
{0,
{"РасшифровкаСКД",0,0,"","Процедура РезультатОбработкаРасшифровки(Элемент, Расшифровка, СтандартнаяОбработка)
	//(Антон 
	МассивПолейРасшифровки = ПолучитьМассивПолейРасшифровки(Расшифровка, ЭтаФорма.ДанныеРасшифровки);		
	//Антон)	
КонецПроцедуры

//(Антон 
Функция ПолучитьМассивПолейРасшифровки(Расшифровка, ДанныеРасшифровки, ТекущийОтчет = Неопределено, ВключатьРесурсы = Ложь) Экспорт
	
	МассивПолейРасшифровки = Новый Массив;
	
	Если ТипЗнч(Расшифровка) <> Тип(""ИдентификаторРасшифровкиКомпоновкиДанных"") 
		И ТипЗнч(Расшифровка) <> Тип(""ДанныеРасшифровкиКомпоновкиДанных"") Тогда
		Возврат МассивПолейРасшифровки;
	КонецЕсли;
	
	Если ТекущийОтчет = Неопределено Тогда
		ТекущийОтчет = ДанныеРасшифровки;
	КонецЕсли;
	
	// Добавим поля родительских группировок
	ДобавитьРодителей(ДанныеРасшифровки.Элементы[Расшифровка], ТекущийОтчет, МассивПолейРасшифровки, ВключатьРесурсы);
	
	Количество = МассивПолейРасшифровки.Количество();
	Для Индекс = 1 По Количество Цикл
		ОбратныйИндекс = Количество - Индекс;
		Для ИндексВнутри = 0 По ОбратныйИндекс - 1 Цикл
			Если МассивПолейРасшифровки[ОбратныйИндекс].Поле = МассивПолейРасшифровки[ИндексВнутри].Поле Тогда
				МассивПолейРасшифровки.Удалить(ОбратныйИндекс);
				Прервать;
			КонецЕсли;
		КонецЦикла;
	КонецЦикла;
	
	// Добавим отбор, установленный в отчете
	Для каждого ЭлементОтбора Из ТекущийОтчет.Настройки.Отбор.Элементы Цикл
		Если Не ЭлементОтбора.Использование Тогда
			Продолжить;
		КонецЕсли;
		МассивПолейРасшифровки.Добавить(ЭлементОтбора);
	КонецЦикла;
	
	Возврат МассивПолейРасшифровки;
	
КонецФункции
Функция ДобавитьРодителей(ЭлементРасшифровки, ТекущийОтчет, МассивПолейРасшифровки, ВключатьРесурсы = Ложь)  Экспорт
	
	Если ТипЗнч(ЭлементРасшифровки) = Тип(""ЭлементРасшифровкиКомпоновкиДанныхПоля"") Тогда
		Для каждого Поле Из ЭлементРасшифровки.ПолучитьПоля() Цикл
			ДоступноеПоле = ПолучитьДоступноеПолеПоПолюКомпоновкиДанных(Новый ПолеКомпоновкиДанных(Поле.Поле), ТекущийОтчет);
			Если ДоступноеПоле = Неопределено Тогда
				Продолжить;
			КонецЕсли;
			Если Не ВключатьРесурсы И ДоступноеПоле.Ресурс Тогда
				Продолжить;
			КонецЕсли;
			МассивПолейРасшифровки.Добавить(Поле);
		КонецЦикла;
	КонецЕсли;
	Для каждого Родитель Из ЭлементРасшифровки.ПолучитьРодителей() Цикл
		ДобавитьРодителей(Родитель, ТекущийОтчет, МассивПолейРасшифровки, ВключатьРесурсы);
	КонецЦикла;
	
КонецФункции
Функция ПолучитьДоступноеПолеПоПолюКомпоновкиДанных(ПолеКомпоновкиДанных, ОбластьПоиска) Экспорт
	
	Если ТипЗнч(ПолеКомпоновкиДанных) = Тип(""Строка"") Тогда
		ПолеПоиска = Новый ПолеКомпоновкиДанных(ПолеКомпоновкиДанных);
	Иначе
		ПолеПоиска = ПолеКомпоновкиДанных;
	КонецЕсли;
	
	Если ТипЗнч(ОбластьПоиска) = Тип(""КомпоновщикНастроекКомпоновкиДанных"")
		ИЛИ ТипЗнч(ОбластьПоиска) = Тип(""ДанныеРасшифровкиКомпоновкиДанных"")
		ИЛИ ТипЗнч(ОбластьПоиска) = Тип(""НастройкиВложенногоОбъектаКомпоновкиДанных"") Тогда
		Возврат ОбластьПоиска.Настройки.ДоступныеПоляВыбора.НайтиПоле(ПолеПоиска);
	Иначе
		Возврат ОбластьПоиска.НайтиПоле(ПолеПоиска);
	КонецЕсли;
	
КонецФункции
//Антон)


//Второй вариант
Процедура ПолеРезультатОбработкаРасшифровки(Элемент, Расшифровка, СтандартнаяОбработка)
	Перем ВыполненноеДействие;
	СтандартнаяОбработка=Ложь;	
	СтруктураРасшифровки=Новый Структура();
	//Для тонкого клиента надо получать ДанныеРасшифровкиОбъект = ПолучитьИзВременногоХранилища(ДанныеРасшифровки);
	//где ДанныеРасшифровки это строковый реквизит на форме отчета
	СтрокаРасшифровки=ДанныеРасшифровки.Элементы[Расшифровка];
	ПолучитьСтруктуруРасшифровки(СтрокаРасшифровки,СтруктураРасшифровки);
	Для каждого ЭлементыСтруктуры из СтруктураРасшифровки цикл
		Сообщить(""""+ЭлементыСтруктуры.Ключ+""=""+ЭлементыСтруктуры.Значение);
	Конеццикла;
КонецПроцедуры
Процедура ПолучитьСтруктуруРасшифровки(СтрокаРодительРасшифровки,СтруктураРасшифровки)
	Если ТипЗнч(СтрокаРодительРасшифровки) = Тип(""ЭлементРасшифровкиКомпоновкиДанныхГруппировка"") Тогда
		РасшифровкиРодитель=СтрокаРодительРасшифровки.ПолучитьРодителей();	
		Для каждого СтрокаРасшифровкиРодитель из РасшифровкиРодитель  цикл
			ПолучитьСтруктуруРасшифровки(СтрокаРасшифровкиРодитель,СтруктураРасшифровки);	
	    Конеццикла;
	ИначеЕсли ТипЗнч(СтрокаРодительРасшифровки) = Тип(""ЭлементРасшифровкиКомпоновкиДанныхПоля"") Тогда
		РасшифровкиРодитель=СтрокаРодительРасшифровки.ПолучитьРодителей();	
		Для каждого СтрокаРасшифровкиРодитель из РасшифровкиРодитель  цикл
			ПолучитьСтруктуруРасшифровки(СтрокаРасшифровкиРодитель,СтруктураРасшифровки);	
	    Конеццикла;
		
		ПолеЗначение=СтрокаРодительРасшифровки.ПолучитьПоля();
		Для каждого СтрокаПолеЗначение из ПолеЗначение цикл
			СтруктураРасшифровки.Вставить(СтрокаПолеЗначение.Поле,СтрокаПолеЗначение.Значение);							
		Конеццикла;		
	Конецесли;
КонецПроцедуры
"}
},
{0,
{"СКД_ЗначениеПараметра",0,0,"СКД[ЗначениеПараметра]","ЗначениеПараметра = КомпоновщикНастроек.Настройки.ПараметрыДанных.НайтиЗначениеПараметра(Новый ПараметрКомпоновкиДанных(""мСтатусЗаказаПокупателя_Подтвержден""));
Если ЗначениеПараметра <> Неопределено Тогда
	ЗначениеПараметра.Значение=мСтатусЗаказаПокупателя_Подтвержден;
	ЗначениеПараметра.Использование=Истина;	
Конецесли;
"}
},
{0,
{"ГруппировкаСКД",0,0,"","

ПоследняяГруппировка=Неопределено;
ПоследняяГруппировка=ПолучитьПоследнююГруппировку(НастройкиРасшифровки.Структура,ПоследняяГруппировка);
//ГруппировкаРасшифровки=НастройкиРасшифровки.Структура.Добавить(Тип(""ГруппировкаКомпоновкиДанных""));
//ГруппировкаРасшифровки=ПоследняяГруппировка;
ГруппировкаРасшифровки=ПоследняяГруппировка.Структура.Добавить(Тип(""ГруппировкаКомпоновкиДанных""));
ГруппировкаРасшифровки.Использование=Истина;
ПолеГруппировкиРасшифровки=ГруппировкаРасшифровки.ПоляГруппировки.Элементы.Добавить(Тип(""ПолеГруппировкиКомпоновкиДанных""));
ПолеГруппировкиРасшифровки.Использование=Истина;
ПолеГруппировкиРасшифровки.Поле=Новый ПолеКомпоновкиДанных(ВыбранноеПолеРасшифровки);
АвтоПоле=ГруппировкаРасшифровки.Выбор.Элементы.Добавить(Тип(""АвтоВыбранноеПолеКомпоновкиДанных""));
АвтоПоле.Использование=Истина;
НастройкиРасшифровки.Отбор.Элементы.Очистить();
Для каждого ЭлементОтбора из ОтборНастройки.Элементы цикл
	ЭлементНастройкиОтбор=НастройкиРасшифровки.Отбор.Элементы.Добавить(Тип(""ЭлементОтбораКомпоновкиДанных""));
	ЗаполнитьЗначенияСвойств(ЭлементНастройкиОтбор,ЭлементОтбора);
конеццикла;

//(Антон
Функция ПолучитьПоследнююГруппировку(СтруктураНастроек,ПоследняяГруппировка)
	//НастройкиРасшифровки.Структура.Количество()
	НС=0;
	Пока НС<=СтруктураНастроек.Количество() и ПоследняяГруппировка = Неопределено цикл		
		ЭлементСтруктурыНастроек=СтруктураНастроек[НС];
		Если ЭлементСтруктурыНастроек.Структура.Количество()>0 тогда
			ПолучитьПоследнююГруппировку(ЭлементСтруктурыНастроек.Структура,ПоследняяГруппировка)
		иначе
			ПоследняяГруппировка=ЭлементСтруктурыНастроек;
			//Возврат ЭлементСтруктурыНастроек.Структура; 
		конецесли;		
		НС=НС+1;
	конеццикла;
	возврат ПоследняяГруппировка;	
КонецФункции
//Антон)
"}
},
{0,
{"ВыбранноеДействие",0,0,"","	Настройки = ОбработкаРасшифровки.Выполнить(Расшифровка, ВыполненноеДействие, ДоступныеДействия);
	Если ВыполненноеДействие=ДействиеОбработкиРасшифровкиКомпоновкиДанных.Расшифровать тогда
		ВыбранноеПолеРасшифровки=Настройки.Структура[0].ПоляГруппировки.Элементы[0].Поле;
		ОтборНастройки=Настройки.Отбор;
	конецесли;
"}
},
{0,
{"УстановкаОтбора",0,0,"","&НаСервере
Процедура ПередЗагрузкойПользовательскихНастроекНаСервере(Настройки)
	ЭлементыНастроек = Настройки.Элементы;
	Для каждого СтрокаЭлементыНастроек из ЭлементыНастроек цикл
		Если ТипЗНч(СтрокаЭлементыНастроек)= Тип(""ОтборКомпоновкиДанных"") Тогда
			ЕстьОтборПоАвтору=Ложь;
			ЭлементыОтбора = СтрокаЭлементыНастроек.Элементы;
			Для каждого ЭлементОтбора из ЭлементыОтбора цикл
				Если ЭлементОтбора.ЛевоеЗначение = Новый ПолеКомпоновкиДанных(""ЗаявкаНаЗакупку.Автор"") Тогда
					ЭлементОтбора.Использование = Истина;
					ЭлементОтбора.ПравоеЗначение = ПараметрыСеанса.Пользователь;
					ЕстьОтборПоАвтору = Истина;					
				Конецесли;					
			Конеццикла;
			Если НЕ ЕстьОтборПоАвтору Тогда
				ЭлементОтбора = ЭлементыОтбора.Добавить(Тип(""ЭлементОтбораКомпоновкиДанных""));
				ЭлементОтбора.ЛевоеЗначение = Новый ПолеКомпоновкиДанных(""ЗаявкаНаЗакупку.Автор"");      
				ЭлементОтбора.Использование = Истина;
				ЭлементОтбора.ПравоеЗначение = ПараметрыСеанса.Пользователь;				
			Конецесли;
		Конецесли;
	Конеццикла;
КонецПроцедуры
"}
},
{0,
{"ВычислитьВыражениеСГруппировкойВМассив",0,0,"","//Сумма(ВычислитьВыражениеСГруппировкойМассив(""Максимум(СуммаЗаявкиНаЗакупку)"",""ЗаявкаНаЗакупку""))


//СУММА(ВычислитьВыражениеСГруппировкойМассив(""ВЫБОР КОГДА Максимум(СуммаПоступленияПоЗаявкеНаЗакупку) - Сумма(СуммаЗаявкиНаОплату) > 0 ТОГДА 
//	Максимум(СуммаПоступленияПоЗаявкеНаЗакупку) - Сумма(СуммаЗаявкиНаОплату) 
//ИНАЧЕ 
//	0 
//КОНЕЦ
//"",""ЗаявкаНаЗакупку""))"}
},
{0,
{"ВыполнитьСКДВТаблицуЗначений",0,0,"","ОтчетОбъект = Отчеты.фнмСостояниеАвтомобилей.Создать();


СхемаКомпоновкиДанных = ОтчетОбъект.СхемаКомпоновкиДанных;
КомпоновщикНастроек = ОтчетОбъект.КомпоновщикНастроек;

ИмяВарианта = СписокВариантов;
Для Каждого ЭлВариантНастроек ИЗ СхемаКомпоновкиДанных.ВариантыНастроек Цикл
	Если ЭлВариантНастроек.Имя =ИмяВарианта Тогда
		КомпоновщикНастроек.ЗагрузитьНастройки(ЭлВариантНастроек.Настройки);
		Прервать;		
	Конецесли;
КонецЦикла;

ЭлементыОтбора = КомпоновщикНастроек.Настройки.Отбор.Элементы;
ЭлементыОтбора.Очистить();
ЭлементОтбора = ЭлементыОтбора.Добавить(Тип(""ЭлементОтбораКомпоновкиДанных""));
ЭлементОтбора.ВидСравнения = ВидСравненияКомпоновкиДанных.Равно;
ЭлементОтбора.Использование = Истина;
ЭлементОтбора.ЛевоеЗначение = Новый ПолеКомпоновкиДанных(""Автомобиль"");
ЭлементОтбора.ПравоеЗначение = Автомобиль;

КомпоновщикМакета = Новый КомпоновщикМакетаКомпоновкиДанных;
ПроцессорКомпоновкиДанных = Новый ПроцессорКомпоновкиДанных;
ПроцессорВывода = Новый ПроцессорВыводаРезультатаКомпоновкиДанныхВКоллекциюЗначений;
ТаблицаЗначений = Новый ТаблицаЗначений;
	
МакетКомпоновкиДанных = КомпоновщикМакета.Выполнить(СхемаКомпоновкиДанных, КомпоновщикНастроек.Настройки, , , Тип(""ГенераторМакетаКомпоновкиДанныхДляКоллекцииЗначений""));
ПроцессорКомпоновкиДанных.Инициализировать(МакетКомпоновкиДанных);
ПроцессорВывода.УстановитьОбъект(ТаблицаЗначений);
ПроцессорВывода.Вывести(ПроцессорКомпоновкиДанных);	
"}
},
{0,
{"СКД на основне ТЗ",0,0,"","Процедура ПриКомпоновкеРезультата(ДокументРезультат, ДанныеРасшифровки, СтандартнаяОбработка)
	ТЗТехника = фнмCareTrackWebServiceНовый.ПолучитьТЗТехника_СВебСервиса();
	СтандартнаяОбработка = Ложь;
	СхемаКомпоновкиДанных = ПолучитьМакет(""ОсновнаяСхемаКомпоновкиДанных"");
	Настройки = СхемаКомпоновкиДанных.НастройкиПоУмолчанию;
	ДанныеРасшифровки = Новый ДанныеРасшифровкиКомпоновкиДанных;
	КомпоновщикМакета = Новый КомпоновщикМакетаКомпоновкиДанных;
	МакетКомпоновки = КомпоновщикМакета.Выполнить(СхемаКомпоновкиДанных, Настройки, ДанныеРасшифровки);
	ВнешнийНаборДанных = Новый Структура(""ТЗТехника"", ТЗТехника);
	ПроцессорКомпоновкиДанных = Новый ПроцессорКомпоновкиДанных;
	ПроцессорКомпоновкиДанных.Инициализировать(МакетКомпоновки, ВнешнийНаборДанных, ДанныеРасшифровки);	
	ПроцессорВывода = Новый ПроцессорВыводаРезультатаКомпоновкиДанныхВТабличныйДокумент;
	ПроцессорВывода.УстановитьДокумент(ДокументРезультат);
	ПроцессорВывода.Вывести(ПроцессорКомпоновкиДанных);	
КонецПроцедуры
"}
},
{0,
{"Условие через СКД макет",0,0,"","
//+ ФОРМА ЭЛЕМЕНТА
&НаСервере
Процедура ПриСозданииНаСервере(Отказ, СтандартнаяОбработка)
	Если ЗначениеЗаполнено(Объект.ИдентификаторОбъектаМетаданных) Тогда
		пОбъект = РеквизитФормыВЗначение(""Объект"");
		пНастройкиКомпоновщика = пОбъект.НастройкиКомпоновщикаХранилище.Получить();
		ОпределитьОтборНаСервере(пНастройкиКомпоновщика);
	Конецесли;
КонецПроцедуры

&НаСервере
Функция ОпределитьОтборНаСервере(пНастройкиКомпоновщика = Неопределено) Экспорт
	МакетСКД = Справочники.фнмОпределениеРасчетнойСтатьи.ПолучитьМакетСКДДляИдентификаторОбъектаМетаданных(Объект.ИдентификаторОбъектаМетаданных);
	
	АдресВременногоХранилищаМакетаСКД = ПоместитьВоВременноеХранилище(МакетСКД,Новый УникальныйИдентификатор());
	
	ИсточникНастроек = Новый ИсточникДоступныхНастроекКомпоновкиДанных(АдресВременногоХранилищаМакетаСКД);
	КомпоновщикНастроекКомпоновкиДанных.Инициализировать(ИсточникНастроек);
	
	Если пНастройкиКомпоновщика = Неопределено Тогда
		КомпоновщикНастроекКомпоновкиДанных.ЗагрузитьНастройки(МакетСКД.НастройкиПоУмолчанию);
	Иначе
		КомпоновщикНастроекКомпоновкиДанных.ЗагрузитьНастройки(пНастройкиКомпоновщика);
	Конецесли;
КонецФункции

&НаКлиенте
Процедура ПередЗаписью(Отказ, ПараметрыЗаписи)
	Объект.АдресВременногоХранилища = ПоместитьВоВременноеХранилище(КомпоновщикНастроекКомпоновкиДанных.Настройки,Новый УникальныйИдентификатор());	
КонецПроцедуры

&НаКлиенте
Процедура КомпоновщикНастроекКомпоновкиДанныхНастройкиОтборПриОкончанииРедактирования(Элемент, НоваяСтрока, ОтменаРедактирования)
	СформироватьНаименование();
КонецПроцедуры

&НаКлиенте
Процедура СформироватьНаименование()
	Объект.Наименование = """"+ Объект.ИдентификаторОбъектаМетаданных +""_"" + КомпоновщикНастроекКомпоновкиДанных.Настройки.Отбор;
КонецПроцедуры 

&НаКлиенте
Процедура ИдентификаторОбъектаМетаданныхПриИзменении(Элемент)
	ОпределитьОтборНаСервере();
КонецПроцедуры

&НаКлиенте
Процедура КомпоновщикНастроекКомпоновкиДанныхНастройкиОтборПриИзменении(Элемент)
	СформироватьНаименование();
КонецПроцедуры

//- ФОРМА ЭЛЕМЕНТА

//+МОДУЛЬ МЕНЕДЖЕРА
Функция УсловиеВыполнено(Источник,ОпределениеРасчетнойСтатьи) Экспорт 
	пУсловиеВыполнено = Ложь;
	
	пНастройкиКомпоновщика = ОпределениеРасчетнойСтатьи.НастройкиКомпоновщикаХранилище.Получить();
	пИдентификаторОбъектаМетаданных = ОпределениеРасчетнойСтатьи.ИдентификаторОбъектаМетаданных;
	
	МакетКомпоновкиДанных = ПолучитьМакетКомпоновкиДанных(пИдентификаторОбъектаМетаданных,пНастройкиКомпоновщика);
	
	пТекстЗапроса = МакетКомпоновкиДанных.НаборыДанных.НаборДанных1.Запрос;
	Запрос = Новый Запрос();
	Запрос.Текст = пТекстЗапроса;
	Запрос.УстановитьПараметр(""Ссылка"",Источник.Ссылка);
	
	Для каждого Параметр из МакетКомпоновкиДанных.ЗначенияПараметров цикл
		Запрос.УстановитьПараметр(Параметр.Имя,Параметр.Значение);	
	Конеццикла; 
	
	РезультатЗапроса = Запрос.Выполнить();
	пУсловиеВыполнено = НЕ РезультатЗапроса.Пустой();		
	
	Возврат пУсловиеВыполнено;
КонецФункции //УсловиеВыполнено(ДопПараметры,Отказ)

Функция СформироватьТекстЗапроса(ИдентификаторОбъектаМетаданных, НастройкиКомпоновщика) Экспорт 
	МакетКомпоновкиДанных = ПолучитьМакетКомпоновкиДанных(ИдентификаторОбъектаМетаданных,НастройкиКомпоновщика);	
	пТекстЗапроса = МакетКомпоновкиДанных.НаборыДанных.НаборДанных1.Запрос;
	Возврат пТекстЗапроса;
КонецФункции //СформироватьТекстЗапроса()

Функция ПолучитьМакетКомпоновкиДанных(ИдентификаторОбъектаМетаданных,НастройкиКомпоновщика) Экспорт 
	СхемаКомпоновкиДанныхКонсоли = ПолучитьМакетСКДДляИдентификаторОбъектаМетаданных(ИдентификаторОбъектаМетаданных);
	
	Группировка = НастройкиКомпоновщика.Структура.Добавить(Тип(""ГруппировкаКомпоновкиДанных""));
	Группировка.Использование = Истина;
	ПолеГруппировки = Группировка.ПоляГруппировки.Элементы.Добавить(Тип(""ПолеГруппировкиКомпоновкиДанных""));
	ПолеГруппировки.Использование = Истина;
	ВыбранноеПоле           = Группировка.Выбор.Элементы.Добавить(Тип(""ВыбранноеПолеКомпоновкиДанных""));
	ВыбранноеПоле.Поле      = Новый ПолеКомпоновкиДанных(""Ссылка"");
	ВыбранноеПоле.Заголовок = ""Ссылка"";

	ИсполняемыеНастройки = НастройкиКомпоновщика;
	КомпоновщикМакета = Новый КомпоновщикМакетаКомпоновкиДанных;
	МакетКомпоновкиДанных = КомпоновщикМакета.Выполнить(СхемаКомпоновкиДанныхКонсоли, ИсполняемыеНастройки);
	Возврат МакетКомпоновкиДанных;
КонецФункции //ПолучитьМакетКомпоновкиДанных()

Функция ПолучитьМакетСКДДляИдентификаторОбъектаМетаданных(ИдентификаторОбъектаМетаданных) Экспорт 
	Если НЕ ЗначениеЗаполнено(ИдентификаторОбъектаМетаданных) Тогда
		Возврат Неопределено;
	Конецесли;
	
	МакетСКД = Новый СхемаКомпоновкиДанных; 
    
    // определим источник данных для схемы 
    Источник = МакетСКД.ИсточникиДанных.Добавить();
    Источник.Имя = ""ЛокальнаяБаза"";
    Источник.СтрокаСоединения = """";
    Источник.ТипИсточникаДанных = ""Local""; 
    
    НаборДанных = МакетСКД.НаборыДанных.Добавить(Тип(""НаборДанныхЗапросСхемыКомпоновкиДанных""));
    НаборДанных.Имя = ""НаборДанных1"";
    НаборДанных.ИсточникДанных = ""ЛокальнаяБаза"";
    НаборДанных.АвтоЗаполнениеДоступныхПолей = Истина;	
	
	пИмяМетаданных = ИдентификаторОбъектаМетаданных.ИмяМетаданных;
	
	пМенеджерОбъекта = ИдентификаторОбъектаМетаданных.МенеджерОбъекта;
	пМенеджерОбъектаДляЗапроса = ИдентификаторОбъектаМетаданных.МенеджерОбъектаДляЗапроса;
	
	пТекстЗапроса = ""ВЫБРАТЬ
	|	ЗапросКРеквизитамОбъекта.Ссылка КАК Ссылка"";
	МетаданныеРеквизиты = Метаданные[пМенеджерОбъекта][пИмяМетаданных].Реквизиты;
	Для каждого пРеквизит из МетаданныеРеквизиты цикл
		пТекстЗапроса = пТекстЗапроса + ""
		|	,""+пРеквизит.Имя + "" КАК ""+пРеквизит.Имя + """";			
	Конеццикла;
	пТекстЗапроса = пТекстЗапроса + ""
	|ИЗ
	|	""+пМенеджерОбъектаДляЗапроса+"".""+пИмяМетаданных+"" КАК ЗапросКРеквизитамОбъекта
	|ГДЕ
	|	ЗапросКРеквизитамОбъекта.Ссылка = &Ссылка	
	|"";
	НаборДанных.Запрос = (пТекстЗапроса);
    
    // добавим поля
    НаборДанных.АвтоЗаполнениеДоступныхПолей = Истина;
	
	Возврат МакетСКД;
КонецФункции //ПолучитьСКДДляОбъектаБД()

//-МОДУЛЬ МЕНЕДЖЕРА

//+ МОДУЛЬ ОБЪЕКТА
Процедура ПередЗаписью(Отказ)
	
	ТекстЗапроса = """";
	ТекстПроизвольногоУсловия = """";
	пНастройкиКомпоновщика = ПолучитьИзВременногоХранилища(АдресВременногоХранилища);
	НастройкиКомпоновщикаХранилище = Новый ХранилищеЗначения(пНастройкиКомпоновщика);
	
	ТекстЗапроса = Справочники.фнмОпределениеРасчетнойСтатьи.СформироватьТекстЗапроса(ИдентификаторОбъектаМетаданных, пНастройкиКомпоновщика);
КонецПроцедуры
//- МОДУЛЬ ОБЪЕКТА"}
},
{0,
{"СкомпоноватьРезультат",0,0,"","//Модуль отчета

ТабДокумент = Новый ТабличныйДокумент;

пОтчет = ЭтотОбъект;

пОтчет.СкомпоноватьРезультат(ТабДокумент);

Возврат ТабДокумент;
"}
}
},
{1,
{"Консолидация",1,0,"",""},
{0,
{"ПолучениеЗначениеПараметраВнешнейИБЧерезСОМ",0,0,"","ЭкземпляОтчетаОбъект = ЭкземплярОтчета.ПолучитьОбъект();

ВнешняяБаза = ЭкземпляОтчетаОбъект.ИспользуемаяИБ;	
База = ОбщегоНазначения.ПолучитьСоединение (глТаблицаПодключений, ВнешняяБаза, 1);
пфнмКодДляСинхронизации = ЭкземпляОтчетаОбъект.Организация.фнмОрганизация.фнмКодДляСинхронизации;
ОрганизацияCOM = База.Справочники.Организации.НайтиПоРеквизиту(""фнмКодДляСинхронизации"",пфнмКодДляСинхронизации); 
ЗначениеПараметра = ОрганизацияCOM;
Сообщить(""ЗначениеПараметра ""+ЗначениеПараметра.Наименование);
"}
}
},
{1,
{"АльфаАвто",1,0,"",""},
{0,
{"ПраваАльфа",0,0,"","//Модуль объекта
Перем Права Экспорт;


// Стандартный обработчик копирования объекта
Процедура ПриКопировании(ОбъектКопирования)	
	Если НЕ спПриКопировании(ЭтотОбъект, ОбъектКопирования) Тогда 
		Возврат; 
	КонецЕсли;
КонецПроцедуры


Процедура ПередЗаписью(Отказ)
	Если НЕ спПередЗаписью(ЭтотОбъект, Отказ) Тогда 
		Возврат; 
	КонецЕсли;
	
	Если Отказ Тогда
		Возврат;
	Конецесли;
	
КонецПроцедуры

// Стандартный обработчик ПриЗаписи элемента справочника
Процедура ПриЗаписи(Отказ)		
	Если НЕ спПриЗаписи(ЭтотОбъект, Отказ) Тогда 
		Возврат; 
	КонецЕсли;
КонецПроцедуры

// Стандартный обработчик ПередУдалением элемента
Процедура ПередУдалением(Отказ)
	Если НЕ спПередУдалением(ЭтотОбъект, Отказ) Тогда Возврат; КонецЕсли;
КонецПроцедуры

// Проверяет корректность заполнения объекта.
// Возвращает Истина если все заполнено корректно и Ложь иначе.
// В случае некорректного заполнения формирует строку описанием возникших ошибок ""Ошибки""
// На вход может быть передана структура ДопРеквизиты с дополнительными реквизитами для проверки
// может управляться булевыми флагами выполняемых проверок Заполнение, Уникальность
// (могут быть и другие необязательные)
// Обычно выполняется универсальным обработчиком, но могут быть добавлены доп. проверки
//
// Параметры:
//  Ошибки 			– Строка		– Описание ошибок.
//  ДопРеквизиты	– Структура		– Дополнительные реквизиты для проверки.
//  Заполнение		– Булево		– Флаг для проверки заполнения.
//  Уникальность	– Булево		– Флаг для проверки уникальности.
//
// Возвращаемое значение:
//   Булево				   			– Правильность заполнения объекта.
//
Функция ПроверитьКорректность(Ошибки="""", ДопРеквизиты=Неопределено, Заполнение=Истина, Уникальность=Истина) Экспорт
	Возврат спПроверитьКорректность(ЭтотОбъект, Ошибки, ДопРеквизиты, Заполнение, Уникальность);
КонецФункции // ПроверитьКорректность()

// Возвращает структуру обязательных / уникальных реквизитов элемента
// Если ДляЭлемента = Истина, возвращаемая структура содержит реквизиты для проверки элемента
// Если ДляГруппы = Истина, аналогично для группы
// Возвращаемая структура содержит строковые идентификаторы реквизитов или вложенные структуры для табличных частей
// Для реквизита значение структуры содержит число 1-Обязательный, 3-Уникальный
Функция ПолучитьОбязательныеРеквизиты(ДляЭлемента=Истина, ДляГруппы=Ложь) Экспорт
	ОбязательныеРеквизиты=Новый Структура();
	Возврат ОбязательныеРеквизиты;
КонецФункции

"}
}
},
{28,
{"УпрФормы",1,0,"",""},
{0,
{"СКД открыть отчет",0,0,"","// { АЛП Мишин Е.В., 27.10.2020  Задача № АЛП027381_ПФ
&НаКлиенте
Процедура Расш_КиДКомандаАЛП_ОткрытьОтчетПланФактныйАнализПосле(Команда)
	ИмяОтчета = ""АЛП_ПланФактныйАнализПоГрафикамДоговоров"";
	ПараметрыОткрытия = ПолучитьПараметрыОткрытияОтчета(ИмяОтчета, Объект.ДоговорКонтрагента);
		
	ОткрытьФорму(""Отчет.""+ИмяОтчета+"".Форма"", ПараметрыОткрытия, ЭтотОбъект);
КонецПроцедуры		// } АЛП Мишин Е.В., 27.10.2020  Задача № АЛП027381_ПФ

// { АЛП Мишин Е.В., 27.10.2020  Задача № АЛП027381_ПФ
&НаСервереБезКонтекста
Функция ПолучитьПараметрыОткрытияОтчета(ИмяОтчета, ДоговорКонтрагента)
	ОбъектОтчет = Отчеты[ИмяОтчета].Создать();
	КомпоновщикНастроек = ОбъектОтчет.КомпоновщикНастроек;
	УникИденНастройки = Новый УникальныйИдентификатор;
	
	ОбщегоНазначенияКлиентСервер.УстановитьЭлементОтбора(КомпоновщикНастроек.Настройки.Отбор, ""ДоговорКонтрагента"", ДоговорКонтрагента,
					ВидСравненияКомпоновкиДанных.Равно,,Истина,РежимОтображенияЭлементаНастройкиКомпоновкиДанных.БыстрыйДоступ,УникИденНастройки);
					
	ПараметрыОткрытия = Новый Структура;
	ПараметрыОткрытия.Вставить(""СформироватьПриОткрытии"", Истина);
	ПараметрыОткрытия.Вставить(""Вариант"", КомпоновщикНастроек.Настройки);
	ПараметрыОткрытия.Вставить(""ПользовательскиеНастройки"", КомпоновщикНастроек.ПользовательскиеНастройки);
	ПараметрыОткрытия.Вставить(""РежимПоНастройкамКомпоновки"");
	ПараметрыОткрытия.Вставить(""Заголовок "", ""План-фактный анализ по графикам договоров"");
	
	Возврат ПараметрыОткрытия;
КонецФункции		// } АЛП Мишин Е.В., 27.10.2020  Задача № АЛП027381_ПФ

&НаКлиенте
Процедура ОбработкаКоманды(ПараметрКоманды, ПараметрыВыполненияКоманды)
	ПараметрыФормы = Новый Структура();
	ПараметрыФормы.Вставить(""СформироватьПриОткрытии"", Истина);
	ПараметрыФормы.Вставить(""КлючВарианта"",""Бронирование"");
	
	//+ Иванов А.Б. 2016-04-20
	ПараметрыФормы.Вставить(""ПользовательскиеНастройки"",ЗаполнитьПользовательскиеНастройкиОтчета());
	//- Иванов А.Б. 2016-04-20
	
	ОткрытьФорму(""Отчет.фнмСостояниеАвтомобилей.Форма"", ПараметрыФормы, ПараметрыВыполненияКоманды.Источник, ПараметрыВыполненияКоманды.Уникальность, ПараметрыВыполненияКоманды.Окно, ПараметрыВыполненияКоманды.НавигационнаяСсылка);
КонецПроцедуры

&НаСервере
Функция ЗаполнитьПользовательскиеНастройкиОтчета()	
	ОтчетОбъект=Отчеты.фнмСостояниеАвтомобилей.Создать();
	КомпоновщикНастроек = ОтчетОбъект.КомпоновщикНастроек;
	ИмяВарианта = ""Бронирование"";
	Для Каждого ЭлВариантНастроек ИЗ ОтчетОбъект.СхемаКомпоновкиДанных.ВариантыНастроек Цикл
		Если ЭлВариантНастроек.Имя = ИмяВарианта Тогда
			КомпоновщикНастроек.ЗагрузитьНастройки(ЭлВариантНастроек.Настройки);
			Прервать;		
		Конецесли;
	КонецЦикла;	
	
	Настройки = КомпоновщикНастроек.ПолучитьНастройки();
	
	//+ Иванов А.Б. 2016-04-20
	ПолеОтбора_АвтомобильРодитель = Новый ПолеКомпоновкиДанных(""Автомобиль.Родитель"");
	Для каждого ЭлементОтбора из Настройки.Отбор.Элементы цикл
		Если ЭлементОтбора.ЛевоеЗначение = ПолеОтбора_АвтомобильРодитель Тогда
			ЭлементОтбора.Использование = Ложь;	
		Конецесли;
	Конеццикла;
	//- Иванов А.Б. 2016-04-20
	
	//НовыйЭлементОтбора = Настройки.Отбор.Элементы.Добавить(Тип(""ЭлементОтбораКомпоновкиДанных""));
	//ПолеОтбора = Новый ПолеКомпоновкиДанных(""Техника_Номенклатура"");
	//НовыйЭлементОтбора.ЛевоеЗначение  = ПолеОтбора;
	//НовыйЭлементОтбора.Использование  = Истина;
	//НовыйЭлементОтбора.ВидСравнения   = ВидСравненияКомпоновкиДанных.Равно;
	//НовыйЭлементОтбора.ПравоеЗначение = Техника_Номенклатура;
	
	КомпоновщикНастроек.ЗагрузитьНастройки(Настройки);
	Возврат КомпоновщикНастроек.ПользовательскиеНастройки;
КонецФункции //



//Ранее


ПараметрыФормы=Новый Структура();
//+ Иванов А.Б. 2015-11-11
ПараметрыФормы.Вставить(""КлючВарианта"",""Основной"");
//- Иванов А.Б. 2015-11-11	
ПараметрыФормы.Вставить(""СформироватьПриОткрытии"", Истина);
//+ Иванов А.Б. 2015-11-10
ПараметрыФормы.Вставить(""ТекущийДокумент"", Ссылка);
//- Иванов А.Б. 2015-11-10


ДопПараметры = Новый Структура();
 ПараметрыПользователя = Новый Структура();
//+ Иванов А.Б. 2015-11-10
//ПараметрыПользователя.Вставить(""ТекущийДокумент"",Ссылка);
//- Иванов А.Б. 2015-11-10

ДопПараметры.Вставить(""ПараметрыПользователя"",ПараметрыПользователя);

ПараметрыФормы.Вставить(""ПользовательскиеНастройки"",ЗаполнитьПользовательскиеНастройкиОтчета(ДопПараметры));
ОткрытьФорму(""Отчет.фнмСверкаЦенОпцийТехники.Форма.ФормаОтчета"",ПараметрыФормы, , Новый УникальныйИдентификатор);


//+ SP 409 Иванов А.Б. 2015-10-22
Функция ЗаполнитьПользовательскиеНастройкиОтчета(ДопПараметры)	
	ОтчетОбъект=Отчеты.фнмСверкаЦенОпцийТехники.Создать();
	КомпоновщикНастроек = ОтчетОбъект.КомпоновщикНастроек;
	////+ Иванов А.Б. 2015-11-10
	//ИмяВарианта = ""Основной"";
	//Для Каждого ЭлВариантНастроек ИЗ ОтчетОбъект.СхемаКомпоновкиДанных.ВариантыНастроек Цикл
	//	Если ЭлВариантНастроек.Имя = ИмяВарианта Тогда
	//		КомпоновщикНастроек.ЗагрузитьНастройки(ЭлВариантНастроек.Настройки);
	//		Прервать;		
	//	Конецесли;
	//КонецЦикла;	
	////- Иванов А.Б. 2015-11-10
	
	Настройки = КомпоновщикНастроек.ПолучитьНастройки();
	
	Для каждого ПараметрПользователя Из ДопПараметры.ПараметрыПользователя Цикл
		Настройки.ПараметрыДанных.УстановитьЗначениеПараметра(ПараметрПользователя.Ключ, ПараметрПользователя.Значение);
	КонецЦикла;
	КомпоновщикНастроек.ЗагрузитьНастройки(Настройки);
	Возврат КомпоновщикНастроек.ПользовательскиеНастройки;
КонецФункции
//- SP 409 Иванов А.Б. 2015-10-22
"}
},
{0,
{"УпрФормы",0,0,"","ДокументОбъект = РеквизитФормыВЗначение(""Объект""); 
ДокументОбъект.ПроцедураМодуляОбъектаЭкспортная();

//СОХРАНЕНИЕ
 
Структура = Новый Структура;
Структура.Вставить(""Поле1"", 10);

ХранилищеСистемныхНастроек.Сохранить(""КлючОбъекта"", ""КлючНастроек"", Структура);

//ЗАГРУЗКА    
 
ЗагружДанные = ХранилищеСистемныхНастроек.Загрузить(""КлючОбъекта"", ""КлючНастроек"");"}
},
{0,
{"ПередачаЗначениейПеременныхМеждуМодулями",0,0,"","
СчетаТовары = Новый Массив;
СчетаТовары.Добавить(ПланыСчетов.Хозрасчетный.ТоварыНаСкладах);
СчетаТовары.Добавить(ПланыСчетов.Хозрасчетный.ПокупныеИзделия);

//Отчет.СчетаТовары это строковый реквизит
Отчет.СчетаТовары=ПоместитьВоВременноеХранилище(СчетаТовары,Новый УникальныйИдентификатор);

СчетаТовары=ПолучитьИзВременногоХранилища(Отчет.СчетаТовары);
"}
},
{0,
{"СообщениеПользователю",0,0,"","СообщениеПользователю = Новый СообщениеПользователю;
СообщениеПользователю.Текст = ""Ошибка! Не заполнен реквизит """"Заявка на закупку"""""";
СообщениеПользователю.Поле = ""Объект.ЗаявкаНаЗакупку"";
СообщениеПользователю.Сообщить();


// Сообщение которое затухает
ПоказатьОповещениеПользователя(""Ошибка! Заявка уже утверждена,""
				+Символы.ПС+"" нет смысла запускать новый процесс """"Утверждение закупки"""""");"}
},
{0,
{"ОткрытьФорму",0,0,"","ПараметрыОповещения = Новый Структура();
ПараметрыОповещения.Вставить(""СтрокаТоварыУслуги"",СтрокаТоварыУслуги);
ОповещениеОЗакрытии = Новый ОписаниеОповещения(""ОбработатьВыборРасчетаРассрочки"", ЭтаФорма,ПараметрыОповещения);

ПараметрыОткрытияФормы = Новый Структура();
ПараметрыОткрытияФормы.Вставить(""ТекущаяТехника"",ТекущаяТехника);
ПараметрыОткрытияФормы.Вставить(""ТекущийКлючСтрокиТехника"",ТекущийКлючСтрокиТехника);
ПараметрыОткрытияФормы.Вставить(""ОкончательнаяСуммаСделкиCНДС"",СтрокаТехника.ОкончательнаяСуммаСделкиCНДС);
ПараметрыОткрытияФормы.Вставить(""КоличествоДнейРассрочки"",Объект.КоличествоДнейРассрочки);
ПараметрыОткрытияФормы.Вставить(""ПроцентПредоплаты"",Объект.ПроцентПредоплаты);
ПараметрыОткрытияФормы.Вставить(""СуммаРассрочкиВДокументе"",пСуммаРассрочки);

ОткрытьФорму(""Документ.фнмКоммерческоеПредложение.Форма.ФормаРасчетаРассрочки"",ПараметрыОткрытияФормы,ЭтаФорма,,,,ОповещениеОЗакрытии,РежимОткрытияОкнаФормы.БлокироватьВесьИнтерфейс);


//+ #67 Иванов А.Б. 2016-10-03
&НаКлиенте
Процедура ОбработатьВыборРасчетаРассрочки(РезультатЗакрытия, ДопПараметры) Экспорт
	Если РезультатЗакрытия = Неопределено Тогда
		Возврат;
	Конецесли;
	СтрокаТоварыУслуги = ДопПараметры.СтрокаТоварыУслуги;
	
	Объект.ПроцентПредоплаты = РезультатЗакрытия.ПроцентПредоплаты;
	Объект.КоличествоДнейРассрочки = РезультатЗакрытия.КоличествоДнейРассрочки;
	пСуммаРассрочкиРассчитаная = РезультатЗакрытия.СуммаРассрочкиРассчитаная;
	
	СтрокаТоварыУслуги.ЦенаПокупкиБезНДС = 0.01;
	ПриИзмененииТЧ(СтрокаТоварыУслуги,""ЦенаПокупкиБезНДС"",""ТоварыУслуги"",""БезИзмененияЦеныПродажиБезНДС"");
	
	СтрокаТоварыУслуги.СуммаПродажиСНДС = пСуммаРассрочкиРассчитаная;	
	ПриИзмененииТЧ(СтрокаТоварыУслуги,""СуммаПродажиСНДС"",""ТоварыУслуги"");
	
	//+ #67 Иванов А.Б. 2016-10-04
	ПриОкончанииРедактированииТоварыУслуги();
	//- #67 Иванов А.Б. 2016-10-04	
КонецПроцедуры
//- #67 Иванов А.Б. 2016-10-03



ПараметрыФормы = Новый Структура;
ПараметрыФормы.Вставить(""Ключ"", БПСсылка);
ПараметрыФормы.Вставить(""Задача"", ВыбраннаяСтрока);
ОткрытьФорму(""БизнесПроцесс.ПродажаТехники.Форма.ФормаТочкиПродажи"",ПараметрыФормы);


//Открытие отчета и формирование его
ПараметрыФормы=Новый Структура();
ПараметрыФормы.Вставить(""СформироватьПриОткрытии"", Истина);

ДопПараметры = Новый Структура();
ДопПараметры.Вставить(""ПараметрКоманды"",ПараметрКоманды);
Если ТипЗнч(ПараметрКоманды) = Тип(""БизнесПроцессСсылка.УтверждениеЗакупки"")
	ИЛИ ТипЗнч(ПараметрКоманды) = Тип(""БизнесПроцессСсылка.УтверждениеЗакупки_СогласованиеПоДопМатрице"") Тогда
	ДопПараметры.Вставить(""ЭтоБизнесПроцессЗакупки"",Истина);
Иначе
	ДопПараметры.Вставить(""ЭтоБизнесПроцессЗакупки"",Ложь);
	ДопПараметры.Вставить(""ПараметрыПользователя"",Новый Структура(""ЗаявкаНаЗакупку"",ПараметрКоманды));
Конецесли;

ПараметрыФормы.Вставить(""ПользовательскиеНастройки"",ЗаполнитьПользовательскиеНастройкиОтчета(ДопПараметры));
 	
ОткрытьФорму(""Отчет.фнмЛистСогласования.Форма.ФормаОтчета"",ПараметрыФормы, , Новый УникальныйИдентификатор);	

&НаСервере
Функция ЗаполнитьПользовательскиеНастройкиОтчета(ДопПараметры)
	Если ДопПараметры.ЭтоБизнесПроцессЗакупки Тогда
		БизнесПроцес=ДопПараметры.ПараметрКоманды;
		ПараметрыПользователя = Новый Структура(""ЗаявкаНаЗакупку"",БизнесПроцес.ЗаявкаНаЗакупку);
	Иначе	
		ПараметрыПользователя = ДопПараметры.ПараметрыПользователя;
	Конецесли;
	
	ОтчетОбъект=Отчеты.фнмЛистСогласования.Создать();
	КомпоновщикНастроек = ОтчетОбъект.КомпоновщикНастроек;
	Настройки = КомпоновщикНастроек.ПолучитьНастройки();
	Для каждого ПараметрПользователя Из ПараметрыПользователя Цикл
		Настройки.ПараметрыДанных.УстановитьЗначениеПараметра(ПараметрПользователя.Ключ, ПараметрПользователя.Значение);
	КонецЦикла;
	КомпоновщикНастроек.ЗагрузитьНастройки(Настройки);
	Возврат КомпоновщикНастроек.ПользовательскиеНастройки;
КонецФункции


    ЗначениеОтбора = Новый Структура(""Владелец"", Объект.Контрагент);
	ЗначениеОтбора.Вставить(""ВидДоговора"",ПолучитьСписокВидовДоговоровНаСервере());
	
	ПараметрыВыбора = Новый Структура(""Отбор"", ЗначениеОтбора);   
    ФормаВыбора = ПолучитьФорму(""Справочник.ДоговорыВзаиморасчетов.Форма.ФормаВыбораУправляемая"",ПараметрыВыбора);
	
	ДополнительныеПараметры = Новый Структура;
	ДополнительныеПараметры.Вставить(""Форма"", ЭтаФорма);
	
	ОповещениеОЗакрытии = Новый ОписаниеОповещения(""ОбработатьДоговорыВзаиморасчетовПриВыборе"", ЭтаФорма, ДополнительныеПараметры);
	
	ФормаВыбора.ОписаниеОповещенияОЗакрытии = ОповещениеОЗакрытии;
	ФормаВыбора.Элементы.Список.Отображение = ОтображениеТаблицы.Дерево;	
	ФормаВыбора.Открыть();

	
//Создать копирование док с упр. формой
ДокОбъект = ЗаявкаНаБронирование.Скопировать();

ПараметрыФормы = Новый Структура;
ПараметрыФормы.Вставить(""ДокОбъект"",ДокОбъект);		
ОткрытьФорму(""Документ.фнмЗаявкаНаБронирование.Форма.ФормаДокумента"",ПараметрыФормы);

&НаСервере
Процедура ПриСозданииНаСервере(Отказ, СтандартнаяОбработка)
	Если Объект.Ссылка.Пустая() Тогда
		Если Параметры.ДокОбъект <> Неопределено Тогда
			ЗначениеВРеквизитФормы(Параметры.ДокОбъект,""Объект"");
		Конецесли;
	Конецесли;
КонецПроцедуры	
//Конец блока Создать копирование док с упр. формой




//Можно открыть форму списка без параметров:

ОткрытьФорму(""Документ.ПриходнаяНакладная.ФормаСписка"");
//И затем, в обработчике события формы списка приходных накладных ПриСозданииНаСервере написать код, который создает отбор в динамическом списке, являющемся основным реквизитом формы:

&НаСервере
Процедура ПриСозданииНаСервере(Отказ, СтандартнаяОбработка)
	Если Параметры.Свойство(""ДатаЗаявкиНаЗакупку"") Тогда
		пДатаЗаявкиНаЗакупку = Параметры.ДатаЗаявкиНаЗакупку;
		
		ГруппаЭлементовОтбора = Список.Отбор.Элементы.Добавить(Тип(""ГруппаЭлементовОтбораКомпоновкиДанных""));
		
	    ЭлементОтбора = ГруппаЭлементовОтбора.Элементы.Добавить(Тип(""ЭлементОтбораКомпоновкиДанных""));
	    ЭлементОтбора.ЛевоеЗначение    = Новый ПолеКомпоновкиДанных(""Дата"");
	    ЭлементОтбора.ВидСравнения     = ВидСравненияКомпоновкиДанных.БольшеИлиРавно;
	    ЭлементОтбора.Использование    = Истина;
	    //ЭлементОтбора.РежимОтображения = РежимОтображенияЭлементаНастройкиКомпоновкиДанных.Недоступный;
	    ЭлементОтбора.ПравоеЗначение   = НачалоГода(пДатаЗаявкиНаЗакупку);
		
		
	    ЭлементОтбора = ГруппаЭлементовОтбора.Элементы.Добавить(Тип(""ЭлементОтбораКомпоновкиДанных""));
	    ЭлементОтбора.ЛевоеЗначение    = Новый ПолеКомпоновкиДанных(""Дата"");
	    ЭлементОтбора.ВидСравнения     = ВидСравненияКомпоновкиДанных.МеньшеИлиРавно;
	    ЭлементОтбора.Использование    = Истина;
	    //ЭлементОтбора.РежимОтображения = РежимОтображенияЭлементаНастройкиКомпоновкиДанных.Недоступный;
	    ЭлементОтбора.ПравоеЗначение   = КонецГода(пДатаЗаявкиНаЗакупку);
	Конецесли;
	Если Параметры.Свойство(""фнмВидОтчета"") Тогда
		пфнмВидОтчета = Параметры.фнмВидОтчета;
		
	    ЭлементОтбора = Список.Отбор.Элементы.Добавить(Тип(""ЭлементОтбораКомпоновкиДанных""));
	    ЭлементОтбора.ЛевоеЗначение    = Новый ПолеКомпоновкиДанных(""фнмВидОтчета"");
	    ЭлементОтбора.ВидСравнения     = ВидСравненияКомпоновкиДанных.Равно;
	    ЭлементОтбора.Использование    = Истина;
	    //ЭлементОтбора.РежимОтображения = РежимОтображенияЭлементаНастройкиКомпоновкиДанных.Недоступный;
	    ЭлементОтбора.ПравоеЗначение   = пфнмВидОтчета;
	Конецесли;
КонецПроцедуры
"}
},
{0,
{"ПередачаФайлаССервераНаКлиент",0,0,"","//1 Вариант
&НаСервере
Функция ФормированиеФайла() 
	АдресФайлаДанныхВХранилище = ПоместитьВоВременноеХранилище(Новый ДвоичныеДанные(ИмяФайлаДанныхНаСервере), УникальныйИдентификатор);
	Возврат АдресФайлаДанныхВХранилище;
КонецФункции 

&НаКлиенте
Процедура КомандаВыгрузить(Команда)
	АдресФайлаДанныхВХранилище = КомандаВыгрузитьНаСервере();
	
	Если АдресФайлаДанныхВХранилище = Неопределено Тогда
		Возврат;
	КонецЕсли;	
	
	ПолучитьФайл(АдресФайлаДанныхВХранилище, Объект.ИмяФайлаДанных,Ложь);
КонецПроцедуры


//2 Вариант
&НаСервере
Функция ПолучитьФайлССервера(ИмяФайла)
	ДанныеФайла = Новый ДвоичныеДанные(ИмяФайла);
	Возврат ДанныеФайла;
КонецФункции

&НаКлиенте
Процедура ЗабратьФайлССервера(ИмяНаСервере, ИмяНаКлиенте)
	ДанныеФайла = ПолучитьФайлССервера(ИмяНаСервере);
	ДанныеФайла.Записать(ИмяНаКлиенте);
КонецПроцедуры"}
},
{0,
{"ПередачаФайлаСКлиентаНаСервер",0,0,"","//// В Модуле Формы 

&НаКлиенте
Процедура КомандаПрочитатьФайл(Команда)
	АдресФайла = """";
	ИмяФайлаДляРасширения = ""*.xml"";
	ИмяФайла=Объект.ИмяФайлаДанныхКлиент;

	Если Не ПоместитьФайл(АдресФайла, ИмяФайла, ИмяФайлаДляРасширения,Ложь,УникальныйИдентификатор) Тогда
		Возврат;
	КонецЕсли;
	ДопПараметры = Новый Структура();
	ДопПараметры.Вставить(""АдресФайла"",АдресФайла);
	ДопПараметры.Вставить(""ИмяФайлаДляРасширения"",ИмяФайлаДляРасширения);
	
	КомандаПрочитатьФайлНаСервере(ДопПараметры);


КонецПроцедуры

&НаСервере
Функция КомандаПрочитатьФайлНаСервере(ДопПараметры) Экспорт
	ДокументОбъект = РеквизитФормыВЗначение(""Объект""); 
	ДокументОбъект.ИмяФайлаДанных = ДокументОбъект.ПолучитьИмяФайлаНаСервере(ДопПараметры);
	ЗначениеВРеквизитФормы(ДокументОбъект,""Объект"");
Конецфункции



//// В Модуле объекта

&НаСервере
Функция ПолучитьИмяФайлаНаСервере(ДопПараметры) Экспорт
	АдресФайла = ДопПараметры.АдресФайла;
	ИмяФайлаДляРасширения = ДопПараметры.ИмяФайлаДляРасширения;
									
	ИмяФайла = Неопределено;
	Расширение = РасширениеФайла(ИмяФайлаДляРасширения);
	ДвоичныеДанные = ПолучитьИзВременногоХранилища(АдресФайла);
	АдресНаСервере = ПолучитьИмяВременногоФайла(Расширение);
	ДвоичныеДанные.Записать(АдресНаСервере);
	ИмяФайла = АдресНаСервере;
	
	Возврат ИмяФайла;
	
КонецФункции

&НаСервере
Функция РасширениеФайла(Знач ИмяФайла)
	
	ПозицияТочки = ПоследнийРазделитель(ИмяФайла);
	
	Расширение = Прав(ИмяФайла,СтрДлина(ИмяФайла) - ПозицияТочки + 1);
	
	Возврат Расширение;
	
КонецФункции

&НаСервере
Функция ПоследнийРазделитель(СтрокаСРазделителем, Разделитель = ""."")
	
	ДлинаСтроки = СтрДлина(СтрокаСРазделителем);
	
	Пока ДлинаСтроки > 0 Цикл
		
		Если Сред(СтрокаСРазделителем, ДлинаСтроки, 1) = Разделитель Тогда
			
			Возврат ДлинаСтроки; 
			
		КонецЕсли;
		
		ДлинаСтроки = ДлинаСтроки - 1;
		
	КонецЦикла;

КонецФункции
"}
},
{0,
{"РеквизитФормыВЗначение",0,0,"Рекв[изитФормыВЗначение]","пОбъект = РеквизитФормыВЗначение(""Объект""); 
пОбъект.<?""ИмяЭлемента"">();
ЗначениеВРеквизитФормы(пОбъект,""Объект"");
<?>

"}
},
{0,
{"НачалоВыбора",0,0,"","&НаКлиенте
Процедура СтатьяЗатратНачалоВыбора(Элемент, ДанныеВыбора, СтандартнаяОбработка)
	СтандартнаяОбработка = Ложь;
    ЗначениеОтбора = Новый Структура(""Ссылка"", ПолучитьСписокСтатейЗатрат());
    ПараметрыВыбора = Новый Структура(""Отбор"", ЗначениеОтбора);   
    Форма = ПолучитьФорму(""Справочник.СтатьиДоходовИРасходов.ФормаВыбора"",ПараметрыВыбора);
	Форма.Элементы.Список.Отображение = ОтображениеТаблицы.Список;	
	
	РезультатВыбора = Форма.ОткрытьМодально();
КонецПроцедуры

&НаКлиенте
Процедура ДоговорВзаиморасчетовНачалоВыбора(Элемент, ДанныеВыбора, СтандартнаяОбработка)
	СтандартнаяОбработка = Ложь;
    ЗначениеОтбора = Новый Структура(""Владелец"", Объект.Контрагент);
	ЗначениеОтбора.Вставить(""ВидДоговора"",ПолучитьСписокВидовДоговоровНаСервере());
	
	ПараметрыОткрытияФормы = Новый Структура(""Отбор"", ЗначениеОтбора);   
    ФормаВыбора = ПолучитьФорму(""Справочник.ДоговорыВзаиморасчетов.Форма.ФормаВыбораУправляемая"",ПараметрыОткрытияФормы);
	
	ДополнительныеПараметры = Новый Структура;
	ДополнительныеПараметры.Вставить(""Форма"", ЭтаФорма);
	
	ОповещениеОЗакрытии = Новый ОписаниеОповещения(""ОбработатьДоговорыВзаиморасчетовПриВыборе"", ЭтаФорма, ДополнительныеПараметры);
	
	ФормаВыбора.ОписаниеОповещенияОЗакрытии = ОповещениеОЗакрытии;
	ФормаВыбора.Элементы.Список.Отображение = ОтображениеТаблицы.Дерево;	
	ФормаВыбора.Элементы.Список.НачальноеОтображениеДерева = НачальноеОтображениеДерева.РаскрыватьВсеУровни;
	ФормаВыбора.Открыть();
	//Объект.ДоговорВзаиморасчетов = Форма.откр;
КонецПроцедуры

&НаКлиенте
Процедура ОбработатьДоговорыВзаиморасчетовПриВыборе(РезультатЗакрытия, ДополнительныеПараметры) Экспорт
	Если РезультатЗакрытия = Неопределено Тогда
		Возврат;
	Конецесли;
	Объект.ДоговорВзаиморасчетов = РезультатЗакрытия;	
	ДоговорВзаиморасчетовПриИзмененииНаСервере();
КонецПроцедуры //ОбработатьДоговорыВзаиморасчетовПриВыборе

//Ограничить тип
&НаКлиенте
Процедура ВыходноеИзделиеНачалоВыбора(Элемент, ДанныеВыбора, СтандартнаяОбработка)
	Если НЕ ЗначениеЗаполнено(Объект.ВыходноеИзделие) Тогда
	    Массив = Новый Массив;
	    Массив.Добавить(Тип(""СправочникСсылка.Автомобили""));
		Массив.Добавить(Тип(""СправочникСсылка.Модели""));
	    Элементы.ВыходноеИзделие.ОграничениеТипа = Новый ОписаниеТипов(Массив);	
		
		//ТипСтр = ""СправочникСсылка.Автомобили,СправочникСсылка.Модели"";
		//ОписаниеТипов = Новый ОписаниеТипов(ТипСтр);
		//Объект.ВыходноеИзделие = ОписаниеТипов.ПривестиЗначение(Объект.ВыходноеИзделие);	
	Конецесли;
КонецПроцедуры"}
},
{0,
{"НачалоВыборИзСписка",0,0,"","&НаКлиенте
Процедура ТЧБюджетНаправлениеДеятельностиНачалоВыбораИзСписка(Элемент, СтандартнаяОбработка)
	СтрокаТЧБюджет = Элементы.ТЧБюджет.ТекущиеДанные;	
	Если СтрокаТЧБюджет = Неопределено тогда
		Возврат;	
	Конецесли;	
	
	СтандартнаяОбработка = Ложь;
	ВТДопПараметры = Новый Структура();
	ВТДопПараметры.Вставить(""СтрокаТЧБюджет"",СтрокаТЧБюджет);
	
	СписокВыбора = ПолучитьСписокНДВыбораНаСервере();
	НачальноеЗначение = СписокВыбора.НайтиПоЗначению(СтрокаТЧБюджет.НаправлениеДеятельности);
	
	пОписаниеОповещения = Новый ОписаниеОповещения(""ВыполнитьПослеВыбораНД"", ЭтаФорма, ВТДопПараметры);
	ПоказатьВыборИзСписка(пОписаниеОповещения, СписокВыбора, Элементы.ТЧБюджетНаправлениеДеятельности,НачальноеЗначение);
	
КонецПроцедуры

&НаКлиенте
Процедура ВыполнитьПослеВыбораНД(РезультатЗакрытия, ДопПараметры) Экспорт
	Если РезультатЗакрытия = Неопределено Тогда
		Возврат;
	Конецесли;
	СтрокаТЧБюджет = ДопПараметры.СтрокаТЧБюджет;
	СтрокаТЧБюджет.НаправлениеДеятельности = РезультатЗакрытия;
КонецПроцедуры

&НаСервереБезКонтекста
Функция ПолучитьСписокНДВыбораНаСервере() Экспорт
	СписокВыбора = Новый СписокЗначений;
	
	МассивНаправленийДеятельности = Документы.фнмБюджетПродажТехники.ПолучитьМассивНаправленийДеятельностиДляБюджетаПродажТехники();
	
	Для каждого ЭлМассивНаправленийДеятельности из МассивНаправленийДеятельности цикл
		СписокВыбора.Добавить(ЭлМассивНаправленийДеятельности,ЭлМассивНаправленийДеятельности);	
	КонецЦикла;

	СписокВыбора.СортироватьПоПредставлению(НаправлениеСортировки.Возр);
	Возврат СписокВыбора;
КонецФункции "}
},
{0,
{"МодальныйВызовОкна",0,0,"","//+ SP 202 Иванов А.Б. 2014-02-20
&НаКлиенте
Процедура ЦеныИВалютаНажатие(Элемент, СтандартнаяОбработка)
	СтандартнаяОбработка = Ложь;
	СтруктураПараметров = Новый Структура();
	СтруктураПараметров.Вставить(""КурсВалютыВзаиморасчетов"",Объект.КурсВалютыВзаиморасчетов);
	СтруктураПараметров.Вставить(""ВалютаДокумента"",Объект.ВалютаДокумента);
	СтруктураПараметров.Вставить(""КурсДокумента"",Объект.КурсДокумента);
	СтруктураПараметров.Вставить(""КурсВалютыУпр"",Объект.КурсВалютыУпр);
	СтруктураПараметров.Вставить(""ТипЦен"",Объект.ТипЦен);
	
	ДополнительныеПараметры = Новый Структура;
	ДополнительныеПараметры.Вставить(""Форма"", ЭтаФорма);
	
	ОповещениеОЗакрытии = Новый ОписаниеОповещения(""ОбработатьИзмененияПоКнопкеЦеныИВалютыЗавершение"", ЭтаФорма, ДополнительныеПараметры);
	
	ОткрытьФорму(""ОбщаяФорма.фнмФормаЦеныИВалютаУправляемая"", СтруктураПараметров,,,,, ОповещениеОЗакрытии);

КонецПроцедуры
//- SP 202 Иванов А.Б. 2014-02-20

//+ SP 202 Иванов А.Б. 2014-02-20
&НаКлиенте
Процедура ОбработатьИзмененияПоКнопкеЦеныИВалютыЗавершение(РезультатЗакрытия, ДополнительныеПараметры) Экспорт
	Сообщить(""ОбработатьИзмененияПоКнопкеЦеныИВалютыЗавершение"");
	Если РезультатЗакрытия = Неопределено Тогда
		Возврат;
	Конецесли;
КонецПроцедуры //ОбработатьИзмененияПоКнопкеЦеныИВалютыЗавершение
//- SP 202 Иванов А.Б. 2014-02-20


&НаКлиенте
Процедура ДоговорВзаиморасчетовНачалоВыбора(Элемент, ДанныеВыбора, СтандартнаяОбработка)
	СтандартнаяОбработка = Ложь;
    ЗначениеОтбора = Новый Структура(""Владелец"", Объект.Контрагент);
	ЗначениеОтбора.Вставить(""ВидДоговора"",ПолучитьСписокВидовДоговоровНаСервере());
	
	ПараметрыВыбора = Новый Структура(""Отбор"", ЗначениеОтбора);   
    ФормаВыбора = ПолучитьФорму(""Справочник.ДоговорыВзаиморасчетов.Форма.ФормаВыбораУправляемая"",ПараметрыВыбора);
	
	ДополнительныеПараметры = Новый Структура;
	ДополнительныеПараметры.Вставить(""Форма"", ЭтаФорма);
	
	ОповещениеОЗакрытии = Новый ОписаниеОповещения(""ОбработатьДоговорыВзаиморасчетовПриВыборе"", ЭтаФорма, ДополнительныеПараметры);
	
	ФормаВыбора.ОписаниеОповещенияОЗакрытии = ОповещениеОЗакрытии;
	ФормаВыбора.Элементы.Список.Отображение = ОтображениеТаблицы.Дерево;	
	ФормаВыбора.Открыть();
	//Объект.ДоговорВзаиморасчетов = Форма.откр;
КонецПроцедуры
"}
},
{0,
{"ПривестиЗначение",0,0,"","&НаКлиенте
Процедура ОбъектСогласованияНачалоВыбора(Элемент, ДанныеВыбора, СтандартнаяОбработка)
	//ПолучитьТипСтрНаСервере();
    ТипСтр = ""ДокументСсылка.фнмЗаявкаНаЗакупку"";
    ОписаниеТипов = Новый ОписаниеТипов(ТипСтр);
    Объект.ОбъектСогласования = ОписаниеТипов.ПривестиЗначение(Объект.ОбъектСогласования);	
    Элемент.ВыбиратьТип = Ложь;
КонецПроцедуры
"}
},
{0,
{"СохранитьВосстановитьНастройки",0,0,"","//+ Иванов А.Б. 2014-03-26
Процедура ВосстановитьНастройкиДляПользователя() Экспорт
	КлючОбъекта = ПолучитьКлючОбъекта();
	КлючНастроек = ПолучитьКлючНастроек();	
	//ИмяПользователя = ПараметрыСеанса.ТекущийПользователь.Наименование; // указывается в том случае если необходимо получить настройки другого пользователя
	СтруктураНастроек = ХранилищеСистемныхНастроек.Загрузить(КлючОбъекта, КлючНастроек);	
	Если СтруктураНастроек.Свойство(""ТЧПодразделения"") Тогда
		ТЧПодразделения.Очистить();
		Для каждого СтрокаНастройкиТЧПодразделения из СтруктураНастроек.ТЧПодразделения цикл
			СтрокаТЧПодразделения = ТЧПодразделения.Добавить();			
			СтрокаТЧПодразделения.ПодразделениеОрганизации = СтрокаНастройкиТЧПодразделения.ПодразделениеОрганизации;
		Конеццикла;
	Конецесли;
	Если СтруктураНастроек.Свойство(""Период"") Тогда
		Период=СтруктураНастроек.Период;
	Конецесли;
КонецПроцедуры //ВосстановитьНастройкиПользователя()
//- Иванов А.Б. 2014-03-26

//+ Иванов А.Б. 2014-03-26
Процедура СохранитьНастройкиДляПользователя() Экспорт
	//СОХРАНЕНИЕ
	 
	СтруктураНастроек = Новый Структура;
	СтруктураНастроек.Вставить(""ТЧПодразделения"", ТЧПодразделения.Выгрузить());
	СтруктураНастроек.Вставить(""Период"", Период);

	//ИмяПользователя = ПараметрыСеанса.ТекущийПользователь.Наименование;
	КлючОбъекта = ПолучитьКлючОбъекта();
	КлючНастроек = ПолучитьКлючНастроек();
	ХранилищеСистемныхНастроек.Сохранить(КлючОбъекта, КлючНастроек, СтруктураНастроек);
	
КонецПроцедуры //СохранитьНастройкиПользователя
//- Иванов А.Б. 2014-03-26

ХранилищеСистемныхНастроек.Удалить(КлючОбъекта,КлючОбъекта,Неопределено);

//+ Иванов А.Б. 2014-03-26
Функция ПолучитьКлючОбъекта() Экспорт 
	Возврат ""фнм_ЗагрузкаЗаявокНаРасходДС"";
КонецФункции //
//- Иванов А.Б. 2014-03-26

//+ Иванов А.Б. 2014-03-26
Функция ПолучитьКлючНастроек() Экспорт 
	Возврат ""фнм_ЗагрузкаЗаявокНаРасходДС_Отборы"";
КонецФункции //ПолучитьКлючНастроек()
//- Иванов А.Б. 2014-03-26
"}
},
{0,
{"ОтобразитьИзменениеДанных",0,0,"","ОтобразитьИзменениеДанных(объект.Реквизит1,ВидИзмененияДанных.Изменение);

ИЛИ

ОповеститьОбИзменении(объект.Реквизит1)"}
},
{0,
{"ЗакончитьРедактированиеСтроки",0,0,"","Элементы.Автомобили.ЗакончитьРедактированиеСтроки(Ложь);"}
},
{0,
{"ОтборыВСписках",0,0,"","//см. в ОткрытьФорму"}
},
{0,
{"ОтборВТабличнойЧасти",0,0,"","Элементы.ТЧЗадачиBacklog.ОтборСтрок = Новый ФиксированнаяСтруктура(""Статус"", ПредопределенноеЗначение(""Справочник.фнмСтатусыЗадачи.Backlog""));"}
},
{0,
{"ТекущаяСтрокаУстановка",0,0,"","&НаКлиенте
Процедура УстановитьКурсорНаПоследнююСтрокуВСоставеТехники() Экспорт
	ОбновитьОтображениеДанных();
	СоставТехники = Объект.СоставТехники[Объект.СоставТехники.Количество()-1];
	Элементы.СоставТехники.ТекущаяСтрока = СоставТехники.ПолучитьИдентификатор();	
КонецПроцедуры //УстановитьКурсорНаПоследнююСтрокуВСоставеТехники()
"}
},
{0,
{"Библиотека замены модальных и синхронных вызовов",0,0,"","#Область LibreUniModal_1_02


////////////////////////////////////////////////////////////////////////////////
// ПРОЦЕДУРЫ И ФУНКЦИИ Библиотеки универсальных вызовов с автоматической поддержкой модальности
// Предназначены для простоты написания кода работающего в любой версии 8.2 - 8.3 с поддержкой модальности или без оной.
// Молочников Олег 2015г. Версия библиотеки 1.02
// Если Вы будете дорабатывать библиотеку, пожалуйста поделитесь исправлениями oleg.molochnikov@mail.ru
// 
// Для работы библиотеки необходимо добавить две переменные объекта
// МодальностьРазрешена Булево 
// ВерсияПриложения Строка
// 
// Следующий код нужно включить в процедуру ""При создании на сервере""
// 
// СисИнфо = Новый СистемнаяИнформация;
// Объект.ВерсияПриложения = СисИнфо.ВерсияПриложения;
// 
// Если Лев(Объект.ВерсияПриложения, 3) = ""8.2"" Тогда
// Объект.МодальностьРазрешена = Истина;
// Иначе
// Выполнить(""Объект.МодальностьРазрешена = Метаданные.РежимИспользованияМодальности = Метаданные.СвойстваОбъектов.РежимИспользованияМодальности.Использовать;"");
// КонецЕсли;
//

&НаКлиенте
Процедура УниверсальныйПредупреждение(ТекстПредупреждения,ТаймаутПредупреждения=0,ЗаголовокПредупреждения="""",КодПослеобработки="""",ДополнительныеПараметры="""")
	Если ТипЗнч(ДополнительныеПараметры) <> Тип(""Структура"") Тогда
		ДополнительныеПараметры=Новый Структура;
	КонецЕсли;
	
	ДополнительныеПараметры.Вставить(""КодПослеобработки"",КодПослеобработки);
	ДополнительныеПараметры.Вставить(""ТекстПредупреждения"",ТекстПредупреждения);
	
	Если Объект.МодальностьРазрешена Тогда
		КодВыполнения = 
		"" Предупреждение(ТекстПредупреждения,ТаймаутПредупреждения,ЗаголовокПредупреждения);
		| УниверсальныйПредупреждениеЗавершение(ДополнительныеПараметры);"";
	Иначе
		КодВыполнения = ""
		| ПоказатьПредупреждение(Новый ОписаниеОповещения(""""УниверсальныйПредупреждениеЗавершение"""", ЭтаФорма,ДополнительныеПараметры), ТекстПредупреждения,ТаймаутПредупреждения,ЗаголовокПредупреждения);"";
	КонецЕсли;
	
	Выполнить(КодВыполнения);
	
КонецПроцедуры
&НаКлиенте
Процедура УниверсальныйПредупреждениеЗавершение(ДополнительныеПараметры) Экспорт
	Если ДополнительныеПараметры.Свойство(""КодПослеобработки"") И ДополнительныеПараметры.КодПослеобработки<>"""" Тогда
		Выполнить(ДополнительныеПараметры.КодПослеобработки);
	КонецЕсли;
КонецПроцедуры


&НаКлиенте
Процедура УниверсальныйОткрытьЗначение(ОбъектОткрытия,КодПослеобработки="""",ДополнительныеПараметры="""")
	Если ДополнительныеПараметры="""" Тогда
		ДополнительныеПараметры=Новый Структура;
		ДополнительныеПараметры.Вставить(""КодПослеобработки"",КодПослеобработки);
		ДополнительныеПараметры.Вставить(""ОбъектОткрытия"",ОбъектОткрытия);
	КонецЕсли;
	
	Если Объект.МодальностьРазрешена Тогда
		КодВыполнения = 
		"" ОткрытьЗначение(ОбъектОткрытия);
		| УниверсальныйОткрытьЗначениеЗавершение(ДополнительныеПараметры);"";
	Иначе
		КодВыполнения = ""
		| ПоказатьЗначение(Новый ОписаниеОповещения(""""УниверсальныйОткрытьЗначениеЗавершение"""", ЭтаФорма,ДополнительныеПараметры), ОбъектОткрытия);""; 
	КонецЕсли;
	
	Выполнить(КодВыполнения);
	
КонецПроцедуры
&НаКлиенте
Процедура УниверсальныйОткрытьЗначениеЗавершение(ДополнительныеПараметры) Экспорт
	Если ДополнительныеПараметры="""" Тогда
		Возврат;
	КонецЕсли;
	Если ДополнительныеПараметры.Свойство(""КодПослеобработки"") И ДополнительныеПараметры.КодПослеобработки<>"""" Тогда
		Выполнить(ДополнительныеПараметры.КодПослеобработки);
	КонецЕсли;
КонецПроцедуры

&НаКлиенте
Процедура УниверсальныйЗапуститьПриложение(СтрокаКоманды,ТекущийКаталог="""",КодПослеобработки="""",ДополнительныеПараметры="""")
	Если ДополнительныеПараметры="""" Тогда
		ДополнительныеПараметры=Новый Структура;
		ДополнительныеПараметры.Вставить(""КодПослеобработки"",КодПослеобработки);
		ДополнительныеПараметры.Вставить(""ТекущийКаталог"",ТекущийКаталог);
	КонецЕсли;
	
	Если Объект.МодальностьРазрешена Тогда
		КодВыполнения = 
		"" ЗапуститьПриложение(СтрокаКоманды,ТекущийКаталог);
		| УниверсальныйЗапуститьПриложениеЗавершение(ДополнительныеПараметры);"";
	Иначе
		КодВыполнения = ""
		| НачатьЗапускПриложения(Новый ОписаниеОповещения(""""УниверсальныйЗапуститьПриложениеЗавершение"""", ЭтаФорма), СтрокаКоманды,ТекущийКаталог);""; 
	КонецЕсли;
	
	
	Выполнить(КодВыполнения);
	
КонецПроцедуры
&НаКлиенте
Процедура УниверсальныйЗапуститьПриложениеЗавершение(ДополнительныеПараметры) Экспорт
	Если ТипЗнч(ДополнительныеПараметры) <> Тип(""Структура"") Тогда
		ДополнительныеПараметры=Новый Структура;
	КонецЕсли;
	Если ДополнительныеПараметры.Свойство(""КодПослеобработки"") И ДополнительныеПараметры.КодПослеобработки<>"""" Тогда
		Выполнить(ДополнительныеПараметры.КодПослеобработки);
	КонецЕсли;
КонецПроцедуры


&НаКлиенте
Процедура УниверсальныйВыборФайлов(Режим,МодульОбработкиФайла,ПолноеИмяФайла="""",Фильтр=""*"",МножественныйВыбор=Ложь,Заголовок=""Выберите файл"",ДополнительныеПараметры="""")
	
	Если ТипЗнч(ДополнительныеПараметры) <> Тип(""Структура"") Тогда
		ДополнительныеПараметры=Новый Структура;
	КонецЕсли;
	ДополнительныеПараметры.Вставить(""МодульОбработкиФайла"",МодульОбработкиФайла);
	ДополнительныеПараметры.Вставить(""ПолноеИмяФайла"",ПолноеИмяФайла);
	
	ДиалогОткрытияФайла = Новый ДиалогВыбораФайла(Режим);
	ДиалогОткрытияФайла.ПолноеИмяФайла = ПолноеИмяФайла;
	ДиалогОткрытияФайла.Фильтр = Фильтр;
	ДиалогОткрытияФайла.МножественныйВыбор = МножественныйВыбор;
	ДиалогОткрытияФайла.Заголовок = Заголовок;
	
	Если Объект.МодальностьРазрешена Тогда
		КодВыполнения = 
		""Если ДиалогОткрытияФайла.Выбрать() Тогда
		| УниверсальныйВыборФайловЗавершение(ДиалогОткрытияФайла.ВыбранныеФайлы, ДополнительныеПараметры);
		|КонецЕсли;"";
	Иначе
		КодВыполнения = ""
		|Оповещение = Новый ОписаниеОповещения(""""УниверсальныйВыборФайловЗавершение"""", ЭтаФорма,ДополнительныеПараметры);
		|ДиалогОткрытияФайла.Показать(Оповещение);""; 
	КонецЕсли;
	
	Выполнить(КодВыполнения);
	
КонецПроцедуры

&НаКлиенте
Процедура УниверсальныйВыборФайловЗавершение(ВыбранныеФайлы, ДополнительныеПараметры) Экспорт
	
	Если ВыбранныеФайлы=Неопределено ИЛИ ВыбранныеФайлы.Количество() = 0 Тогда
		Возврат;
	КонецЕсли;
	
	Для Каждого  ВыбранныйФайл из ВыбранныеФайлы Цикл
		Выполнить(ДополнительныеПараметры.МодульОбработкиФайла);
	КонецЦикла;	
КонецПроцедуры

&НаКлиенте
Процедура УниверсальныйВопрос(ТекстВопроса,МодульОбработки1,РежимДиалогаВопроса,Ответ1,Ответ2="""", МодульОбработки2="""",ДополнительныеПараметры="""");
	Если ТипЗнч(ДополнительныеПараметры) <> Тип(""Структура"") Тогда
		ДополнительныеПараметры=Новый Структура;
	КонецЕсли;
	ДополнительныеПараметры.Вставить(""Ответ1"",Ответ1);
	ДополнительныеПараметры.Вставить(""Ответ2"",Ответ2);
	ДополнительныеПараметры.Вставить(""МодульОбработки1"",МодульОбработки1);
	ДополнительныеПараметры.Вставить(""МодульОбработки2"",МодульОбработки2);
	Если Объект.МодальностьРазрешена Тогда
		КодВыполнения = ""
		|Результат = Вопрос(ТекстВопроса, РежимДиалогаВопрос.ДаНет, , КодВозвратаДиалога.Да);
		|УниверсальныйВопросЗавершение(Результат, ДополнительныеПараметры);"";
	Иначе
		КодВыполнения = ""
		|Оповещение = Новый ОписаниеОповещения(""""УниверсальныйВопросЗавершение"""", ЭтаФорма,ДополнительныеПараметры);
		|ПоказатьВопрос(Оповещение, ТекстВопроса, РежимДиалогаВопрос.ДаНет);""; 
	КонецЕсли;
	Выполнить(КодВыполнения);
КонецПроцедуры

&НаКлиенте
Процедура УниверсальныйВопросЗавершение(Результат, ДополнительныеПараметры) Экспорт
	Если Результат=ДополнительныеПараметры.Ответ1 Тогда
		Выполнить(ДополнительныеПараметры.МодульОбработки1);
	ИначеЕсли ДополнительныеПараметры.МодульОбработки2<>"""" И Результат=ДополнительныеПараметры.Ответ2 Тогда	
		Выполнить(ДополнительныеПараметры.МодульОбработки2);
	КонецЕсли;
КонецПроцедуры

#КонецОбласти"}
},
{0,
{"РегистрСведенийЭтоНоваяЗапись",0,0,"","ЭтоНоваяЗапись = НЕ РеквизитФормыВЗначение(""Запись"").Выбран();"}
},
{0,
{"Программное добавление элементов",0,0,"","&НаКлиенте
Процедура Команда1(Команда)
	Команда1НаСервере();
КонецПроцедуры

&НаСервере
Процедура Команда1НаСервере() Экспорт
	ИмяРеквизитаСоставногоТипа = ""Реквизит1"";
	
	//пОписаниеТипа = Новый ОписаниеТипов(""СправочникСсылка.Номенклатура,СправочникСсылка.Контрагенты"");
	Массив=Новый Массив;
	Массив.Добавить(Тип(""Строка""));
	Массив.Добавить(Тип(""Число""));
	пОписаниеТиповСтроки = Новый ОписаниеТипов(Массив,,,Новый КвалификаторыЧисла(18,2) , ,Новый КвалификаторыСтроки(50));		
	
	МассивРеквизитов = Новый Массив;
	МассивРеквизитов.Добавить(Новый РеквизитФормы(ИмяРеквизитаСоставногоТипа, пОписаниеТиповСтроки));
	ИзменитьРеквизиты(МассивРеквизитов);
	НовыйЭлемент = Элементы.Добавить(ИмяРеквизитаСоставногоТипа , Тип(""ПолеФормы""));
	НовыйЭлемент.Вид = ВидПоляФормы.ПолеВвода; 
	НовыйЭлемент.ПутьКДанным = ИмяРеквизитаСоставногоТипа;
	
КонецПроцедуры //Команда1НаСервере()"}
},
{0,
{"Панели разделов",0,0,"","Процедура УстановкаПараметровСеанса(ТребуемыеПараметры)    
	Настройки = ХранилищеСистемныхНастроек.Загрузить(             «Общее/НастройкиКлиентскогоПриложения»);
	Если Настройки=Неопределено Тогда
		Настройки = Новый НастройкиКлиентскогоПриложения;    
		Настройки.ОтображатьПанелиНавигацииИДействий = Ложь;   
		Настройки.ОтображатьПанельРазделов = Истина;     
		Настройки.РежимОткрытияФормПриложения= 	РежимОткрытияФормПриложения.Закладки;     
		ХранилищеСистемныхНастроек.Сохранить(              «Общее/НастройкиКлиентскогоПриложения»,,Настройки);  
	КонецЕсли; 
КонецПроцедуры  "}
},
{0,
{"ВопросАсинхронный",0,0,"","ВыполнитьЗадачуНаКлиентеДоВопроса(ДопПараметры);

&НаКлиенте
Процедура ВыполнитьЗадачуНаКлиентеДоВопроса(ДопПараметры)
	
	Если ЗадатьВопросПередВыполнением(ДопПараметры)	Тогда
		
		ОповещениеОЗакрытии = Новый ОписаниеОповещения(""ПослеЗакрытияВопросаВыполнитьЗадачуНаКлиенте"", ЭтаФорма, ДопПараметры);
		
		ТекстВопроса = ""Внимание после выполнения этой задачи, внести изменения в договор будет нельзя. ""
			+ Символы.ПС
			+ ""Если, Вы, все проверили тогда жмите Да"";
		
		ПоказатьВопрос(ОповещениеОЗакрытии,ТекстВопроса,РежимДиалогаВопрос.ДаНет);
		
	Иначе
		
		ВыполнитьЗадачуНаКлиенте(ДопПараметры);	
		
	Конецесли;
	
КонецПроцедуры

&НаКлиенте
Процедура ПослеЗакрытияВопросаВыполнитьЗадачуНаКлиенте(Результат, ДопПараметры) Экспорт
    Если Результат = КодВозвратаДиалога.Нет Тогда
        Возврат;
	КонецЕсли;
	
	ВыполнитьЗадачуНаКлиенте(ДопПараметры);
КонецПроцедуры "}
},
{0,
{"Методика расчета строки на упр форме",0,0,"","//Модуль формы

&НаКлиенте
Процедура ТЧБюджетПланПродажШтПриИзменении(Элемент)
	ПриИзмененииТЧБюджетНаКлиенте(""ПланПродажШт"");
КонецПроцедуры

&НаКлиенте
Процедура ПриИзмененииТЧБюджетНаКлиенте(ИмяРеквизита,ИмяСобытия = Неопределено) Экспорт
	
	СтрокаТЧБюджет = Элементы.ТЧБюджет.ТекущиеДанные; 
	Если СтрокаТЧБюджет = Неопределено тогда
		Возврат;
	Конецесли;
	
	ИмяТЧ = ""ТЧБюджет"";
	
	СтрокаТЧСтруктура = ПолучитьСтрокаТЧСтруктураНаСервере();
	ЗаполнитьЗначенияСвойств(СтрокаТЧСтруктура,СтрокаТЧБюджет);
	
	ПриИзмененииТЧНаСервере(СтрокаТЧСтруктура, ИмяРеквизита, ИмяТЧ, ИмяСобытия); 
	
	ЗаполнитьЗначенияСвойств(СтрокаТЧБюджет, СтрокаТЧСтруктура);
Конецпроцедуры

&НаСервереБезКонтекста
Функция ПолучитьСтрокаТЧСтруктураНаСервере()
	Возврат Документы.фнмБюджетПродажТехники.ПолучитьСтрокаТЧСтруктура();
КонецФункции 

&НаСервереБезКонтекста
Процедура ПриИзмененииТЧНаСервере(СтрокаТЧСтруктура, ИмяРеквизита, ИмяТЧ, ИмяСобытия)
	Документы.фнмБюджетПродажТехники.ПриИзмененииТЧ(СтрокаТЧСтруктура, ИмяРеквизита, ИмяТЧ, ИмяСобытия
КонецПроцедуры

//Модуль менеджера

Процедура ПриИзмененииТЧ(СтрокаТЧ, ИмяРеквизита, ИмяТЧ, ИмяСобытия = Неопределено) Экспорт
	Если ИмяТЧ <> ""ТЧБюджет"" Тогда
		Сообщить(""Ошибка! Нет алгоритм ИмяРеквизита [""+ИмяРеквизита+""] ИмяТЧ [""+ИмяТЧ+""] в процедуре ПриИзмененииТЧ"");
		Возврат;
	Конецесли;
	
	Если ИмяРеквизита = ""ПланПродажШт"" Тогда
		
		РассчитатьПланПродажРуб(СтрокаТЧ);
		
	ИначеЕсли ИмяРеквизита = ""ПланПродажРуб"" Тогда
		
		СтрокаТЧ.ЗаполненПланПродаж = ПолучитьЗаполненПланПродаж(СтрокаТЧ); 
		
		
	Иначе 
		Сообщить(""Ошибка! Нет алгоритм ИмяРеквизита [""+ИмяРеквизита+""] ИмяТЧ [""+ИмяТЧ+""] в процедуре ПриИзмененииТЧ"");
		Возврат;  
	Конецесли;
Конецпроцедуры

Функция ПолучитьСтрокаТЧСтруктура() Экспорт
	СтрокаТЧСтруктура = Новый Структура();
	
	РеквизитыТЧБюджет = Метаданные.Документы.фнмБюджетПродажТехники.ТабличныеЧасти.ТЧБюджет.Реквизиты;
	Для каждого пРеквизит из РеквизитыТЧБюджет цикл
		ИмяРеквизита = пРеквизит.Имя;
		
		ЗначениеПоУмолчанию = Неопределено;
		СтрокаТЧСтруктура.Вставить(""""+ИмяРеквизита,ЗначениеПоУмолчанию);   
		
	Конеццикла;
	Возврат СтрокаТЧСтруктура;
КонецФункции

"}
},
{0,
{"ИтогВПодвалеСОтбором",0,0,"","//На форме добавляются реквизиты:
//ПодвалВнутренниеЗапчастиРуб
//ПодвалМаржаРуб
//ПодвалПланПродажРуб
//ПодвалВыручкаРубДляPL
//ПодвалВнутренниеРаботыРуб
//Они указываются для каждой колонке в качестве ПутьКДаннымПодвала

//Версия 1
&НаКлиенте
Процедура ОбновитьИтогиВПодвале(СтруктураОтбора = Неопределено)
	Если СтруктураОтбора = Неопределено Тогда
		СтруктураОтбора = ПолучитьСтруктуруОтбора();
	Конецесли;
	
	//+ #1748 Иванов А.Б. 2017-10-16
	СтруктураИтоги = ПолучитьСтруктуруИтогиНаСервереСОтбором(СтруктураОтбора);
	Для каждого ЭлСтруктураИтоги из СтруктураИтоги цикл
		ИмяРеквизитаПодвала = ЭлСтруктураИтоги.Ключ;
		
		ЧислоВСтруктуре = ЭлСтруктураИтоги.Значение;
		Если ЗначениеЗаполнено(ЧислоВСтруктуре) Тогда
			ЧислоВСтруктуре = Формат(ЧислоВСтруктуре,""ЧГ=0"");
			ЧислоВСтруктуре = СтрЗаменить(ЧислоВСтруктуре,"","",""."");
		Конецесли;
		
		ТекстДляВычисления = ИмяРеквизитаПодвала +"" = ""+ ЧислоВСтруктуре;
		Выполнить(ТекстДляВычисления);
	Конеццикла;
	//- #1748 Иванов А.Б. 2017-10-16	
КонецПроцедуры 

//+ #1748 Иванов А.Б. 2017-10-16
&НаСервере
Функция ПолучитьСтруктуруИтогиНаСервереСОтбором(СтруктураОтбора) 
	СтруктураИтоги = Новый Структура();
	
	МассивКолонок = Новый Массив();
	МассивКолонок.Добавить(""ВнутренниеЗапчастиРуб"");
	МассивКолонок.Добавить(""ВнутренниеРаботыРуб"");
	МассивКолонок.Добавить(""ВыручкаРубДляPL"");
	МассивКолонок.Добавить(""МаржаРуб"");
	МассивКолонок.Добавить(""ПланПродажРуб"");
	МассивКолонок.Добавить(""ПланПродажШт"");
	МассивКолонок.Добавить(""СебестоимостьБезВнутреннихРаботНоСУчетомСебестоимостиЗапчастейРуб"");
	МассивКолонок.Добавить(""СебестоимостьРубДляPL"");
	МассивКолонок.Добавить(""СебестоимостьТехникиРуб"");
	МассивКолонок.Добавить(""СтрахованиеГрузовПеревыставленныеРуб"");
	МассивКолонок.Добавить(""СтрахованиеГрузовРуб"");
	МассивКолонок.Добавить(""ТранспортныеРасходыПеревыставленныеРуб"");
	МассивКолонок.Добавить(""ТранспортныеРасходыРуб"");
	
	Для каждого ИмяКолонки из МассивКолонок цикл
		СтруктураИтоги.Вставить(""Подвал""+ИмяКолонки,0);	
	Конеццикла;
	
	Если СтруктураОтбора.Количество() = 0 Тогда
		СтрокиТЧБюджет = Объект.ТЧБюджет; 
	Иначе
		СтрокиТЧБюджет = Объект.ТЧБюджет.НайтиСтроки(СтруктураОтбора);	
	Конецесли;
	
	Для каждого СтрокаТЧБюджет из СтрокиТЧБюджет цикл
		Для каждого ИмяКолонки из МассивКолонок цикл
			ИмяРеквизитаПодвала = ""Подвал""+ИмяКолонки;
			
			СтруктураИтоги[ИмяРеквизитаПодвала] = СтруктураИтоги[ИмяРеквизитаПодвала] + СтрокаТЧБюджет[ИмяКолонки];
		Конеццикла;
	Конеццикла;	
	Возврат СтруктураИтоги;
КонецФункции
//- #1748 Иванов А.Б. 2017-10-16


//Версия 0
&НаКлиенте
Процедура ОбновитьИтогиВПодвале(СтруктураОтбора)
	МассивКолонок = Новый Массив();
	МассивКолонок.Добавить(""ВнутренниеЗапчастиРуб"");
	МассивКолонок.Добавить(""ВнутренниеРаботыРуб"");
	МассивКолонок.Добавить(""ВыручкаРубДляPL"");
	МассивКолонок.Добавить(""МаржаРуб"");
	МассивКолонок.Добавить(""ПланПродажРуб"");
	МассивКолонок.Добавить(""ПланПродажШт"");
	МассивКолонок.Добавить(""СебестоимостьБезВнутреннихРаботНоСУчетомСебестоимостиЗапчастейРуб"");
	МассивКолонок.Добавить(""СебестоимостьРубДляPL"");
	МассивКолонок.Добавить(""СебестоимостьТехникиРуб"");
	МассивКолонок.Добавить(""СтрахованиеГрузовПеревыставленныеРуб"");
	МассивКолонок.Добавить(""СтрахованиеГрузовРуб"");
	МассивКолонок.Добавить(""ТранспортныеРасходыПеревыставленныеРуб"");
	МассивКолонок.Добавить(""ТранспортныеРасходыРуб"");
	
	Если СтруктураОтбора.Количество() = 0 Тогда
		СтрокиТЧБюджет = Объект.ТЧБюджет; 
	Иначе
		СтрокиТЧБюджет = Объект.ТЧБюджет.НайтиСтроки(СтруктураОтбора);	
	Конецесли;
	
	Для каждого ИмяКолонки из МассивКолонок цикл
		ИмяРеквизитаПодвала = ""Подвал""+ИмяКолонки;
		
		ТекстДляВычисления = ИмяРеквизитаПодвала +"" = 0"";
		Выполнить(ТекстДляВычисления);
	Конеццикла;	
	
	Для каждого СтрокаТЧБюджет из СтрокиТЧБюджет цикл
		Для каждого ИмяКолонки из МассивКолонок цикл
			ЧислоВКолонке = СтрокаТЧБюджет[ИмяКолонки];
			Если ЗначениеЗаполнено(ЧислоВКолонке) Тогда
				ЧислоВКолонке = Формат(ЧислоВКолонке,""ЧГ=0"");
				ЧислоВКолонке = СтрЗаменить(ЧислоВКолонке,"","",""."");
			Конецесли;
			
			ИмяРеквизитаПодвала = ""Подвал""+ИмяКолонки;
			
			ТекстДляВычисления = ИмяРеквизитаПодвала +"" = ""+ ИмяРеквизитаПодвала + ""+"" + ЧислоВКолонке;
			Выполнить(ТекстДляВычисления);
		Конеццикла;
	Конеццикла;	
	
КонецПроцедуры"}
},
{0,
{"ЗаменаТиповойПроцедурыВФорме",0,0,"","&НаСервере
Процедура фнмПриСозданииНаСервере(Отказ, СтандартнаяОбработка)
	ПриСозданииНаСервере(Отказ, СтандартнаяОбработка);
	пТекущийОбъект = РеквизитФормыВЗначение(""Объект"");
	фнмОбщийМодульСервер.ДобавитьРеквизитыНаФорму(ЭтотОбъект, пТекущийОбъект); 
КонецПроцедуры	

#Если Сервер тогда	
УстановитьДействие(""ПриСозданииНаСервере"",""фнмПриСозданииНаСервере"");
#КонецЕсли


//+ #2018 Иванов А.Б. 2018-05-07
&НаКлиенте
Процедура фнмСотрудникПриИзменении(Элемент) Экспорт
	СотрудникПриИзменении(Элемент);
КонецПроцедуры	                           
//- #2018 Иванов А.Б. 2018-05-07

//+ #2018 Иванов А.Б. 2018-05-07
#Если Сервер тогда	
Элементы.Сотрудник.УстановитьДействие(""ПриИзменении"",""фнмСотрудникПриИзменении"");
#КонецЕсли
//- #2018 Иванов А.Б. 2018-05-07
"}
},
{0,
{"ВыборФайлаДляСохранения",0,0,"","&НаКлиенте
Процедура ИмяФайлаДанныхНачалоВыбора(Элемент, ДанныеВыбора, СтандартнаяОбработка)
	Оповещение = Новый ОписаниеОповещения(""ОбработатьВыборФайла"",ЭтаФорма);
	
	Режим = РежимДиалогаВыбораФайла.Сохранение;
	//Режим = РежимДиалогаВыбораФайла.ВыборКаталога;
	ДиалогОткрытия = Новый ДиалогВыбораФайла(Режим);
	ДиалогОткрытия.ПолноеИмяФайла = """";
	Фильтр = ""(*.xml)|*.xml"";
	ДиалогОткрытия.Фильтр = Фильтр;
	ДиалогОткрытия.МножественныйВыбор = Ложь;
	ДиалогОткрытия.Заголовок = ""Выберете файл для сохранения"";


	ДиалогОткрытия.Показать(Оповещение);	
КонецПроцедуры

&НаКлиенте
Процедура ОбработатьВыборФайла(ВыбранныеФайлы, Параметры) Экспорт
	Если ВыбранныеФайлы = Неопределено Тогда
		Возврат;
	Конецесли;
	
	Объект.ИмяФайлаДанных = ВыбранныеФайлы[0];
КонецПроцедуры
"}
},
{0,
{"ИзменитьРеквизиты (добавить реквизит формы программно)",0,0,"","//+ #3334 Иванов А.Б. 2018-09-15
&НаСервере
Процедура фнмПриСозданииНаСервере(Отказ, СтандартнаяОбработка)
	ПриСозданииНаСервере(Отказ, СтандартнаяОбработка);
	
	Реквизит_фнмДатаВыплаты = Новый РеквизитФормы(""фнмДатаВыплаты"",
		Новый ОписаниеТипов(""Дата""),,""Дата выплаты"");
		
	МассивРеквизитов = Новый Массив;
	МассивРеквизитов.Добавить(Реквизит_фнмДатаВыплаты);
	
	ИзменитьРеквизиты(МассивРеквизитов);
	
	пЭлементПоле_фнмДатаВыплаты = Элементы.Вставить(""фнмДатаВыплаты"",Тип(""ПолеФормы""),Элементы.Шапка,Неопределено);
	пЭлементПоле_фнмДатаВыплаты.Вид = ВидПоляФормы.ПолеВвода;
	пЭлементПоле_фнмДатаВыплаты.ПутьКДанным = ""фнмДатаВыплаты"";
	
КонецПроцедуры	
//- #3334 Иванов А.Б. 2018-09-15
                              
//+ #3334 Иванов А.Б. 2018-09-15
#Если Сервер тогда	
УстановитьДействие(""ПриСозданииНаСервере"",""фнмПриСозданииНаСервере"");
#КонецЕсли                              
//- #3334 Иванов А.Б. 2018-09-15"}
}
},
{6,
{"ЗУП 3.х",1,0,"",""},
{0,
{"ПолучениеСпискаСотрудников",0,0,"","	ПараметрыПолучения = КадровыйУчет.ПараметрыПолученияСотрудниковОрганизацийПоСпискуФизическихЛиц();
	ПараметрыПолучения.НачалоПериода = ДатаРасчета;
	ПараметрыПолучения.ОкончаниеПериода = ДатаРасчета;
	ТаблицаСотрудников = КадровыйУчет.СотрудникиОрганизации(Истина, ПараметрыПолучения);
	МассивСотрудников = ТаблицаСотрудников.ВыгрузитьКолонку(""Сотрудник"");
"}
},
{0,
{"ДатаЗапретаРедактирования",0,0,"","//Модуль объекта событие перед записью 
//+ #3047 Иванов А.Б. 2018-07-03	
ДополнительныеСвойства.Вставить(""РежимЗаписи"", РежимЗаписи);

фнмОбщийМодульСервер.ПроверитьДатыЗапретаИзмененияДанных(ЭтотОбъект, Отказ);                              
//- #3047 Иванов А.Б. 2018-07-03

//Модуль формы событие при создании на сервере
//+ #2003 Иванов А.Б. 2018-08-03
Если НЕ Объект.Ссылка.Пустая() Тогда
	пОтказ = Ложь;
	пОбъект = РеквизитФормыВЗначение(""Объект""); 
	фнмОбщийМодульСервер.ПроверитьДатыЗапретаИзмененияДанных(пОбъект, пОтказ);	
	Если пОтказ Тогда
		ТолькоПросмотр = Истина;
	Конецесли;
Конецесли;
//- #2003 Иванов А.Б. 2018-08-03

//Еще необходимо добавить источники данных	
ЗарплатаКадрыБазовый.ЗаполнитьИсточникиДанныхДляПроверкиЗапретаИзменения	
// Раздел КадровыйУчет
ДатыЗапретаИзменения.ДобавитьСтроку(ИсточникиДанных, ""Документ.ПриемНаРаботу"",                     ""Дата"",   ""КадровыйУчет"", ""Организация"");
//+ #3047 Иванов А.Б. 2018-07-03
ДатыЗапретаИзменения.ДобавитьСтроку(ИсточникиДанных, ""Документ.фнмСлужебнаяПоездка"", ""Дата"",   ""КадровыйУчет"", ""Организация"");                              
//- #3047 Иванов А.Б. 2018-07-03


//Прочее
ДатыЗапретаИзмененияСлужебный.ПроверитьДатыЗапретаИзмененияЗагрузкиДанных(
	Источник, Отказ, ИсточникРегистр, Замещение, Удаление);

"}
},
{0,
{"ОсновнойСотрудникФизЛица",0,0,"","КадровыйУчетРасширенный.ОсновнойСотрудникФизЛица(
					пФизическоеЛицоПоИсполнительномуЛисту, Организация, НаДату, Истина);"}
},
{0,
{"ЗначениеРеквизитаОбъекта",0,0,"","ОбщегоНазначения.ЗначениеРеквизитаОбъекта(Ведомость.СпособВыплаты, ""ХарактерВыплаты"");"}
},
{0,
{"ПропуститьПроверкуЗапретаИзменения",0,0,"","ДополнительныеСвойства.Вставить(""ПропуститьПроверкуЗапретаИзменения"",Истина);"}
},
{0,
{"ПолучитьНомерБезПрефиксОрганизации",0,0,"","	Если НастройкиПечатныхФорм.УдалятьПрефиксыОрганизацииИИБИзНомеровКадровыхПриказов Тогда
		Возврат ПрефиксацияОбъектовКлиентСервер.НомерНаПечать(НомерПриказа, Истина, Истина);
	КонецЕсли;
"}
}
},
{7,
{"Структура модулей",1,0,"",""},
{0,
{"1.4. Шаблон Общие модули",0,0,"","//1.4. Шаблон (заготовка для копирования) разделов для общих модулей:

#Область ПрограммныйИнтерфейс
// Код процедур и функций
#КонецОбласти

#Область СлужебныйПрограммныйИнтерфейс
// Код процедур и функций
#КонецОбласти

#Область СлужебныеПроцедурыИФункции
// Код процедур и функций
#КонецОбласти

"}
},
{0,
{"1.5. Шаблон оформления разделов для модулей объектов, менеджеров, наборов записей, обработок, отчетов и т.п.:",0,0,"","//1.5. Шаблон оформления разделов для модулей объектов, менеджеров, наборов записей, обработок, отчетов и т.п.:

#Область ПрограммныйИнтерфейс
// Код процедур и функций
#КонецОбласти

#Область ОбработчикиСобытий
// Код процедур и функций
#КонецОбласти

#Область СлужебныйПрограммныйИнтерфейс
// Код процедур и функций
#КонецОбласти

#Область СлужебныеПроцедурыИФункции
// Код процедур и функций
#КонецОбласти

"}
},
{0,
{"1.6. Шаблон оформления разделов для модулей форм:",0,0,"","//1.6. Шаблон оформления разделов для модулей форм:

#Область ОбработчикиСобытийФормы
// Код процедур и функций
#КонецОбласти

#Область ОбработчикиСобытийЭлементовШапкиФормы
// Код процедур и функций
#КонецОбласти

#Область ОбработчикиСобытийЭлементовТаблицыФормы<ИмяТаблицыФормы>
// Код процедур и функций
#КонецОбласти

#Область ОбработчикиКомандФормы
// Код процедур и функций
#КонецОбласти

#Область СлужебныеПроцедурыИФункции
// Код процедур и функций
#КонецОбласти

"}
},
{0,
{"1.7. Шаблон оформления разделов для модулей команд:",0,0,"","//1.7. Шаблон оформления разделов для модулей команд:

#Область ОбработчикиСобытий
// Код процедур и функций
#КонецОбласти

#Область СлужебныеПроцедурыИФункции
// Код процедур и функций
#КонецОбласти"}
},
{0,
{"1.8. В модуле не должно быть пустых областей.",0,0,"",""}
},
{0,
{"2.2. Раздел описания переменных",0,0,"","//2.2. Раздел описания переменных

#Область ОписаниеПеременных

Перем ВалютаУчета;
Перем АдресПоддержки;
...

#КонецОбласти

"}
},
{0,
{"2.7. Раздел инициализации содержит операторы, инициализирующие переменные модуля или объект (форму). ¶",0,0,"","//2.7. Раздел инициализации содержит операторы, инициализирующие переменные модуля или объект (форму). 


#Область Инициализация

АдресПоддержки = ""v8@1c.ru""; 
ВыполнитьИнициализацию();
...

#КонецОбласти
"}
}
},
{3,
{"БСП",1,0,"",""},
{0,
{"ЕстьРеквизитОбъекта",0,0,"","ОбщегоНазначенияУХ.ЕстьРеквизитОбъекта(""НСИ_ВИБ"",НовыйОбъект)"}
},
{0,
{"ЗаменитьНедопустимыеСимволыВИмениФайла",0,0,"","//ОбщегоНазначенияКлиентСервер.ЗаменитьНедопустимыеСимволыВИмениФайла(ИмяФайла,НаЧтоМенять)


// Заменяет недопустимые символы в имени файла.
//
// Параметры:
//  ИмяФайла     - Строка - исходное имя файла.
//  НаЧтоМенять  - Строка - строка, на которую необходимо заменить недопустимые символы.
//
// Возвращаемое значение:
//   Строка - преобразованное имя файла.
//
&НаСервере
Функция ЗаменитьНедопустимыеСимволыВИмениФайла(Знач ИмяФайла, НаЧтоМенять = "" "") Экспорт

	Результат = ИмяФайла;
	МассивНайденныхНедопустимыхСимволов = НайтиНедопустимыеСимволыВИмениФайла(Результат);
	Для Каждого НедопустимыйСимвол Из МассивНайденныхНедопустимыхСимволов Цикл
		Результат = СтрЗаменить(Результат, НедопустимыйСимвол, НаЧтоМенять);
	КонецЦикла;
	
	Возврат Результат;

КонецФункции

// Возвращает строку недопустимых символов.
// Согласно http://en.wikipedia.org/wiki/Filename - в разделе ""Reserved characters and words"".
// Возвращаемое значение:
//   Строка - строка недопустимых символов.
&НаСервере
Функция ПолучитьНедопустимыеСимволыВИмениФайла() Экспорт

	НедопустимыеСимволы = """"""/\[]:;|=?*<>"";
	НедопустимыеСимволы = НедопустимыеСимволы + Символы.Таб;
	Возврат НедопустимыеСимволы;

КонецФункции

// Проверяет наличие недопустимых символов в имени файла.
//
// Параметры:
//  ИмяФайла  - Строка - имя файла.
//
// Возвращаемое значение:
//   Массив   - массив обнаруженных в имени файла недопустимых символов.
//              Если недопустимых символов не обнаружено - возвращается пустой массив.
&НаСервере
Функция НайтиНедопустимыеСимволыВИмениФайла(ИмяФайла) Экспорт

	НедопустимыеСимволы = ПолучитьНедопустимыеСимволыВИмениФайла();
	
	МассивНайденныхНедопустимыхСимволов = Новый Массив;
	
	Для ПозицияСимвола = 1 По СтрДлина(НедопустимыеСимволы) Цикл
		ПроверяемыйСимвол = Сред(НедопустимыеСимволы,ПозицияСимвола,1);
		Если СтрНайти(ИмяФайла,ПроверяемыйСимвол) <> 0 Тогда
			МассивНайденныхНедопустимыхСимволов.Добавить(ПроверяемыйСимвол);
		КонецЕсли;
	КонецЦикла;
	
	Возврат МассивНайденныхНедопустимыхСимволов;

КонецФункции

"}
},
{0,
{"Расширеннная настройка отчетов",0,0,"","//Расширеннная настройка отчетов
//необходимо право СохранениеДанныхПользователя и Добавление справочника ВариантыОтчетов"}
}
},
{0,
{"ТЗ.Колонки.Добавить",0,1,"","ТЗ.Колонки.Добавить(""Номенклатура"",ОписаниеТипов)
Новый ОписаниеТипов(""СправочникСсылка.Номенклатура"")
Новый ОписаниеТипов(""Число"")
Новый ОписаниеТипов(""СправочникСсылка.Номенклатура,СправочникСсылка.МестаХранения"")

Массив=Новый Массив;
Массив.Добавить(Тип(""Строка""));
ОписаниеТиповСтроки = Новый ОписаниеТипов(Массив, , ,Новый КвалификаторыСтроки(12));	
ТЗ_ТСД.Колонки.Добавить(""Штрихкод"",ОписаниеТиповСтроки);
"}
},
{0,
{"ТабДокумент.Выдача",0,1,"","Макет = ПолучитьМакет(""Макет"");
ЗаголовокМакета="""";
ВидДокумента="""";
ОбластьМакета = Макет.ПолучитьОбласть(""Шапка"");
ТабДокумент = Новый ТабличныйДокумент();	
ОбластьМакета.Параметры.ТекстПериода = ПредставлениеПериода(НачалоМесяца(ДатаНач), КонецМесяца(ДатаКон), ""ФП = Истина"");	
ТабДокумент.Вывести(ОбластьМакета);			  
для каждого СтрокаТЧ из ТЗ цикл
	ОбластьМакета = Макет.ПолучитьОбласть(""Строка"");
	ОбластьМакета.Параметры.Заполнить(СтрокаТЧ);
	ТабДокумент.Вывести(ОбластьМакета);			  
конеццикла;


ТабДокумент.ОтображатьЗаголовки = Ложь;
ТабДокумент.ОтображатьСетку = Ложь;
ТабДокумент.ТолькоПросмотр = Истина;	
ТабДокумент.ИмяСохраненияПоложенияОкна=""""+ПараметрыСеанса.ТекущийПользователь+ВидДокумента;
ТабДокумент.Показать(ЗаголовокМакета);


//Сгруппировать колонки в таб документе
ОбластьЯчеек = ТабДокумент.Область(""C2"");
ОбластьЯчеек.Сгруппировать(""Счет МСФО"",РасположениеЗаголовкаГруппировкиТабличногоДокумента.Начало);"}
},
{0,
{"ВыборПериода",0,1,"","Процедура ВыбПериодНажатие(Элемент)
	НастройкаПериода = Новый НастройкаПериода;
	НастройкаПериода.УстановитьПериод(ДатаНач, ?(ДатаКон='0001-01-01', ДатаКон, КонецДня(ДатаКон)));
	НастройкаПериода.РедактироватьКакИнтервал = Истина;
	НастройкаПериода.РедактироватьКакПериод = Истина;
	НастройкаПериода.ВариантНастройки = ВариантНастройкиПериода.Период;
	НастройкаПериода.Редактировать();
	ДатаНач = НачалоДня(НастройкаПериода.ПолучитьДатуНачала());
	ДатаКон = КонецДня(НастройкаПериода.ПолучитьДатуОкончания());
КонецПроцедуры
"}
},
{0,
{"ОтборВТЧ",0,1,"","Отбор=ЭлементыФормы[ИмяТЧ].ОтборСтрок;
ОтборПоОборудованию=Отбор.Оборудование;
ОтборПоОборудованию.Значение=пОборудование;
ОтборПоОборудованию.Использование=Истина;


Отбор=ЭлементыФормы.ПринятыеКУчетуОС.ОтборСтрок;
Отбор.ДокументПринятияКУчету.Значение = ?(ДокументОтбор=Неопределено, Документы.ПринятиеКУчетуОС.ПустаяСсылка(),ДокументОтбор);
Отбор.ДокументПринятияКУчету.Использование=Истина;


//Для упр.формы
	
Элементы.ТЧДляОтбора.ОтборСтрок = Новый ФиксированнаяСтруктура(""КлючСтроки"", КлючСтроки);  
	"}
},
{0,
{"НачалоВыбора",0,1,"","СтандартнаяОбработка = Ложь;	
ФормаВыбора = Справочники.Смены.ПолучитьФормуВыбора(, Элемент);
ФормаВыбора.РежимВыбора = Истина;	
ОтборПоСсылке=ФормаВыбора.Отбор.Ссылка;
ОтборПоСсылке.ВидСравнения=ВидСравнения.ВСписке;
ОтборПоСсылке.Значение=СписокСмен;
ОтборПоСсылке.Использование=Истина;
ФормаВыбора.Открыть();

Процедура НачалоВыбора(Элемент, СтандартнаяОбработка)
	СтандартнаяОбработка = Ложь;	
	ФормаВыбора = Документы.ПланПроизводства.ПолучитьФормуВыбора(, Элемент);
	ФормаВыбора.РежимВыбора = Истина;
	ФормаВыбора.ЭлементыФормы.ДокументСписок.НастройкаОтбора[ФормаВыбора.Отбор.Подразделение.Имя].Доступность = Ложь;		
	ФормаВыбора.Отбор.Подразделение.Установить(Подразделение, Истина);
	ФормаВыбора.Отбор.Дата.ЗначениеС=ДобавитьМесяц(НачалоМесяца(Дата),-2);
	ФормаВыбора.Отбор.Дата.ЗначениеПо=КонецМесяца(Дата);
	ФормаВыбора.Отбор.Дата.Использование=Истина;
	ФормаВыбора.Отбор.ПометкаУдаления.Установить(Ложь, Истина);
	ФормаВыбора.Открыть();
	
КонецПроцедуры

ФормаВыбора.ЭлементыФормы.СправочникСписок.ТекущаяСтрока=Элемент.Значение;
ЭлементыФормы.СправочникСписок.ИерархическийПросмотр = Ложь;
ЭлементыФормы.СправочникСписок.НастройкаОтбора.ЭтоГруппа.Доступность= Истина;
"}
},
{0,
{"ВыборИзСписка",0,0,"","Процедура НоменклатураСтараяНачалоВыбораИзСписка(Элемент, СтандартнаяОбработка)
	СписокВыбора = Новый СписокЗначений();
	Для каждого СтрокаНС из НайденныеСтроки цикл
		СписокВыбора.Добавить(СтрокаНС.ТехнологическаяОперация);
	конеццикла;
	Элемент.СписокВыбора = СписокВыбора;

КонецПроцедуры


"}
},
{0,
{"ПривестиЗначение",0,1,"","ОписаниеТипа=Новый ОписаниеТипов(""ДокументСсылка.ПланЗакупок"");
ЭлементыФормы.ДокументОснование.Значение=ОписаниеТипа.ПривестиЗначение(ЭлементыФормы.ДокументОснование.Значение);
ЭлементыФормы.ДокументОснование.ВыбиратьТип = Ложь;


СтатусЭлементУправления = Элемент;			
ТипСтр = ""ПеречислениеСсылка.СостоянияСобытий"";
СтатусЭлементУправления.ОграничениеТипа = Новый ОписаниеТипов(ТипСтр);
СтатусЭлементУправления.Значение = СтатусЭлементУправления.ОграничениеТипа.ПривестиЗначение(СтатусЭлементУправления.Значение);
СтатусЭлементУправления.ВыбиратьТип = Ложь;	"}
},
{0,
{"ОтборВЗапросе",0,1,"","Если ЗначениеЗаполнено(Подразделение) и Подразделение<> Справочники.Подразделения.ПустаяСсылка() тогда
	Запрос.Текст=СтрЗаменить(Запрос.Текст,""//ОтборПоПодразделению"","""");		
	Запрос.УстановитьПараметр(""Подразделение"",Подразделение);
конецесли;
"}
},
{0,
{"ОформлениеСтроки",0,0,"","Процедура ТЧКомпьютернаяТехникаПриПолученииДанных(Элемент, ОформленияСтрок)	
	Для каждого ЭлемОформления из ОформленияСтрок цикл
		ЭлемОформления.Ячейки.ДоменноеИмя.Значение=ЭлемОформления.Ячейки.КомпьютернаяТехника.Значение.ДоменноеИмя;
		флЖирный=ЭлемОформления.ДанныеСтроки.рздПартнер;
		ЭлемОформления.Шрифт=Новый Шрифт(,,флЖирный);
	конеццикла;
КонецПроцедуры
"}
},
{0,
{"ВыборФайла",0,0,"","Процедура ПутьДоФайлаНачалоВыбора(Элемент, СтандартнаяОбработка)
	Диалог = Новый ДиалогВыбораФайла(РежимДиалогаВыбораФайла.Открытие);
	Диалог.Заголовок = ""Выберите фай"";
	Диалог.Фильтр=""(*.xlsx)|*.xlsx"";
	//Диалог.ПолнвоеИмяФайла = ФайлСоответстствия;	
	Если Диалог.Выбрать() Тогда
		ИмяФайла=Диалог.ПолноеИмяФайла;
	КонецЕсли; 
КонецПроцедуры


&НаКлиенте
Процедура ВыборФайла(ПроверятьСуществование=Ложь)
	ИмяФайлаДанныхКлиент = Объект.ИмяФайлаДанныхКлиент;	
	
	ДиалогФыбораФайла								=	Новый ДиалогВыбораФайла(РежимДиалогаВыбораФайла.Открытие);
	
	ДиалогФыбораФайла.Фильтр						=	""Файл данных (*.xml)|*.xml"";
	ДиалогФыбораФайла.Заголовок						=	""Выберите файл"";
	ДиалогФыбораФайла.ПредварительныйПросмотр		=	Ложь;
	ДиалогФыбораФайла.Расширение					=	""xml"";
	ДиалогФыбораФайла.ИндексФильтра					=	0;
	ДиалогФыбораФайла.ПолноеИмяФайла				=	ИмяФайлаДанныхКлиент;
	ДиалогФыбораФайла.ПроверятьСуществованиеФайла	=	Ложь;
	
	Если ДиалогФыбораФайла.Выбрать() Тогда
		Объект.ИмяФайлаДанныхКлиент = ДиалогФыбораФайла.ПолноеИмяФайла;
	КонецЕсли;

КонецПроцедуры
"}
},
{0,
{"РаботаСТХТ",0,0,"","Процедура Кнопка1Нажатие(Элемент)
   Путь = ""c:\test.txt""; 
   Текст = Новый ЗаписьТекста(Путь, КодировкаТекста.UTF8); 
   Выборка = Справочники.Номенклатура.Выбрать(); 

   Пока Выборка.Следующий() Цикл 
      Текст.ЗаписатьСтроку(Выборка.Наименование); 
   КонецЦикла;

   Текст.Закрыть(); 
      
   //Путь = ""c:\test.txt""; 
   Текст = Новый ЧтениеТекста(Путь, КодировкаТекста.UTF8); 
   Строка = Текст.ПрочитатьСтроку(); 

   Пока Строка <> Неопределено Цикл 
       Строка = Текст.ПрочитатьСтроку(); 
       Сообщить(Строка); 
   КонецЦикла; 
КонецПроцедуры

Процедура Кнопка2Нажатие(Элемент)
   Текст = Новый ТекстовыйДокумент; 
   Текст.Прочитать(""c:\test.txt""); 

   Для НомерСтроки = 1 По Текст.КоличествоСтрок() Цикл 
      Стр = Текст.ПолучитьСтроку(НомерСтроки); 
      Позиция = Найти(Стр, Символ(34)); 
      Код = Сред(Стр, 1, Позиция-1); 
      прНаименование = Сред(Стр, Позиция + 1); 
      Наименование = СтрЗаменить(прНаименование, ""%квч%"", Символ(34)); 

      Сообщить(Код + ""-"" + Наименование); 
   КонецЦикла; 
КонецПроцедуры"}
},
{0,
{"Кол-во экземпляров",0,0,"","ТабДокумент.КоличествоЭкземпляров = КоличествоЭкземпляров;
 
 ТабДокумент.ОбластьПечати = ТабДокумент.Области.Заголовок;"}
},
{0,
{"Инициализировать",0,0,"","Процедура Инициализировать(Объект, ИмяТабличнойЧасти="""", ТабличноеПолеОбъекта="""") Экспорт 	
	ПрочиеЗатраты=Объект.ПрочиеЗатраты;
	ПрочиеЗатраты.Свернуть(""СтатьяЗатрат,Заказ,МодельНУостатковНЗП,НоменклатурнаяГруппа,СпособРаспределенияЗатратНаВыпуск,СчетЗатрат,СчетЗатратНУ,ПодразделениеНЗП,ПодразделениеОрганизацииНЗП,ВидВыпуска"",""Сумма,СуммаРегл,СуммаНал"");		
	Для каждого стрПрочаяЗатрата из ПрочиеЗатраты цикл
		стрПрочаяЗатрата.СуммаНал=ПолучитьОстатокПрочихЗатрат(Объект,стрПрочаяЗатрата.СтатьяЗатрат);
	конеццикла;	
конецпроцедуры
Функция Печать() Экспорт
конецфункции
Процедура Инициализировать(Объект, ИмяТабличнойЧасти="""", ТабличноеПолеОбъекта="""") Экспорт 
	ФормаДок=ЭтотОбъект.ПолучитьФорму();	
	ФормаДок.ДокОбъект=Объект;
	ФормаДок.ФормаДокОбъект=Объект.ПолучитьФорму();
	ФормаДок.Открыть();	
конецпроцедуры
"}
},
{0,
{"СортировкаВСписке",0,0,"","ЭлементУП = ЭлементыФормы.СправочникСписок.НастройкаПорядка.Найти(""ФизЛицо"");
Если ЭлементУП <> Неопределено Тогда
	ЭлементУП.Доступность = Истина; 
КонецЕсли;	

ЭлементУП = ЭлементыФормы.ДокументСписок.НастройкаПорядка.Найти(""ВидЗадания"");
Если ЭлементУП <> Неопределено Тогда
	ЭлементУП.Доступность = Истина; 
КонецЕсли;
ЭлементУП = ЭлементыФормы.ДокументСписок.НастройкаПорядка.Найти(""Оборудование"");
Если ЭлементУП <> Неопределено Тогда
	ЭлементУП.Доступность = Истина; 
КонецЕсли;	
ДокументСписок.Порядок.Установить(""Дата,ВидЗадания,Оборудование""); 
"}
},
{0,
{"ФиксацияВТЧ",0,0,"","Элемент.ФиксацияСлева = 0 + Элемент.Колонки.НомерСтроки.Видимость
		+ Элемент.Колонки.ТабельныйНомерСтрока.Видимость
		+ Элемент.Колонки.Сотрудник.Видимость
		+ Элемент.Колонки.Итого.Видимость;
"}
},
{0,
{"ПодвалВТЧ",0,0,"","Колонка=ЭлементыФормы[ИмяТЧ].Колонки.ЗаданиеНаРаскрой;
Колонка.ТекстПодвала=""Кол-во заданий: ""+ТЧ.Количество();
Колонка.Видимость=Истина; 	

Колонка=ЭлементыФормы[ИмяТЧ].Колонки.КВыпуску;
Колонка.ТекстПодвала=Формат(ТЧ.Итог(""КВыпуску""),""ЧДЦ=3"");
Колонка.Видимость=Истина; 


ЭлементыФормы.Начисления.Колонки.Показатель1.ТекстПодвала=Формат(ДокументОбъект.Начисления.Итог(""Показатель1""),""ЧДЦ=2"");
ЭлементыФормы.Начисления.Колонки.Показатель1.Видимость=Истина;

//Обновляет числовые показатели в подвале ТЧ, для отбора

Процедура ОбновитьПодвалВТЧ(ТЧ,ОтборСтрок,ИмяТЧ)
	ТЗ=ПолучитьТЗСОтборовВТЧ(ТЧ,ОтборСтрок);
	#Если Тромбон тогда
		ТЗ=Новый ТаблицаЗначений;
	#Конецесли
	СтрокаСуммирования="""";
	ТипЧисло=Тип(""Число"");
	МассивКолонок=Новый Массив();
	Для каждого Колонка из ТЗ.Колонки цикл
		Если Колонка.ТипЗначения.СодержитТип(ТипЧисло) Тогда
			СтрокаСуммирования=СтрокаСуммирования+"",""+Колонка.Имя;
			МассивКолонок.Добавить(Колонка.Имя);
		Конецесли;
	Конеццикла;
	ТЗ.Свернуть("""",СтрокаСуммирования);
	
	Для каждого ЭлМассива из МассивКолонок цикл
		Если ТЗ.Количество() = 0 Тогда
			ТекстПодвала="""";
		Иначе
			ТекстПодвала=ТЗ[0][ЭлМассива];
		Конецесли;
		ЭлементыФормы[ИмяТЧ].Колонки[ЭлМассива].ТекстПодвала=ТекстПодвала;	
		ЭлементыФормы[ИмяТЧ].Колонки[ЭлМассива].ГоризонтальноеПоложениеВПодвале=ГоризонтальноеПоложение.Право;
	Конеццикла;
Конецпроцедуры

"}
},
{0,
{"РасчетПодвала",0,0,"","Процедура РасчетПодвала(ИмяТЧ,ИтогиПоКолонкам)
	Отбор=ЭлементыФормы[ИмяТЧ].ОтборСтрок;
	ПараметрыОтбора=Новый Структура();
	Для каждого ЭлементОтбора из Отбор цикл
		Если ЭлементОтбора.Использование Тогда
			ПараметрыОтбора.Вставить(ЭлементОтбора.Имя,ЭлементОтбора.Значение);
		Конецесли;
	Конеццикла;
	Если ПараметрыОтбора.Количество()>0 Тогда
		НайденныеСтроки=ЭтотОбъект[ИмяТЧ].НайтиСтроки(ПараметрыОтбора);
		ТЗИзМассива=ПолучитьТЗИзМассива(НайденныеСтроки , ИмяТЧ);
	Иначе
		ТЗИзМассива=ЭтотОбъект[ИмяТЧ];
	Конецесли;	
	
	Для каждого ИмяКолонки из ИтогиПоКолонкам цикл
		ЭлементыФормы[ИмяТЧ].Колонки[ИмяКолонки].ТекстПодвала=Формат(ТЗИзМассива.Итог(ИмяКолонки),""ЧДЦ=2"");
	Конеццикла;	
Конецпроцедуры
"}
},
{0,
{"ЗапросSQL",0,0,"","
Функция ЗапросSQL(ТекстSQL)   //Функция выборки данных из SQL сервера и передача во временную таблицу 1С

	СтрокаСоединения = (""Provider=SQLOLEDB;Driver={SQL Server}; Deleted=No; Data Source = "") + ""a05-sql\Gemo"" +""; DATABASE=""+""Gemo""+ 
	("";UID="") + ""sa"" + (""; PWD="") + ""gemo"" + ("";"");
	           
	Подключение = Новый ComObject(""ADODB.Connection"");
	Подключение.ConnectionString=СтрокаСоединения;
	КолвоПопыток=3;
	ТекПопытка=1;
	//Пока ТекПопытка <= КолвоПопыток цикл
		Попытка
			Подключение.Open(СтрокаСоединения);
			//Прервать;
		Исключение
			Сообщить(ОписаниеОшибки());
			
			Возврат Ложь;
		КонецПопытки;		
		ТекПопытка=ТекПопытка+1;
	//конеццикла;
	Если ТекПопытка>КолвоПопыток тогда
		Возврат Ложь;	
	конецесли;
	СоединениеSQL = Новый COMObject(""ADODB.Command"");
	СоединениеSQL.ActiveConnection = Подключение;
	СоединениеSQL.NamedParameters = True;
	СоединениеSQL.CommandText = ТекстSQL;
	СоединениеSQL.CommandType = 1;
	//СоединениеSQL.Prepared = Истина;

	//Param1 = СоединениеSQL.CreateParameter(""n"",3,1,1,1);
	//СоединениеSQL.Parameters.Append(Param1);

	//Param2 = СоединениеSQL.CreateParameter(""ДатаПриходаС"",200,1,8,Формат(НачалоПериода,""ДФ=ггггММдд""));//Формат(НачалоПериода,""ДФ=ггггММдд""));
	//СоединениеSQL.Parameters.Append(Param2);

	//Param3 = СоединениеSQL.CreateParameter(""ДатаПриходаПо"",200,1,8,Формат(КонецПериода,""ДФ=ггггММдд""));
	//СоединениеSQL.Parameters.Append(Param3);

	//СоединениеSQL.Parameters.Refresh();

	//Состояние (""Выполнение запроса SQL..."");
	ЗаписиSQL = Новый ComObject(""ADODB.RecordSet"");
    Попытка 
		ЗаписиSQL = СоединениеSQL.Execute();
	исключение
		Возврат Ложь;
	конецпопытки;


	Таблица = Новый ТаблицаЗначений;
	//Состояние (""Заполнение временной таблицы..."");
	Для НомерСтолбца = 0 По ЗаписиSQL.Fields.Count-1 Цикл //Создание и добавление колонок во временную таблицу
		ИмяСтолбца =ЗаписиSQL.Fields.Item(НомерСтолбца).Name; 
		Таблица.Колонки.Добавить(ИмяСтолбца);
		//Сообщить(ИмяСтолбца);
	КонецЦикла;


	Пока ЗаписиSQL.EOF = 0 Цикл // Заполнение созданной таблицы
		НоваяСтрока =  Таблица.Добавить();
		Для НомерСтолбца = 0 По ЗаписиSQL.Fields.Count-1 Цикл
			НоваяСтрока.Установить(НомерСтолбца,ЗаписиSQL.Fields(НомерСтолбца).Value);
			//Сообщить (""Test "" + ЗаписиSQL.Fields(ИмяСтолбца).Value + ИмяСтолбца);
		КонецЦикла;
		ЗаписиSQL.MoveNext();
	КонецЦикла;
   
	//Состояние (""Закрываем соединение с SQL..."");
	ЗаписиSQL.Close();
	Подключение.Close();

	Возврат Таблица;   // Возврат таблицы значений запроса SQL

КонецФункции

"}
},
{0,
{"#Если",0,0,"#","#Если Сервер И НЕ Сервер тогда 
	//Условие в конструкции специально сделано невыполнимым
	ДокОбъект = Документы.ОтчетПроизводстваЗаСмену.СоздатьДокумент();
#Конецесли"}
},
{0,
{"ВидСравнения",0,0,"","Функция ПолучитьУсловие(ОтборПоПолю,ВидСравнения)
	ТекстОтбора="""";
	Если ВидСравнения=ВидСравненияКомпоновкиДанных.Равно тогда
		ТекстОтбора="" И ""+ОтборПоПолю+""=&""+ОтборПоПолю+"" "";
	ИначеЕсли ВидСравнения=ВидСравненияКомпоновкиДанных.НеРавно тогда
		ТекстОтбора="" И НЕ ""+ОтборПоПолю+""=&""+ОтборПоПолю+"" "";			
	ИначеЕсли ВидСравнения=ВидСравненияКомпоновкиДанных.ВИерархии тогда
		ТекстОтбора="" И ""+ОтборПоПолю+"" В ИЕРАРХИИ (&""+ОтборПоПолю+"") "";
	ИначеЕсли ВидСравнения=ВидСравненияКомпоновкиДанных.ВСписке тогда
		ТекстОтбора="" И ""+ОтборПоПолю+"" В (&""+ОтборПоПолю+"") "";
	ИначеЕсли ВидСравнения=ВидСравненияКомпоновкиДанных.ВСпискеПоИерархии тогда
		ТекстОтбора="" И ""+ОтборПоПолю+"" В ИЕРАРХИИ (&""+ОтборПоПолю+"") "";					
	ИначеЕсли ВидСравнения=ВидСравненияКомпоновкиДанных.Больше тогда
		ТекстОтбора="" И ""+ОтборПоПолю+"" > &""+ОтборПоПолю+"" "";								
	ИначеЕсли ВидСравнения=ВидСравненияКомпоновкиДанных.БольшеИлиРавно тогда
		ТекстОтбора="" И ""+ОтборПоПолю+"" >= &""+ОтборПоПолю+"" "";										
	ИначеЕсли ВидСравнения=ВидСравненияКомпоновкиДанных.Меньше тогда
		ТекстОтбора="" И ""+ОтборПоПолю+"" < &""+ОтборПоПолю+"" "";										
	ИначеЕсли ВидСравнения=ВидСравненияКомпоновкиДанных.МеньшеИлиРавно тогда
		ТекстОтбора="" И ""+ОтборПоПолю+"" <= &""+ОтборПоПолю+"" "";										
	ИначеЕсли ВидСравнения=ВидСравненияКомпоновкиДанных.НеВИерархии тогда
		ТекстОтбора="" И ""+ОтборПоПолю+""НЕ В ИЕРАРХИИ (&""+ОтборПоПолю+"") "";
	ИначеЕсли ВидСравнения=ВидСравненияКомпоновкиДанных.НеВСписке тогда
		ТекстОтбора="" И ""+ОтборПоПолю+""НЕ В (&""+ОтборПоПолю+"") "";
	ИначеЕсли ВидСравнения=ВидСравненияКомпоновкиДанных.НеВСпискеПоИерархии тогда
		ТекстОтбора="" И ""+ОтборПоПолю+""НЕ В ИЕРАРХИИ(&""+ОтборПоПолю+"") "";
	ИначеЕсли ВидСравнения=ВидСравненияКомпоновкиДанных.Содержит тогда
		ТекстОтбора="" И ""+ОтборПоПолю+""ПОДОБНО %""+ОтборПоПолю+""% "";
	ИначеЕсли ВидСравнения=ВидСравненияКомпоновкиДанных.НеСодержит тогда
		ТекстОтбора="" И ""+ОтборПоПолю+""НЕ ПОДОБНО %""+ОтборПоПолю+""% "";
	Иначе
		ТекстОтбора="""";	
	конецесли;	
	
	Возврат ТекстОтбора;
Конецфункции
"}
},
{0,
{"РегистрСведений и редактирование одной записи",0,0,"","НаборЗаписей = РегистрыСведений.алмазШтрихКодыСотрудников.СоздатьНаборЗаписей();
НаборЗаписей.Отбор.Сотрудник.Установить(СсылкаНаОбъект);
НаборЗаписей.Прочитать();
Запись = НаборЗаписей.Добавить();
Запись.Период = НачалоМесяца(ТекущаяДата());
Запись.Активность = Истина;
Запись.Сотрудник = СсылкаНаОбъект;
Запись.ШтрихКод = ШтрихКод;
НаборЗаписей.Записать();

Процедура КнопкаВыполнитьНажатие(Кнопка)
	Для каждого СтрокаАвтомобили из ЗаявкаНаБронирования.Автомобили цикл
		НаДату = НачалоДня(СтрокаАвтомобили.ДатаОкончанияБронирования);
		
		пПараметрыОтбора = Новый Структура();
		пПараметрыОтбора.Вставить(""ХарактеристикаНоменклатуры"",СтрокаАвтомобили.ХарактеристикаНоменклатуры);
		Выборка = РегистрыСведений.фнмБронированиеАвтомобилей.Выбрать(НаДату,,пПараметрыОтбора ,""Возр"");
		Пока Выборка.Следующий() Цикл
			Запись = Выборка.ПолучитьМенеджерЗаписи();
			Запись.Прочитать();
			Если ЗаявкаНаБронирования.ПроцентПредоплаты <> 0 Тогда
				Запись.Период = СтрокаАвтомобили.ДатаОкончанияБронирования + 3600*24*365*3;
			Иначе
				Запись.Период = СтрокаАвтомобили.ДатаОкончанияБронирования;
			Конецесли;
			Запись.Записать();
		Конеццикла;
	Конеццикла;
КонецПроцедуры


"}
},
{0,
{"ТекДанные",0,0,"Тек[Данные]","Строка<?""ИмяЭлемента""> = ЭлементыФормы.<?""ИмяЭлемента"">.ТекущиеДанные;	
Если Строка<?""ИмяЭлемента""> = Неопределено тогда
	Возврат;	
КонецЕсли;	

<?>"}
},
{0,
{"ТекДанныеУпр",0,0,"Тек[у]","Строка<?""ИмяЭлемента""> = Элементы.<?""ИмяЭлемента"">.ТекущиеДанные;	
Если Строка<?""ИмяЭлемента""> = Неопределено тогда
	Возврат;	
КонецЕсли;	

<?>"}
},
{0,
{"ПрограммноеСозданиеЭлементов",0,0,"","ИндексКЕ = ЭлементыФормы.Товары.Колонки.Индекс(ЭлементыФормы.Товары.Колонки.ХарактеристикаНоменклатуры);

рздКолонка = ЭлементыФормы.Товары.Колонки.Вставить(ИндексКЕ+1, ""Качество"");
рздКолонка.Имя = ""рздКачество"";
рздКолонка.Данные = ""рздКачество"";
рздКолонка.УстановитьЭлементУправления(Тип(""ПолеВвода""));
рздКолонка.ЭлементУправления.КнопкаВыбора = Истина;
рздКолонка.ЭлементУправления.КнопкаОткрытия = Истина;


//+ Раздолье Малышев Д.А. 2013-11-07
ЭлементыФормы.Материалы.Колонки.ФизЛицо.ЭлементУправления.УстановитьДействие(""НачалоВыбора"", Новый Действие(""рздМатериалыФизЛицоНачалоВыбора""));
ЭлементыФормы.Материалы.Колонки.ФизЛицо.ЭлементУправления.УстановитьДействие(""ОбработкаВыбора"", Новый Действие(""рздМатериалыФизЛицоОбработкаВыбора""));
ЭлементыФормы.Материалы.Колонки.ФизЛицо.ЭлементУправления.УстановитьДействие(""АвтоПодборТекста"", Новый Действие(""рздМатериалыФизЛицоАвтоПодборТекста""));
ЭлементыФормы.Материалы.Колонки.ФизЛицо.ЭлементУправления.УстановитьДействие(""ОкончаниеВводаТекста"", Новый Действие(""рздМатериалыФизЛицоОкончаниеВводаТекста""));
//- Раздолье Малышев Д.А. 2013-11-07



КнопкаЦелое = ЭлементыФормы.Добавить(Тип(""Кнопка""), ""БлюдоЦелое"" +ТекИдЭлемента, Истина);
	КнопкаЦелое.ЦветФонаКнопки = МФонНеНажатойКнопки;
	КнопкаЦелое.Заголовок = ""1"";
	КнопкаЦелое.Шрифт = ШрифтКнопки;
	КнопкаЦелое.Верх = ТекВерх;
	КнопкаЦелое.Лево = ТекЛево+Надпись.Ширина;
	КнопкаЦелое.Ширина = Надпись.Высота;
	КнопкаЦелое.Высота = Надпись.Высота;
	Действие = Новый Действие(""РеакцияНаНажатие"");
	КнопкаЦелое.УстановитьДействие(""Нажатие"", Действие);	

	// Создание колонки
	Колонка=ЭлементыФормы.СоставПлана.Колонки.Добавить(ИмяКолонки,СинонимКолонки);
	Колонка.УстановитьЭлементУправления(Тип(""ПолеВвода""));
	Колонка.ЭлементУправления.ТипЗначения=Новый ОписаниеТипов(""Дата"", Новый КвалификаторыДаты());
	
	Колонка=ЭлементыФормы.СоставПлана.Колонки.Найти(мИмяКолонкиПодразделение+СтрокаТЧ.НомерСтрокиПодразделение);
	Действие = Новый Действие(""ПодразделениеДатаЗапускаПриИзменении"");
	Колонка.ЭлементУправления.УстановитьДействие(""ПриИзменении"", Действие);		
	
		рздКнопкиПодменюЗаполнить=ЭлементыФормы.КоманднаяПанельТовары.Кнопки.ПодменюЗаполнить.Кнопки;
	ТипКнопки = ТипКнопкиКоманднойПанели.Действие;
	рздКнопкиПодменюЗаполнить.Добавить(""рздВводПалетРулонов"", ТипКнопки,""Ввод палет/рулонов"" , Новый Действие(""рздВводПалетРулонов""));	"}
},
{0,
{"OLE и COM ",0,0,"","//Теперь вот это надо юзать
#Область УстановкаCOMСоединения
Функция УстановитьСоединениеСЗУП()
	
	СтруктураНастроек = ПолучитьСтруктуруНастроекДляПодключения();
	ВнешняяБазаЗУП = ПодключитьВнешнююБазу1С(СтруктураНастроек);
	
	СтруктураВозврата = Новый Структура;
	СтруктураВозврата.Вставить(""ВнешняяБазаЗУП"",ВнешняяБазаЗУП);
	
	Возврат СтруктураВозврата;
	
КонецФункции

Функция ПолучитьСтруктуруНастроекДляПодключения() 
		
	СтруктураНастроек = Новый Структура;
	СтруктураНастроек.Вставить(""ВариантРаботыИнформационнойБазы""            , 1);
	СтруктураНастроек.Вставить(""ИмяИнформационнойБазыНаСервере1СПредприятия"", ""demo_FNM_HRM"");
	СтруктураНастроек.Вставить(""ИмяСервера1СПредприятия""                    , ""MSK0-1CAPP5.fnm.loc"");
	СтруктураНастроек.Вставить(""АутентификацияОперационнойСистемы""          , Ложь);
	СтруктураНастроек.Вставить(""ИмяПользователя""                            , ""Иванов Антон Борисович"");
	СтруктураНастроек.Вставить(""ПарольПользователя""                         , ""Test2018"");
	
	Возврат СтруктураНастроек;
КонецФункции

Функция ПодключитьВнешнююБазу1С(СтруктураНастроек,Отказ=ложь) Экспорт
	
	СтрокаСообщенияОбОшибке = """";
	
	// выполняем попытку установки внешнего соединения
	ВнешнееСоединение = УстановитьВнешнееСоединение(СтруктураНастроек, СтрокаСообщенияОбОшибке);
	
	Если ВнешнееСоединение = Неопределено Тогда
		
		// Выводим сообщение об ошибке
		Сообщение = НСтр(""ru = 'Ошибка при установке подключения ко второй информационной базе: %1'"");
		Сообщение = ПодставитьПараметрыВСтроку(Сообщение, СтрокаСообщенияОбОшибке);
		Сообщить(Сообщение);
		
	КонецЕсли;
	
	Возврат ВнешнееСоединение;
КонецФункции

// Устанавливает внешнее соединение с информационной базой по переданным параметрам подключения и возвращает указатель на это соединение
// 
// Параметры:
//  Параметры - Структура - содержит параметры для установки внешнего соединения с информационной базой.
//  Структура должна содержать следующие ключи (см. функция ОбщегоНазначенияКлиентСервер.СтруктураПараметровДляУстановкиВнешнегоСоединения):
//
//	  ВариантРаботыИнформационнойБазы             - (Число)  Вариант работы информационной базы: 0 – файловый; 1 – клиент-серверный
//	  КаталогИнформационнойБазы                   - (Строка) Каталог информационной базы для файлового режима работы
//	  ИмяСервера1СПредприятия                     - (Строка) Имя сервера1С:Предприятия
//	  ИмяИнформационнойБазыНаСервере1СПредприятия - (Строка) Имя информационной базы на сервере1С:Предприятия
//	  АутентификацияОперационнойСистемы           - (Булево) Признак аутентификации операционной системы при создании внешнего подключения к информационной базе
//	  ИмяПользователя                             - (Строка) Имя пользователя информационной базы
//	  ПарольПользователя                          - (Строка) Пароль пользователя информационной базы
// 
//  СтрокаСообщенияОбОшибке (необязательный) – Строка – если в процессе установки внешнего соединения возникает ошибка,
//                                                     то подробное описание ошибки помещается в этот параметр
//
// Возвращаемое значение:
//  Тип: COM-объект, Неопределенно.
//  в случае успешной установки внешнего соединения возвращается указатель на COM-объект соединения;
//  в случае ошибки возвращается Неопределенно.
//
Функция УстановитьВнешнееСоединение(Параметры, СтрокаСообщенияОбОшибке = """", ОшибкаПодключенияКомпоненты = Ложь) Экспорт
	
	Результат = УстановитьВнешнееСоединениеСБазой(Параметры);
	
	ОшибкаПодключенияКомпоненты = Результат.ОшибкаПодключенияКомпоненты;
	СтрокаСообщенияОбОшибке     = Результат.ПодробноеОписаниеОшибки;
	
	Возврат Результат.Соединение;

КонецФункции

// Возвращает имя COM-класса для работы с 1С:Предприятием 8 через COM-соединение.
//
Функция ИмяCOMСоединителя() Экспорт
	
	СистемнаяИнфо = Новый СистемнаяИнформация;
	ПодстрокиВерсии = РазложитьСтрокуВМассивПодстрок(
		СистемнаяИнфо.ВерсияПриложения, ""."");
	Возврат ""v"" + ПодстрокиВерсии[0] + ПодстрокиВерсии[1] + "".COMConnector"";
	
КонецФункции

// Устанавливает внешнее соединение с информационной базой по переданным параметрам подключения и возвращает указатель на это соединение
// 
// Параметры:
//  Параметры - Структура - содержит параметры для установки внешнего соединения с информационной базой.
//  Структура должна содержать следующие ключи (см. функция ОбщегоНазначенияКлиентСервер.СтруктураПараметровДляУстановкиВнешнегоСоединения):
//
//	  ВариантРаботыИнформационнойБазы             - (Число)  Вариант работы информационной базы: 0 – файловый; 1 – клиент-серверный
//	  КаталогИнформационнойБазы                   - (Строка) Каталог информационной базы для файлового режима работы
//	  ИмяСервера1СПредприятия                     - (Строка) Имя сервера1С:Предприятия
//	  ИмяИнформационнойБазыНаСервере1СПредприятия - (Строка) Имя информационной базы на сервере1С:Предприятия
//	  АутентификацияОперационнойСистемы           - (Булево) Признак аутентификации операционной системы при создании внешнего подключения к информационной базе
//	  ИмяПользователя                             - (Строка) Имя пользователя информационной базы
//	  ПарольПользователя                          - (Строка) Пароль пользователя информационной базы
// 
// Возвращаемое значение - структура:
//  Соединение                  - (COM-объект) указатель на COM-объект соединения или Неопределено в случае ошибки
//  КраткоеОписаниеОшибки       - (Строка) краткое описание ошибки
//  ПодробноеОписаниеОшибки     - (Строка) подробное описание ошибки
//  ОшибкаПодключенияКомпоненты - (Булево) флаг ошибки подключения COM
//
Функция УстановитьВнешнееСоединениеСБазой(Параметры) Экспорт
	
	Результат = Новый Структура(""Соединение, КраткоеОписаниеОшибки, ПодробноеОписаниеОшибки, ОшибкаПодключенияКомпоненты"",
	Неопределено, """", """", Ложь
	);
	
	Попытка
		COMConnector = Новый COMObject(ИмяCOMСоединителя()); // ""V82.COMConnector""
	Исключение
		Информация = ИнформацияОбОшибке();
		СтрокаСообщенияОбОшибке = НСтр(""ru = 'Не удалось подключится к другой программе: %1'"");
		
		Результат.ОшибкаПодключенияКомпоненты = Истина;
		Результат.ПодробноеОписаниеОшибки     = ПодставитьПараметрыВСтроку(СтрокаСообщенияОбОшибке, ПодробноеПредставлениеОшибки(Информация));
		Результат.КраткоеОписаниеОшибки       = ПодставитьПараметрыВСтроку(СтрокаСообщенияОбОшибке, КраткоеПредставлениеОшибки(Информация));
		
		Возврат Результат;
	КонецПопытки;
	
	Если Параметры.ВариантРаботыИнформационнойБазы = 0 Тогда
		// Файловый режим
		Если ПустаяСтрока(Параметры.КаталогИнформационнойБазы) Тогда
			СтрокаСообщенияОбОшибке = НСтр(""ru = 'Не задано месторасположение каталога информационной базы.'"");
			Результат.ПодробноеОписаниеОшибки = СтрокаСообщенияОбОшибке;
			Результат.КраткоеОписаниеОшибки   = СтрокаСообщенияОбОшибке;
			Возврат Результат;
			
		КонецЕсли;
		
		Если Параметры.АутентификацияОперационнойСистемы Тогда
			СтрокаСоединения = ""File = """"&КаталогИнформационнойБазы"""""";
			
			СтрокаСоединения = СтрЗаменить(СтрокаСоединения, ""&КаталогИнформационнойБазы"", Параметры.КаталогИнформационнойБазы);
			
		Иначе
			СтрокаСоединения = ""File = """"&КаталогИнформационнойБазы""""; Usr = """"&ИмяПользователя""""; Pwd = """"&ПарольПользователя"""""";
			
			СтрокаСоединения = СтрЗаменить(СтрокаСоединения, ""&КаталогИнформационнойБазы"", Параметры.КаталогИнформационнойБазы);
			СтрокаСоединения = СтрЗаменить(СтрокаСоединения, ""&ИмяПользователя"",           Параметры.ИмяПользователя);
			СтрокаСоединения = СтрЗаменить(СтрокаСоединения, ""&ПарольПользователя"",        Параметры.ПарольПользователя);
			
		КонецЕсли;
		
	Иначе 
		// Клиент-серверный вариант работы информационной базы
		Если ПустаяСтрока(Параметры.ИмяСервера1СПредприятия) Или ПустаяСтрока(Параметры.ИмяИнформационнойБазыНаСервере1СПредприятия) Тогда
			СтрокаСообщенияОбОшибке = НСтр(""ru = 'Не заданы обязательные параметры подключения: """"Имя сервера""""; """"Имя информационной базы на сервере"""".'"");
			
			Результат.ПодробноеОписаниеОшибки = СтрокаСообщенияОбОшибке;
			Результат.КраткоеОписаниеОшибки   = СтрокаСообщенияОбОшибке;
			Возврат Результат;
			
		КонецЕсли;
		
		Если Параметры.АутентификацияОперационнойСистемы Тогда
			СтрокаСоединения = ""Srvr = &ИмяСервера1СПредприятия; Ref = &ИмяИнформационнойБазыНаСервере1СПредприятия"";
			
			СтрокаСоединения = СтрЗаменить(СтрокаСоединения, ""&ИмяСервера1СПредприятия"",                     Параметры.ИмяСервера1СПредприятия);
			СтрокаСоединения = СтрЗаменить(СтрокаСоединения, ""&ИмяИнформационнойБазыНаСервере1СПредприятия"", Параметры.ИмяИнформационнойБазыНаСервере1СПредприятия);
			
		Иначе
			СтрокаСоединения = ""Srvr = &ИмяСервера1СПредприятия; Ref = &ИмяИнформационнойБазыНаСервере1СПредприятия; Usr = """"&ИмяПользователя""""; Pwd = """"&ПарольПользователя"""""";
			
			СтрокаСоединения = СтрЗаменить(СтрокаСоединения, ""&ИмяСервера1СПредприятия"",                     Параметры.ИмяСервера1СПредприятия);
			СтрокаСоединения = СтрЗаменить(СтрокаСоединения, ""&ИмяИнформационнойБазыНаСервере1СПредприятия"", Параметры.ИмяИнформационнойБазыНаСервере1СПредприятия);
			СтрокаСоединения = СтрЗаменить(СтрокаСоединения, ""&ИмяПользователя"",                             Параметры.ИмяПользователя);
			СтрокаСоединения = СтрЗаменить(СтрокаСоединения, ""&ПарольПользователя"",                          Параметры.ПарольПользователя);
			
		КонецЕсли;
		
	КонецЕсли;
	
	Попытка
		Результат.Соединение = COMConnector.Connect(СтрокаСоединения);
	Исключение
		Информация = ИнформацияОбОшибке();
		СтрокаСообщенияОбОшибке = НСтр(""ru = 'Не удалось подключится к другой программе: %1'"");
		
		Результат.ОшибкаПодключенияКомпоненты = Истина;
		Результат.ПодробноеОписаниеОшибки     = ПодставитьПараметрыВСтроку(СтрокаСообщенияОбОшибке, ПодробноеПредставлениеОшибки(Информация));
		Результат.КраткоеОписаниеОшибки       = ПодставитьПараметрыВСтроку(СтрокаСообщенияОбОшибке, КраткоеПредставлениеОшибки(Информация));
		
	КонецПопытки;
	
	Возврат Результат;
КонецФункции

// Подставляет параметры в строку. Максимально возможное число параметров - 9.
// Параметры в строке задаются как %<номер параметра>. Нумерация параметров начинается с единицы.
//
// Параметры:
//  СтрокаПодстановки  – Строка – шаблон строки с параметрами (вхождениями вида ""%ИмяПараметра"");
//  Параметр<n>        - Строка - подставляемый параметр.
//
// Возвращаемое значение:
//  Строка   – текстовая строка с подставленными параметрами.
//
// Пример:
//  ПодставитьПараметрыВСтроку(НСтр(""ru='%1 пошел в %2'""), ""Вася"", ""Зоопарк"") = ""Вася пошел в Зоопарк"".
//
Функция ПодставитьПараметрыВСтроку(Знач СтрокаПодстановки,
	Знач Параметр1, Знач Параметр2 = Неопределено, Знач Параметр3 = Неопределено,
	Знач Параметр4 = Неопределено, Знач Параметр5 = Неопределено, Знач Параметр6 = Неопределено,
	Знач Параметр7 = Неопределено, Знач Параметр8 = Неопределено, Знач Параметр9 = Неопределено) Экспорт
	
	ИспользоватьАльтернативныйАлгоритм = 
		Найти(Параметр1, ""%"")
		Или Найти(Параметр2, ""%"")
		Или Найти(Параметр3, ""%"")
		Или Найти(Параметр4, ""%"")
		Или Найти(Параметр5, ""%"")
		Или Найти(Параметр6, ""%"")
		Или Найти(Параметр7, ""%"")
		Или Найти(Параметр8, ""%"")
		Или Найти(Параметр9, ""%"");
		
	Если ИспользоватьАльтернативныйАлгоритм Тогда
		СтрокаПодстановки = ПодставитьПараметрыВСтрокуАльтернативныйАлгоритм(СтрокаПодстановки, Параметр1,
			Параметр2, Параметр3, Параметр4, Параметр5, Параметр6, Параметр7, Параметр8, Параметр9);
	Иначе
		СтрокаПодстановки = СтрЗаменить(СтрокаПодстановки, ""%1"", Параметр1);
		СтрокаПодстановки = СтрЗаменить(СтрокаПодстановки, ""%2"", Параметр2);
		СтрокаПодстановки = СтрЗаменить(СтрокаПодстановки, ""%3"", Параметр3);
		СтрокаПодстановки = СтрЗаменить(СтрокаПодстановки, ""%4"", Параметр4);
		СтрокаПодстановки = СтрЗаменить(СтрокаПодстановки, ""%5"", Параметр5);
		СтрокаПодстановки = СтрЗаменить(СтрокаПодстановки, ""%6"", Параметр6);
		СтрокаПодстановки = СтрЗаменить(СтрокаПодстановки, ""%7"", Параметр7);
		СтрокаПодстановки = СтрЗаменить(СтрокаПодстановки, ""%8"", Параметр8);
		СтрокаПодстановки = СтрЗаменить(СтрокаПодстановки, ""%9"", Параметр9);
	КонецЕсли;
	
	Возврат СтрокаПодстановки;
КонецФункции

// Разбивает строку на несколько строк по разделителю. Разделитель может иметь любую длину.
//
// Параметры:
//  Строка                 - Строка - текст с разделителями;
//  Разделитель            - Строка - разделитель строк текста, минимум 1 символ;
//  ПропускатьПустыеСтроки - Булево - признак необходимости включения в результат пустых строк.
//    Если параметр не задан, то функция работает в режиме совместимости со своей предыдущей версией:
//     - для разделителя-пробела пустые строки не включаются в результат, для остальных разделителей пустые строки
//       включаются в результат.
//     - если параметр Строка не содержит значащих символов или не содержит ни одного символа (пустая строка), то в
//       случае разделителя-пробела результатом функции будет массив, содержащий одно значение """" (пустая строка), а
//       при других разделителях результатом функции будет пустой массив.
//
//
// Возвращаемое значение:
//  Массив - массив строк.
//
// Примеры:
//  РазложитьСтрокуВМассивПодстрок("",один,,два,"", "","") - возвратит массив из 5 элементов, три из которых  - пустые строки;
//  РазложитьСтрокуВМассивПодстрок("",один,,два,"", "","", Истина) - возвратит массив из двух элементов;
//  РазложитьСтрокуВМассивПодстрок("" один   два  "", "" "") - возвратит массив из двух элементов;
//  РазложитьСтрокуВМассивПодстрок("""") - возвратит пустой массив;
//  РазложитьСтрокуВМассивПодстрок("""",,Ложь) - возвратит массив с одним элементом """" (пустой строкой);
//  РазложитьСтрокуВМассивПодстрок("""", "" "") - возвратит массив с одним элементом """" (пустой строкой);
//
Функция РазложитьСтрокуВМассивПодстрок(Знач Строка, Знач Разделитель = "","", Знач ПропускатьПустыеСтроки = Неопределено) Экспорт
	
	Результат = Новый Массив;
	
	// для обеспечения обратной совместимости
	Если ПропускатьПустыеСтроки = Неопределено Тогда
		ПропускатьПустыеСтроки = ?(Разделитель = "" "", Истина, Ложь);
		Если ПустаяСтрока(Строка) Тогда 
			Если Разделитель = "" "" Тогда
				Результат.Добавить("""");
			КонецЕсли;
			Возврат Результат;
		КонецЕсли;
	КонецЕсли;
	//
	
	Позиция = Найти(Строка, Разделитель);
	Пока Позиция > 0 Цикл
		Подстрока = Лев(Строка, Позиция - 1);
		Если Не ПропускатьПустыеСтроки Или Не ПустаяСтрока(Подстрока) Тогда
			Результат.Добавить(Подстрока);
		КонецЕсли;
		Строка = Сред(Строка, Позиция + СтрДлина(Разделитель));
		Позиция = Найти(Строка, Разделитель);
	КонецЦикла;
	
	Если Не ПропускатьПустыеСтроки Или Не ПустаяСтрока(Строка) Тогда
		Результат.Добавить(Строка);
	КонецЕсли;
	
	Возврат Результат;
	
КонецФункции 

// Вставляет параметры в строку, учитывая, что в параметрах могут использоваться подстановочные слова %1, %2 и т.д.
Функция ПодставитьПараметрыВСтрокуАльтернативныйАлгоритм(Знач СтрокаПодстановки,
	Знач Параметр1, Знач Параметр2 = Неопределено, Знач Параметр3 = Неопределено,
	Знач Параметр4 = Неопределено, Знач Параметр5 = Неопределено, Знач Параметр6 = Неопределено,
	Знач Параметр7 = Неопределено, Знач Параметр8 = Неопределено, Знач Параметр9 = Неопределено)
	
	Результат = """";
	Позиция = Найти(СтрокаПодстановки, ""%"");
	Пока Позиция > 0 Цикл 
		Результат = Результат + Лев(СтрокаПодстановки, Позиция - 1);
		СимволПослеПроцента = Сред(СтрокаПодстановки, Позиция + 1, 1);
		ПодставляемыйПараметр = """";
		Если СимволПослеПроцента = ""1"" Тогда
			ПодставляемыйПараметр =  Параметр1;
		ИначеЕсли СимволПослеПроцента = ""2"" Тогда
			ПодставляемыйПараметр =  Параметр2;
		ИначеЕсли СимволПослеПроцента = ""3"" Тогда
			ПодставляемыйПараметр =  Параметр3;
		ИначеЕсли СимволПослеПроцента = ""4"" Тогда
			ПодставляемыйПараметр =  Параметр4;
		ИначеЕсли СимволПослеПроцента = ""5"" Тогда
			ПодставляемыйПараметр =  Параметр5;
		ИначеЕсли СимволПослеПроцента = ""6"" Тогда
			ПодставляемыйПараметр =  Параметр6;
		ИначеЕсли СимволПослеПроцента = ""7"" Тогда
			ПодставляемыйПараметр =  Параметр7
		ИначеЕсли СимволПослеПроцента = ""8"" Тогда
			ПодставляемыйПараметр =  Параметр8;
		ИначеЕсли СимволПослеПроцента = ""9"" Тогда
			ПодставляемыйПараметр =  Параметр9;
		КонецЕсли;
		Если ПодставляемыйПараметр = """" Тогда
			Результат = Результат + ""%"";
			СтрокаПодстановки = Сред(СтрокаПодстановки, Позиция + 1);
		Иначе
			Результат = Результат + ПодставляемыйПараметр;
			СтрокаПодстановки = Сред(СтрокаПодстановки, Позиция + 2);
		КонецЕсли;
		Позиция = Найти(СтрокаПодстановки, ""%"");
	КонецЦикла;
	Результат = Результат + СтрокаПодстановки;
	
	Возврат Результат;
КонецФункции
#КонецОбласти

//Ранее
Перем ВнешняяБазаЗУП Экспорт;

Функция ПолучитьСтруктуруНастроекДляПодключения(ПараметрИмяСервера="""",ПараметрИмяБазы="""")
	
	мУзелЗУП = Справочники.фнмКонстанты.ПолучитьЗначениеКонстанты(""УзелЗУП"",Тип(""ПланОбменаСсылка.фнмОбмен""));

	#Если Тромбон тогда
		мУзелЗУП = ПланыОбмена.фнмОбмен.ПустаяСсылка();
	#Конецесли
	
	СтруктураНастроек = Новый Структура;
	СтруктураНастроек.Вставить(""ВариантРаботыИнформационнойБазы"",1);
	СтруктураНастроек.Вставить(""ИмяИнформационнойБазыНаСервере1СПредприятия"",мУзелЗУП.ИмяБазы);
	СтруктураНастроек.Вставить(""ИмяСервера1СПредприятия"",мУзелЗУП.ИмяСервера);
	СтруктураНастроек.Вставить(""АутентификацияОперационнойСистемы"",Истина);
	Возврат СтруктураНастроек;
КонецФункции // ПолучитьСтруктуруНастроекДляПодключения()

Функция ПодключитьВнешнююБазу1С(СтруктураНастроек,Отказ=ложь)
	
	СтрокаСообщенияОбОшибке = """";
	
	// выполняем попытку установки внешнего соединения
	ВнешнееСоединение = ОбщегоНазначения.УстановитьВнешнееСоединение(СтруктураНастроек, СтрокаСообщенияОбОшибке);
	
	Если ВнешнееСоединение = Неопределено Тогда
		
		// Выводим сообщение об ошибке
		Сообщение = НСтр(""ru = 'Ошибка при установке подключения ко второй информационной базе: %1'"");
		Сообщение = СтроковыеФункцииКлиентСервер.ПодставитьПараметрыВСтроку(Сообщение, СтрокаСообщенияОбОшибке);
		ОбщегоНазначенияКлиентСервер.СообщитьПользователю(Сообщение,,,, Отказ);
		
	КонецЕсли;
	
	Возврат ВнешнееСоединение;
КонецФункции

//старый вариант
Перем Соединение Экспорт;

Процедура УстановитьСоединение(СтрокаСоединения, ИДОбъекта) Экспорт
	Если СокрЛП(СтрокаСоединения) = """" тогда
		ВызватьИсключение(""Не заполнена строка соединения!"");
	КонецЕсли;	
	
	Если СокрЛП(ИДОбъекта) = """" тогда
		ВызватьИсключение(""Не указан идентификатор СОМ объекта!"");
	КонецЕсли;
	
	Если Соединение <> Null тогда
		Сообщить(""Соединение с информационной базой уже установлено"", СтатусСообщения.Внимание);
		Возврат;
	КонецЕсли;	
	
	COMОбъект = Новый COMОбъект(ИДОбъекта);
	
	Если ИДОбъекта = ""V82.Application"" Тогда
		COMОбъект.Connect(СтрокаСоединения);
		Соединение = COMОбъект;
	Иначе
		Соединение = COMОбъект.Connect(СтрокаСоединения);
	КонецЕсли;
		
КонецПроцедуры
Процедура ПроверитьСоединение() Экспорт
	Если Соединение = Null тогда
		ВызватьИсключение(""Соединение с информационной базой не установлено!"");
	КонецЕсли;	
КонецПроцедуры

//Тело модуля
Соединение = Null;




////// на ФОРМЕ
Процедура КнопкаПодключитьсяНажатие(Элемент)
	Если ПереключательТипСоединения=1 тогда
		ИДСОМ = ""V82.Application""; 
	Иначе
		ИДСОМ = ""V82.ComConnector""; 
	КонецЕсли;
	
	СтрокаСоединения = """";
	Если ПереключательТипБазы=1 тогда
		СтрокаСоединения = ""Srvr=""""""+СокрЛП(СерверИБ)+"""""";Ref=""""""+СокрЛП(ИмяИБ)+"""""";Usr=""""""+ИмяПользователя+"""""";Pwd=""""""+Пароль+"""""""";
	Иначе	
		СтрокаСоединения = ""File="""""" + ПутьКбазе + """""";Usr=""""""+ИмяПользователя+"""""";Pwd=""""""+Пароль+"""""""";
	КонецЕсли;	
	
	Если ВинАвторизация Тогда
		СтрокаСоединения = ""Srvr=""""""+СокрЛП(СерверИБ)+"""""";Ref=""""""+СокрЛП(ИмяИБ)+"""""" "";
	КонецЕсли;
		
	ЭтотОбъект.УстановитьСоединение(СтрокаСоединения, ИДСОМ);
КонецПроцедуры
Процедура ОтключитьИБ(Элемент)
	Если Вопрос(""Отключить БД?"",РежимДиалогаВопрос.ДаНет) = КодВозвратаДиалога.Да Тогда
		Соединение = Null;
	КонецЕсли;
КонецПроцедуры

Процедура ОбновлениеОтображения()
	ОбновитьНадписи();
КонецПроцедуры
Процедура ОбновитьНадписи()"}
},
{0,
{"ПредставлениеМесяца",0,0,"","	НомерМесяца=Месяц(НаДату);
	МесяцГод="""";
	Если НомерМесяца=1 Тогда МесяцГод=""Январь""; Конецесли;
	Если НомерМесяца=2 Тогда МесяцГод=""Февраль"" Конецесли;
	Если НомерМесяца=3 Тогда МесяцГод=""Март"" Конецесли;
	Если НомерМесяца=4 Тогда МесяцГод=""Апрель"" Конецесли;
	Если НомерМесяца=5 Тогда МесяцГод=""Май"" Конецесли;
	Если НомерМесяца=6 Тогда МесяцГод=""Июнь"" Конецесли;
	Если НомерМесяца=7 Тогда МесяцГод=""Июль"" Конецесли;
	Если НомерМесяца=8 Тогда МесяцГод=""Август"" Конецесли;
	Если НомерМесяца=9 Тогда МесяцГод=""Сентябрь"" Конецесли;
	Если НомерМесяца=10 Тогда МесяцГод=""Октябрь"" Конецесли;
	Если НомерМесяца=11 Тогда МесяцГод=""Ноябрь"" Конецесли;
	Если НомерМесяца=12 Тогда МесяцГод=""Декабрь"" Конецесли;
	МесяцГод=МесяцГод+"" ""+Год(НаДату);
	Возврат МесяцГод;
"}
},
{0,
{"ТекущийПользователь",0,0,"Текп","ТекПользователь = глЗначениеПеременной(""глТекущийПользователь"");
<?>"}
},
{0,
{"СписокЗначенийВРеквизитеФормы",0,0,"","Процедура УстановитьТипЗначения(ВыбранныйВидСравнения,НазваниеЭлементаФормы,ТипЗначения)
	Если ВыбранныйВидСравнения=ВидСравнения.ВСписке 
		ИЛИ ВыбранныйВидСравнения=ВидСравнения.ВСпискеПоИерархии Тогда
		СтароеЗначение=ЭлементыФормы[НазваниеЭлементаФормы].Значение;
		ЭлементыФормы[НазваниеЭлементаФормы].ТипЗначения=Новый ОписаниеТипов(""СписокЗначений"");
		ЭлементыФормы[НазваниеЭлементаФормы].ТипЗначенияСписка=Новый ОписаниеТипов(ТипЗначения);
		ЭлементыФормы[НазваниеЭлементаФормы].Значение.Добавить(СтароеЗначение);
	иначе
		Если ТипЗнч(ЭлементыФормы[НазваниеЭлементаФормы].Значение) = Тип(""СписокЗначений"") Тогда
			СтароеЗначение=ЭлементыФормы[НазваниеЭлементаФормы].Значение[0].Значение;
		КонецЕсли;		
		ЭлементыФормы[НазваниеЭлементаФормы].ТипЗначения=Новый ОписаниеТипов(ТипЗначения);
		ЭлементыФормы[НазваниеЭлементаФормы].Значение= СтароеЗначение;
	Конецесли;
конецпроцедуры
УстановитьТипЗначения(ВидСравненияПодразделение,""Подразделение"",""СправочникСсылка.Подразделения"");"}
},
{0,
{"СохранитьВосстановитьЗначения",0,0,"","СохранитьЗначение(""""+ТекПользователь.Ссылка.УникальныйИдентификатор()+""РеестрДокументов.ЭлементыФормы.Склад.Значение"",ЭлементыФормы.Склад.Значение);
ВосстановитьЗначение(""""+ТекПользователь.Ссылка.УникальныйИдентификатор()+""РеестрДокументов.ЭлементыФормы.Склад.Значение"");"}
},
{0,
{"ВнешниеНаборыДанных",0,0,"","ВнешниеНаборыДанных= Новый Структура(""ТЗНоменклатураПланИФакт"",ТЗНоменклатураПланИФакт);"}
},
{0,
{"ВремяНачалаВремяКонца",0,0,"Врем[я]","ВремяНачала = ТекущаяДатаСеансаНаСервере();

ВремяКонца = ТекущаяДатаСеансаНаСервере();

МассивСообщений = Новый Массив();
МассивСообщений.Добавить(""------------------------------------------------------------------"");
МассивСообщений.Добавить(""ВремяНачала -""+ВремяНачала);
МассивСообщений.Добавить(""ВремяКонца  -""+ВремяКонца);
МассивСообщений.Добавить(""Общее время выполнения - ""+ОКР(((ВремяКонца-ВремяНачала)/60),2) +"" мин."");
МассивСообщений.Добавить(""------------------------------------------------------------------"");	

Для каждого ЭлМассива из МассивСообщений цикл
	Сообщение = Новый СообщениеПользователю;
	Сообщение.Текст = """" + ЭлМассива;
	Сообщение.Сообщить();
Конеццикла;

&НаСервереБезКонтекста
Функция ТекущаяДатаСеансаНаСервере()
	Возврат ТекущаяДатаСеанса();
КонецФункции "}
},
{0,
{"УстановитьТипЗначения",0,0,"","Процедура УстановитьТипЗначения()	
	Если НЕ ЗначениеЗаполнено(СсылкаНаОбъект) Тогда
		ТипЗначения="""";
		Если ВидОбъекта = Перечисления.рздВидыОбъектовОбменСОР.Качество Тогда
			ТипЗначения=""СправочникСсылка.Качество"";
		ИначеЕсли ВидОбъекта = Перечисления.рздВидыОбъектовОбменСОР.ГППФ
			ИЛИ ВидОбъекта = Перечисления.рздВидыОбъектовОбменСОР.СторонаАктивации Тогда
			ТипЗначения=""СправочникСсылка.ЗначенияСвойствОбъекта"";
		ИначеЕсли ВидОбъекта = Перечисления.рздВидыОбъектовОбменСОР.Оборудование Тогда
			ТипЗначения=""СправочникСсылка.РабочиеЦентры"";			
		ИначеЕсли ВидОбъекта = Перечисления.рздВидыОбъектовОбменСОР.ДиаметрШпули Тогда
			ТипЗначения=""СправочникСсылка.рздДиаметрыШпули"";						
		ИначеЕсли ВидОбъекта = Перечисления.рздВидыОбъектовОбменСОР.ВидЗаказаНаПроизводство Тогда
			ТипЗначения=""ПеречислениеСсылка.рздВидыЗаказовНаПроизводство"";									
		ИначеЕсли ВидОбъекта = Перечисления.рздВидыОбъектовОбменСОР.ТипРулона Тогда
			ТипЗначения=""ПеречислениеСсылка.рздТипыРулонов"";												
		Конецесли;
		Если ТипЗначения <> """" Тогда
			ТипЗначения=Новый ОписаниеТипов(ТипЗначения);
			ЭлементУправления=ЭлементыФормы.СсылкаНаОбъект;
			ЭлементУправления.ОграничениеТипа = ТипЗначения;
			ЭлементУправления.Значение = ТипЗначения.ПривестиЗначение(ЭлементУправления.Значение);			
		Конецесли;
	Конецесли;
КонецПроцедуры



Процедура УстановитьТипЗначения(ВыбранныйВидСравнения,НазваниеЭлементаФормы,ТипЗначения)
	Если ВыбранныйВидСравнения=ВидСравнения.ВСписке 
		ИЛИ ВыбранныйВидСравнения=ВидСравнения.ВСпискеПоИерархии Тогда
		СтароеЗначение=Неопределено;
		Если ЗначениеЗаполнено(ЭлементыФормы[НазваниеЭлементаФормы].Значение) тогда
			СтароеЗначение=ЭлементыФормы[НазваниеЭлементаФормы].Значение;
		Конецесли;
		ЭлементыФормы[НазваниеЭлементаФормы].ТипЗначения=Новый ОписаниеТипов(""СписокЗначений"");
		ЭлементыФормы[НазваниеЭлементаФормы].ТипЗначенияСписка=Новый ОписаниеТипов(ТипЗначения);
		Если СтароеЗначение<>Неопределено тогда
			ЭлементыФормы[НазваниеЭлементаФормы].Значение.Добавить(СтароеЗначение);
		конецесли;
	иначе
		Если ТипЗнч(ЭлементыФормы[НазваниеЭлементаФормы].Значение) = Тип(""СписокЗначений"") И ЭлементыФормы[НазваниеЭлементаФормы].Значение.Количество()>0 Тогда
			СтароеЗначение=ЭлементыФормы[НазваниеЭлементаФормы].Значение[0].Значение;
		КонецЕсли;		
		ЭлементыФормы[НазваниеЭлементаФормы].ТипЗначения=Новый ОписаниеТипов(ТипЗначения);
		ЭлементыФормы[НазваниеЭлементаФормы].Значение= СтароеЗначение;
	Конецесли;
конецпроцедуры"}
},
{0,
{"ЗапуститьПриложение(explorer)",0,0,"","Процедура ИмяФайлаОткрытие(Элемент, СтандартнаяОбработка)
	ЗапуститьПриложение(""explorer "" + Элемент.Значение);
	СтандартнаяОбработка = ЛОЖЬ;
КонецПроцедуры
"}
},
{0,
{"НайденныеСтроки",0,0,"Найд","ПараметрыОтбора=Новый Структура();
ПараметрыОтбора.Вставить(""Сотрудник"",Сотрудник);
НайденныеСтроки = ДокОбъект.ОсновныеНачисления.НайтиСтроки(ПараметрыОтбора);
ВсегоНайденныеСтроки = НайденныеСтроки.Количество();
ТекстОшибки = """";
Если ВсегоНайденныеСтроки = 1 тогда
	 = НайденныеСтроки[0];	
ИначеЕсли ВсегоНайденныеСтроки > 1 Тогда
	ТекстОшибки = ""Ошибка! Найдено более 1 строки"";
Иначе
	ТекстОшибки = ""Ошибка! Не найдена строка"";
Конецесли;

Если ЗначениеЗаполнено(ТекстОшибки) Тогда
	ТекстОшибки = ТекстОшибки  
		+"" в """"фнмДоходыИРасходыПлан"""" для "";
	Для каждого ЭлементОтбора из ПараметрыОтбора цикл
		ТекстОшибки = ТекстОшибки  
			+"" ""+ ЭлементОтбора.Ключ + "" = [""+ЭлементОтбора.Значение+""]"";	
	Конеццикла;
	ВызватьИсключение ТекстОшибки;	
Конецесли;

"}
},
{0,
{"СтрЗаменить",0,0,"Стр[Заменить]","Запрос.Текст=СтрЗаменить(Запрос.Текст,""//Отбор<?>По"","""");"}
},
{0,
{"ДопПараметры",0,0,"Доп[Параметры]","ДопПараметры = Новый Структура();
ДопПараметры.Вставить(""<?>"",);"}
},
{0,
{"СортировкаВСписке",0,0,"","//В процедуру ПриОткрытии или в конец модуля добавить: 
 ЭлементыФормы.РегистрСведенийСписок.НастройкаПорядка.НомерСоглашения.Доступность=Истина;    

//Где НомерСоглашения - Колонка в списке регистра сведений по которой нужно сортировать! 
//Далее щелкнув правой клавишей мыши на списке и зайдя в пункт Сортировка - увидим что стала доступна возможность сортировки по НомерСоглашения. 

//Как отсортировать список документов по признаку ПРОВЕДЕН? 
//Код 1C v 8.х
 ЭлементыФормы.ДокументыСписок.НастройкаПорядка.Проведен.Доступность = Истина;
Список.Порядок.Установить(""Проведен Убыв, Дата"");    


//Сортировка динамических списков (ЖурналДокументовСписок) 
// Добавлять элементы настройки порядка в динамические списки нельзя. 
//Если индексирование для графы установлено, то соответсвующий элемент настройки порядка уже есть, надо его просто включить: 
  ЖурналДокументовСписок.Порядок.Установить(""Номер Возр"");
// или
ЖурналДокументовСписок.Порядок.Установить(""Месяц Возр"");
// или
ЖурналДокументовСписок.Порядок.Установить(""Организация Возр"");
// или
ЖурналДокументовСписок.Порядок.Установить(""Ссылка"");      

//При открытии, журнал будет упорядочен! 

 ЭлементыФормы.СправочникСписок.НастройкаПорядка.Дата.Доступность=Истина;
ЭлементыФормы.СправочникСписок.НастройкаПорядка.Номер.Доступность=Истина;
СправочникСписок.Порядок.Установить(""Дата Возр, Номер"");"}
},
{0,
{"НС",0,0,"НС","ВсегоСтрок = Выборка.Количество();
НС = 1;
НС = НС+1;
Состояние(""Обработано НС ""+НС + "" из ""+ВсегоСтрок);"}
},
{0,
{"рздПолучитьНомерБезНулейИПрефикса",0,0,"","Функция рздПолучитьНомерБезНулейИПрефикса(НомерДок) Экспорт
	НомерДок=СокрЛП(НомерДок);
	НомерСимвола=1;
	ДлинаСтроки=СтрДлина(НомерДок);
	Префикс="""";
	Пока НомерСимвола <= ДлинаСтроки цикл
		ОбрабатываемыйСимвол=Сред(НомерДок,НомерСимвола,1);
		Попытка 
			ЧислоСимвола=Число(ОбрабатываемыйСимвол);
			Прервать;
		Исключение
		Конецпопытки;
		Префикс=Префикс+ОбрабатываемыйСимвол;
		НомерСимвола=НомерСимвола+1;
	Конеццикла;
	НомерДок=СтрЗаменить(НомерДок,Префикс,"""");
	//НомерДок=СтрЗаменить(НомерДок,""0"","""");
	НомерДок=СтрЗаменить(НомерДок,""-"","""");
	НомерДок=Число(НомерДок);
	Возврат НомерДок;
Конецфункции
"}
},
{0,
{"ПересчетИзВалютыВВалюту",0,0,"","ВалютаСтарая=ВалютаДокумента;
ВалютаНовая=мВалютаРегламентированногоУчета;
СтруктураКурсСтарая = МодульВалютногоУчета.ПолучитьКурсВалюты(ВалютаСтарая, Дата);
КратностьСтарая=СтруктураКурсСтарая.Кратность;
КурсСтарая=СтруктураКурсСтарая.Курс;

СтруктураКурсВалютаНовая = МодульВалютногоУчета.ПолучитьКурсВалюты(ВалютаНовая, Дата);
КратностьНовая=СтруктураКурсВалютаНовая.Кратность;
КурсНовая=СтруктураКурсВалютаНовая.Курс;
СуммаУпрУчета=МодульВалютногоУчета.ПересчитатьИзВалютыВВалюту(НоваяЗапись.СуммаСНДС, ВалютаСтарая, ВалютаНовая, КурсСтарая, КурсНовая, 
   	КратностьСтарая, КратностьНовая);


СтруктураКурсВалютаЗаказа = МодульВалютногоУчета.ПолучитьКурсВалюты(ВалютаЗаказа, Дата);
	КратностьВзаиморасчетовВалютаЗаказа=СтруктураКурсВалютаЗаказа.Кратность;
	КурсВзаиморасчетовВалютаЗаказа=СтруктураКурсВалютаЗаказа.Курс;
	
	СтруктураКурсВалютаИзДоговора = МодульВалютногоУчета.ПолучитьКурсВалюты(ВалютаИзДоговора, Дата);
	КратностьВзаиморасчетовВалютаИзДоговора=СтруктураКурсВалютаИзДоговора.Кратность;
	КурсВзаиморасчетовВалютаИзДоговора=СтруктураКурсВалютаИзДоговора.Курс;
	Цена=МодульВалютногоУчета.ПересчитатьИзВалютыВВалюту(Цена, ВалютаЗаказа, ВалютаИзДоговора, КурсВзаиморасчетовВалютаЗаказа, КурсВзаиморасчетовВалютаИзДоговора, 
   		КратностьВзаиморасчетовВалютаЗаказа, КратностьВзаиморасчетовВалютаИзДоговора);

(Сумма*КурсНач*КратностьКон)/(КурсКон*КратностьНач)

Функция рздПолучитьТЗВРеглВалюте(Ссылка) Экспорт
	Запрос = Новый Запрос(""
	|ВЫБРАТЬ
	|	ТЗТовары.НомерСтроки,
	|	ТЗТовары.Номенклатура,
	|	ТЗТовары.Цена,
	|	ТЗТовары.Сумма
	|ПОМЕСТИТЬ ТЗТовары
	|ИЗ
	|	&Товары КАК ТЗТовары
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	КурсыВалютСрезПоследних.Валюта,
	|	КурсыВалютСрезПоследних.Курс,
	|	КурсыВалютСрезПоследних.Кратность
	|ПОМЕСТИТЬ ВТКурсыВалют
	|ИЗ
	|	РегистрСведений.КурсыВалют.СрезПоследних(
	|			,
	|			Валюта = &ВалютаДокумента
	|				ИЛИ Валюта = &ВалютаРегламентированногоУчета) КАК КурсыВалютСрезПоследних
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	ТЗТовары.НомерСтроки,
	|	ТЗТовары.Номенклатура,
	|	ТЗТовары.Цена,
	|	ТЗТовары.Сумма,
	|	ВЫРАЗИТЬ(ТЗТовары.Цена * ВТКурсыВалютДокумента.Курс * ВТКурсыВалютРеглУчет.Кратность / (ВТКурсыВалютРеглУчет.Курс * ВТКурсыВалютДокумента.Кратность) КАК ЧИСЛО(15, 2)) КАК ЦенаРеглУчет,
	|	ВЫРАЗИТЬ(ТЗТовары.Сумма * ВТКурсыВалютДокумента.Курс * ВТКурсыВалютРеглУчет.Кратность / (ВТКурсыВалютРеглУчет.Курс * ВТКурсыВалютДокумента.Кратность) КАК ЧИСЛО(15, 2)) КАК СуммаРеглУчет,
	|	ВТКурсыВалютРеглУчет.Валюта КАК ВалютаРеглУчет,
	|	ВТКурсыВалютРеглУчет.Курс КАК КурсРеглУчет,
	|	ВТКурсыВалютРеглУчет.Кратность КАК КратностьРеглУчет,
	|	ВТКурсыВалютДокумента.Валюта КАК ВалютаДокумета,
	|	ВТКурсыВалютДокумента.Курс КАК КурсДокумета,
	|	ВТКурсыВалютДокумента.Кратность КАК КратностьДокумета
	|ИЗ
	|	ТЗТовары КАК ТЗТовары,
	|	(ВЫБРАТЬ
	|		ВТКурсыВалют.Валюта КАК Валюта,
	|		ВТКурсыВалют.Курс КАК Курс,
	|		ВТКурсыВалют.Кратность КАК Кратность
	|	ИЗ
	|		ВТКурсыВалют КАК ВТКурсыВалют
	|	ГДЕ
	|		ВТКурсыВалют.Валюта = &ВалютаДокумента) КАК ВТКурсыВалютДокумента,
	|	(ВЫБРАТЬ
	|		ВТКурсыВалют.Валюта КАК Валюта,
	|		ВТКурсыВалют.Курс КАК Курс,
	|		ВТКурсыВалют.Кратность КАК Кратность
	|	ИЗ
	|		ВТКурсыВалют КАК ВТКурсыВалют
	|	ГДЕ
	|		ВТКурсыВалют.Валюта = &ВалютаРегламентированногоУчета) КАК ВТКурсыВалютРеглУчет
	|"");

	Запрос.УстановитьПараметр(""ВалютаДокумента"", Ссылка.ВалютаДокумента);
	Запрос.УстановитьПараметр(""ВалютаРегламентированногоУчета"", Константы.ВалютаРегламентированногоУчета.Получить());
	Запрос.УстановитьПараметр(""Товары"", Ссылка.Товары.Выгрузить());

	Возврат Запрос.Выполнить().Выгрузить();
Конецфункции
"}
},
{0,
{"СуммаПрописью",0,0,"","ФормСтрока = ""Л = ru_RU; ДП = Истина"";
ПарПредмета=""рубль, рубля, рублей, м, копейка, копейки, копеек, ж, 2"";

ОбластьМакета.Параметры.СуммаПрописью=ЧислоПрописью(2341.56, ФормСтрока, ПарПредмета);
"}
},
{0,
{"НастройкиПользователя",0,0,"","УправлениеПользователями.ПолучитьЗначениеПоУмолчанию(глЗначениеПеременной(""глТекущийПользователь""), ""рздКонтрагентПартнерПоУмолчанию"");
//задаются в ПВХ: Настройки пользователя"}
},
{0,
{"фнмЗначениеНастройки",0,0,"фнмЗ[начениеНастройки]","Перем м<?""ИмяЭлемента""> Экспорт;

м<?""ИмяЭлемента""> = Справочники.фнмКонстанты.<?""ИмяЭлемента"">.ЗначениеКонстанты;
Если м<?""ИмяЭлемента""> = Неопределено 
	ИЛИ ТипЗнч(м<?""ИмяЭлемента"">) <> Тип(""СправочникСсылка.КлассификаторСтранМира"")
	ИЛИ НЕ ЗначениеЗаполнено(м<?""ИмяЭлемента"">) Тогда
	Сообщить(""Ошибка! Не указано значение элемента """"<?""ИмяЭлемента"">"""", в константах (ФНМ)"");
Конецесли;
"}
},
{0,
{"Excel чтение через COM (Excel.Application)",0,0,"","//Чтение Excel через таб документ и построитель
//Вывод в табличный документ
ТабличныйДокумент = Новый ТабличныйДокумент;
ТабличныйДокумент.Прочитать(Файл, СпособЧтенияЗначенийТабличногоДокумента.Значение);

//вывод в таблицу значений

ПЗ = Новый ПостроительЗапроса;
ПЗ.ИсточникДанных = Новый ОписаниеИсточникаДанных(ТабличныйДокумент.Область());
ПЗ.ДобавлениеПредставлений = ТипДобавленияПредставлений.НеДобавлять;
ПЗ.ЗаполнитьНастройки();
ПЗ.Выполнить();
ТаблицаЗначений = ПЗ.Результат.Выгрузить();
//Конец Чтение Excel через таб документ и построитель

//(Антон 
Функция рздПолучитьТЗФизЛицаИЗФайлаExcel(ПутьКФайлу)
	

	НомерЛиста=1;
	НомерСтрокиЭксель=1;
	
	Excel = Новый COMОбъект(""Excel.Application"");
	Excel.Workbooks.Open(ИмяФайла); 
	
	Попытка
		Excel.WorkSheets(НомерЛиста).select();
	Исключение
		ОбщегоНазначения.Сообщение(""В книге Excel отсутствует лист ""+НомерЛиста+""."");
		Excel.ActiveWorkbook.Close();  
		Excel = """";
		Возврат Неопределено;
	КонецПопытки;
	
	//Получим количество строк и колонок.
	//В разных версиях Excel получаются по-разному, поэтому сначала определим версию Excel
	Версия = Лев(Excel.Version,Найти(Excel.Version,""."")-1);
	
	Если Версия = ""8"" тогда
		ФайлСтрок   = Excel.Cells.CurrentRegion.Rows.Count;
		ФайлКолонок = Макс(Excel.Cells.CurrentRegion.Columns.Count, 13);
	Иначе
		ФайлСтрок   = Excel.Cells(1,1).SpecialCells(11).Row;
		ФайлКолонок = Excel.Cells(1,1).SpecialCells(11).Column;   
	КонецЕсли;
	
	
	ТЗФизЛица=Новый ТаблицаЗначений();
	ТЗФизЛица.Колонки.Добавить(""НомерПП"");
	ТЗФизЛица.Колонки.Добавить(""ФИО"");
	Для Ряд = НомерСтрокиЭксель по ФайлСтрок Цикл 
		//Сумма = Excel.Cells(а,3).Value;
		НомерПП = СокрЛП(Excel.Cells(Ряд,1).Text);
		ФИО= СокрЛП(Excel.Cells(Ряд,2).Text);
		СтрокаТЗФизЛица=ТЗФизЛица.Добавить();
		СтрокаТЗФизЛица.НомерПП=НомерПП;
		СтрокаТЗФизЛица.ФИО=ФИО;
		Состояние(""Прочитано строк ""+Ряд + "" из ""+ФайлСтрок);
	КонецЦикла;
	
	//Закрываем Excel
	Excel.ActiveWorkbook.Save();
	Excel.ActiveWorkbook.Close();
	Excel.Quit();	
	
	//Excel.DisplayAlerts = 0;
	//Excel.Workbooks.Close();
	//Excel.DisplayAlerts = 1;
	
	//Excel.ActiveWorkbook.Close();  
	//Excel = """";
	//
	//Открыть файл
	//Книга = Excel.WorkBooks.Open(ИмяВремФайла);
	//Лист = Книга.WorkSheets(1);
	//
	//Книга.Activate();
	//Лист.Activate(); 
	//Эксель.Visible = 1;
	
	
	Возврат ТЗФизЛица;
	
КонецФункции

ТабДокумент = Новый ТабличныйДокумент; 
ТабДокумент.Записать(""Лопух.xls"", ТипФайлаТабличногоДокумента.XLS);



///Работа с кешем
Перем мТЗСправочникиКэш Экспорт;
Процедура СоздатьСтруктурумТЗСправочникиКэш() Экспорт
	мТЗСправочникиКэш = Новый ТаблицаЗначений();
	мТЗСправочникиКэш.Колонки.Добавить(""МетаданныеИмя"");
	мТЗСправочникиКэш.Колонки.Добавить(""Артикул"");
	мТЗСправочникиКэш.Колонки.Добавить(""Наименование"");
	мТЗСправочникиКэш.Колонки.Добавить(""ЭтоГруппа"");
	мТЗСправочникиКэш.Колонки.Добавить(""Ссылка"");
	мТЗСправочникиКэш.Индексы.Добавить(""МетаданныеИмя"");
КонецПроцедуры //Получить

Функция ПолучитьЗначениеИзКэша(МетаданныеИмя,ПараметрыПоиска) Экспорт
	РезультатФункции = Новый Структура();
	пЗначениеИзКэша = Неопределено;
	ЭтоЗначениеИзКэша = Ложь;	
	ПараметрыОтбора=Новый Структура();
	ПараметрыОтбора.Вставить(""МетаданныеИмя"",МетаданныеИмя);
	ПараметрыПойскаСтрока = """";
	Для каждого СтрокаПараметрыПоиска из ПараметрыПоиска цикл
		ПараметрыОтбора.Вставить(СтрокаПараметрыПоиска.Ключ,СтрокаПараметрыПоиска.Значение);
		ПараметрыПойскаСтрока = ПараметрыПойскаСтрока + """" +СтрокаПараметрыПоиска.Ключ + "" [""+СтрокаПараметрыПоиска.Значение+""]"";
	Конеццикла;
	НайденныеСтроки = мТЗСправочникиКэш.НайтиСтроки(ПараметрыОтбора);
	Если НайденныеСтроки.Количество()=1 тогда
		пЗначениеИзКэша = НайденныеСтроки[0].Ссылка;
		ЭтоЗначениеИзКэша = Истина;
	ИначеЕсли НайденныеСтроки.Количество()>1 Тогда
		Сообщить(""Ошибка! Найдено более 1 значения в кэше МетаданныеИмя [""+МетаданныеИмя+""] по указанным параметрам поиска""
			+"" ""+ПараметрыПойскаСтрока);
	Иначе
		//Сообщить(""Не найден "");		
	Конецесли;
	РезультатФункции.Вставить(""ЭтоЗначениеИзКэша"",ЭтоЗначениеИзКэша);
	РезультатФункции.Вставить(""ЗначениеИзКэша"",пЗначениеИзКэша);
	Возврат РезультатФункции;	
КонецФункции //ПолучитьЗначениеИзКэша(ДопПараметры)

Процедура ДобавитьЗначениеВКэш(СсылкаНаОбъект,МетаданныеИмя,ПараметрыПоиска) Экспорт
	СтрокамТЗСправочникиКэш = мТЗСправочникиКэш.Добавить();
	ЗаполнитьЗначенияСвойств(СтрокамТЗСправочникиКэш,ПараметрыПоиска);
	СтрокамТЗСправочникиКэш.Ссылка = СсылкаНаОбъект;
	СтрокамТЗСправочникиКэш.МетаданныеИмя = МетаданныеИмя;
КонецПроцедуры //ДобавитьЗначениеВКэш(Справочники.Модели.ПустаяСсылка(),""Модели"",ПараметрыПоиска)

Функция ПолучитьМодель(МодельФайл) Экспорт 
	пМодель = Неопределено;
	МетаданныеИмя = ""Модели"";

	ПараметрыПоиска = Новый Структура();
	ПараметрыПоиска.Вставить(""Наименование"",МодельФайл);
	РезультатФункции = ПолучитьЗначениеИзКэша(МетаданныеИмя,ПараметрыПоиска);	
	Если РезультатФункции.ЭтоЗначениеИзКэша Тогда
		пМодель = РезультатФункции.ЗначениеИзКэша;
		Возврат пМодель;
	Конецесли;
	Запрос = Новый Запрос;
	Запрос.Текст = 
		""ВЫБРАТЬ
		|	Модели.Ссылка,
		|	Модели.Наименование
		|ИЗ
		|	Справочник.Модели КАК Модели
		|ГДЕ
		|	НЕ Модели.ЭтоГруппа
		|	И Модели.Наименование = &Наименование"";

	Запрос.УстановитьПараметр(""Наименование"", МодельФайл);

	РезультатЗапроса = Запрос.Выполнить();

	Выборка = РезультатЗапроса.Выбрать();
	Если Выборка.Количество() = 0 Тогда
		ДобавитьЗначениеВКэш(Справочники.Модели.ПустаяСсылка(),МетаданныеИмя,ПараметрыПоиска);
		Сообщить(""ВНИМАНИЕ! Не найдена модель [""+МодельФайл+""]"");
	Иначе
		Пока Выборка.Следующий() Цикл
			пМодель = Выборка.Ссылка;
			ДобавитьЗначениеВКэш(пМодель,МетаданныеИмя,ПараметрыПоиска);
		КонецЦикла;
	Конецесли;
	Возврат пМодель;
КонецФункции //ПолучитьМодель(МодельФайл)
"}
},
{0,
{"Excel чтение через СOM (ADODB)",0,0,"","//https://infostart.ru/public/449681/

ADODBConnection = Новый COMОбъект(""ADODB.Connection"");
ADODBConnection.Provider = ""Microsoft.ACE.OLEDB.12.0"";
ADODBConnection.Properties(""Data Source"").Value = СокрЛП(ЭтотОбъект.ПутьКФайлу);
ADODBConnection.Properties(""Extended Properties"").Value = ""Excel 12.0;HDR=Yes;IMEX=1"";
ADODBConnection.Open();

//  Получить список имен листов:
//    ADODBRecordset = Новый COMОбъект(""ADODB.Recordset"");
//    ADODBRecordset = ADODBConnection.OpenSchema(20);
//    СписокЛистов = Новый СписокЗначений;
//    Пока НЕ ADODBRecordset.EOF Цикл        
//        ИмяЛиста = ADODBRecordset.Fields(""TABLE_NAME"").Value;
//        Если Найти(ИмяЛиста, ""_xlnm#_FilterDatabase"") = 0 Тогда
//            СписокЛистов.Добавить(ИмяЛиста); 
//        КонецЕсли;                 
//        ADODBRecordset.MoveNext();
//    КонецЦикла;
//    ADODBRecordset.Close();

//    СписокЛистов.СортироватьПоЗначению(НаправлениеСортировки.Убыв);
//    ИмяЛиста = СписокЛистов[0].Значение;

ТекстЗапроса = ""SELECT * FROM ["" + ЭтотОбъект.ИмяЛиста + ""$]"";

ADODBRecordset = Новый COMОбъект(""ADODB.Recordset"");
ADODBRecordset.Open(ТекстЗапроса, ADODBConnection);

КолвоКолонокExcel = ADODBRecordset.Fields.Count;

СчетчикСтрок = 1;    
Пока ADODBRecordset.EOF() = 0 Цикл
	
    Для СчетчикКолонок = 1 ПО КолвоКолонокExcel Цикл
        
        Поле = ADODBRecordset.Fields.Item(СчетчикКолонок - 1);
            
        Если Поле.ActualSize = 0 Тогда// Пустое поле EXCEL.
            Продолжить;
        КонецЕсли;
            
        ЗначениеЯчейки = Поле.Value; 
// Обработка значения ячейки 

    КонецЦикла;
    
    ADODBRecordset.MoveNext();   // Следующая строка.
    СчетчикСтрок = СчетчикСтрок + 1;
    
КонецЦикла;

ADODBConnection.Close();

ADODBRecordset = Неопределено;
ADODBConnection = Неопределено;   "}
},
{0,
{"Excel программное создание",0,0,"","//РаботаСЯчейками http://odinesnik.su/osnovnye_metody_raboty_s_excel_iz_1s/

Ячейка = ExcelЛистШапка.Cells(Ряд,Колонка);	

Ячейка.Value = Значение;
Ячейка.Font.Bold = 1;
Ячейка.Borders.LineStyle = 1;
Ячейка.WrapText = Истина;
Ячейка.VerticalAlignment = 2; // Выровнять текст по центру (относительно верхнего края и нижнего).
Ячейка.HorizontalAlignment = 3; // Выровнять текст по середине (относительно левой границы ячейки и правой).
Ячейка.Interior.Color = 12632256; // Серый цвет.
Ячейка.Locked = 0; // указываем что ячейка разблокирована (0), все остальные автоматически будут заблокированы.

//ExcelЛист.Protect(""25Budget10Lock2018"");  //чтобы защита сработала, ставим пароль на лист эксель
ExcelЛист.Protect(ПарольДляExcel, 0, -1, -1, -1, 0, 0, 0, 0, 0, 0, 0, 0, 0, -1, 0);

//При чтении надо снимать пароль
ПарольДляExcel = фнмОбщийМодуль.Бюджет23_ПолучитьПарольДляExcel();
ExcelЛист.Unprotect(ПарольДляExcel);

//АвтоФильтр
ExcelЛистШапка = ExcelЛист.Rows(1);
Ячейки = ExcelЛистШапка.Cells;
Диапазон = Ячейки.Range(""A6:V6"");
Диапазон.AutoFilter();	


Процедура СоздатьШаблонExcelНаКлиенте()
	
	пИмяФайла = ""test.xlsx"";
	пПутьКФайлу = Объект.ПапкаДляВыгрузки + ""\"" + пИмяФайла;
	
	//ТабДокумент = Новый ТабличныйДокумент;
	//ТабДокумент.Записать(пПутьКФайлу, ТипФайлаТабличногоДокумента.XLSX);	
	
	Excel = Новый COMОбъект(""Excel.Application"");	
	//Excel.WorkBooks.Open(пПутьКФайлу);
	
	ExcelКнига = Excel.WorkBooks.Add();
	
	ExcelЛист = ExcelКнига.WorkSheets(1);
	ExcelЛист.Name = ""Budget"";
	//ExcelЛист.
	
	ExcelЛистШапка = ExcelЛист.Rows(1);
	ExcelЛистШапка.Cells(1,1).Value = ""Модель"";
	ExcelЛистШапка.Columns(1).ColumnWidth = 20;
	
	//Автомобили.Cells(ТекущаяСтрокаАвтомобили,4).FormulaR1C1 = ""=CONCATENATE(RC[-3],""""@"""",RC[-1])"";
	Excel.ActiveWorkbook.SaveAs(пПутьКФайлу);
	//Excel.ActiveWorkbook.Save();
	Excel.ActiveWorkbook.Close();
	Excel.Quit();
	
	//Excel.visible=1;
	
	Сообщение = Новый СообщениеПользователю;
	Сообщение.Текст = ""Создан ""+ пИмяФайла;
	Сообщение.Сообщить();
	
КонецПроцедуры "}
},
{0,
{"Excel Запись одной книги Excel на нескольких листах средствами 1С ПакетОтображаемыхДокументов",0,0,"","//https://infostart.ru/public/979007/

ОднаКнига = Новый ПакетОтображаемыхДокументов;
//Создав объект ""ОднаКнига"", мы можем в его состав поместить несколько табличных документов каким-то таким образом:

Элт = ОднаКнига.Состав.Добавить();
Элт.Данные = ПоместитьВоВременноеХранилище(ТабличныйДокумент);
//А сохранить в одну книгу все это хозяйство можно так:

ОднаКнига.Записать(ИмяФайла, ТипФайлаПакетаОтображаемыхДокументов.XLSX);"}
},
{0,
{"//#В",0,0,"В","//#В"}
},
{0,
{"ДляК",0,0,"ДляК","Для Каждого Строка<?""ИмяЭлемента""> Из <?""ИмяЭлемента""> Цикл
	<?>	
КонецЦикла;"}
},
{0,
{"Строк",0,0,"Строк","Строка<?""ИмяЭлемента""> = <?""ИмяЭлемента"">.Добавить();
ЗаполнитьЗначенияСвойств(Строка<?""ИмяЭлемента"">, <?>);
"}
},
{0,
{"СостояниеДокумента",0,0,"","Процедура ТЗСозданныеДокументыПриВыводеСтроки(Элемент, ОформлениеСтроки, ДанныеСтроки)
	СозданныйДокумент=ОформлениеСтроки.ДанныеСтроки.СозданныйДокумент;
	Если ЗначениеЗаполнено(СозданныйДокумент) Тогда
		Ячейка = ОформлениеСтроки.Ячейки.СозданныйДокумент;
		Ячейка.ОтображатьТекст    = Истина;
		Ячейка.ОтображатьФлажок   = Ложь;
		Ячейка.ОтображатьКартинку = Истина;		
		Если СозданныйДокумент.Проведен Тогда
			Ячейка.ИндексКартинки=0;
		ИначеЕсли СозданныйДокумент.ПометкаУдаления Тогда
			Ячейка.ИндексКартинки=1;
		ИначеЕсли НЕ СозданныйДокумент.Проведен Тогда
			Ячейка.ИндексКартинки=2;			
		КонецЕсли;
	Конецесли;
КонецПроцедуры"}
},
{0,
{"ВалидацияXML",0,0,"","Функция ВалидацияФайла(ИмяФайла, ИмяСхемы) Экспорт
	Отказ=Ложь;
	ИмяФайлаСхемы=ПолучитьИмяВременногоФайла("".xsd"");
	ВременныйФайл=ПолучитьМакет(ИмяСхемы);
	ВременныйФайл.Записать(ИмяФайлаСхемы);
	XMLDoc = New COMObject(""Msxml2.DOMDocument.6.0"");
	XMLDoc.Async = false;
	XMLDoc.ValidateOnParse = true;
	SchemaCache = New COMObject(""Msxml2.XMLSchemaCache.6.0"");
	SchemaCache.Add(""http://www.biaxplen.ru/ERP-SLOS"",ИмяФайлаСхемы);
	XMLDoc.Schemas = SchemaCache;
	XMLDoc.SetProperty(""MultipleErrorMessages"", true);
	XMLDoc.Load(ИмяФайла);
	ErrObj = XMLDoc.ParseError;
	If ErrObj.ErrorCode <> 0 Then
		For Each ErrItem In ErrObj.AllErrors Do 
			Message(""Error: "" + ErrItem.Reason + "" "" + ErrItem.SrcText);
		EndDo;
		Отказ=Истина;
	EndIf;	
    УдалитьФайлы(ИмяФайлаСхемы);
	Возврат Отказ;
Конецфункции
"}
},
{0,
{"ПроверитьОшибки",0,0,"","Процедура ПроверитьОшибки(ТолькоСПометкой=Ложь) Экспорт
	Для каждого СтрокаДанныеИзФайла из ДанныеИзФайла цикл
		Если ТолькоСПометкой Тогда
			Если НЕ СтрокаДанныеИзФайла.Пометка Тогда
				Продолжить;
			Конецесли;
		Конецесли;
		СтрокаДанныеИзФайла.флЕстьОшибки=Ложь;
		Если НЕ ЗначениеЗаполнено(СтрокаДанныеИзФайла.Контрагент) Тогда
			СтрокаДанныеИзФайла.флЕстьОшибки=Истина;
			Сообщить(""Ошибка! Не заполнен контрагент в строке ""+СтрокаДанныеИзФайла.НомерСтроки);
		Конецесли;
		Если НЕ ЗначениеЗаполнено(СтрокаДанныеИзФайла.Номенклатура) Тогда
			СтрокаДанныеИзФайла.флЕстьОшибки=Истина;
			Сообщить(""Ошибка! Не заполнена Номенклатура в строке ""+СтрокаДанныеИзФайла.НомерСтроки);
		Конецесли;		
		Если НЕ ЗначениеЗаполнено(СтрокаДанныеИзФайла.ХарактеристикаНоменклатуры) Тогда
			СтрокаДанныеИзФайла.флЕстьОшибки=Истина;
			Сообщить(""Ошибка! Не заполнена ХарактеристикаНоменклатуры в строке ""+СтрокаДанныеИзФайла.НомерСтроки);
		Конецесли;		
		Если СтрокаДанныеИзФайла.Пометка Тогда
			СтрокаДанныеИзФайла.Пометка=НЕ СтрокаДанныеИзФайла.флЕстьОшибки;
		Конецесли;
	Конеццикла;
КонецПроцедуры
Процедура ДанныеПриПолученииДанных(Элемент, ОформленияСтрок)
	Для каждого ЭлемОформления из ОформленияСтрок цикл
		ЭлемОформления.ЦветФона=Новый Цвет();
		флЕстьОшибки=ЭлемОформления.ДанныеСтроки.флЕстьОшибки;
		Если флЕстьОшибки Тогда
			ЭлемОформления.ЦветФона=Новый Цвет(255,228,225);
		Конецесли;
	конеццикла;
КонецПроцедуры
"}
},
{0,
{"ПолучитьЦелоеЧисло",0,0,"","Функция ПолучитьЦелоеЧисло(ЗНАЧ ОбрабатываемоеЧисло,Разряд,ВидОкругления=Неопределено)
	Коэффициент=1;
	Если ОбрабатываемоеЧисло<0 Тогда 
		Коэффициент=-1;
	Конецесли;
	Если ВидОкругления =""вверх"" Тогда
		ОбрабатываемоеЧисло=ОбрабатываемоеЧисло+Коэффициент*Разряд;	
	Конецесли;
	ОбрабатываемоеЧисло = Строка(ОбрабатываемоеЧисло/Разряд);
	ПозЗапятой=Найти(ОбрабатываемоеЧисло,"","");
	Если ПозЗапятой>0 Тогда
		ОбрабатываемоеЧисло=Число(Лев(ОбрабатываемоеЧисло,ПозЗапятой-1));	
	Иначе
		ОбрабатываемоеЧисло=0;	
	Конецесли;	
	Возврат ОбрабатываемоеЧисло*Разряд;
КОнецфункции
"}
},
{0,
{"ХранилищеЗначений",0,0,"","	ИмяФайлаСхемы=ПолучитьИмяВременногоФайла("".xsd"");
	ВременныйФайл=ПолучитьМакет(ИмяСхемы);
	ВременныйФайл.Записать(ИмяФайлаСхемы);

	
//Чтение и сохранение ТабДокумента в хранище значений
Процедура ОсновныеДействияФормыПрочитать(Кнопка)
	//{{КОНСТРУКТОР_ЗАПРОСА_С_ОБРАБОТКОЙ_РЕЗУЛЬТАТА
	// Данный фрагмент построен конструктором.
	// При повторном использовании конструктора, внесенные вручную изменения будут утеряны!!!

	Запрос = Новый Запрос;
	Запрос.Текст = 
		""ВЫБРАТЬ
		|	КартинкиИФайлы.Объект,
		|	КартинкиИФайлы.Идентификатор,
		|	КартинкиИФайлы.ИмяФайла,
		|	КартинкиИФайлы.ДатаСохранения,
		|	КартинкиИФайлы.РазмерФайла,
		|	КартинкиИФайлы.Комментарий,
		|	КартинкиИФайлы.Данные,
		|	КартинкиИФайлы.ДанныеВоВнешнемФайле,
		|	КартинкиИФайлы.Картинка,
		|	КартинкиИФайлы.НомерКартинки
		|ИЗ
		|	РегистрСведений.КартинкиИФайлы КАК КартинкиИФайлы
		|ГДЕ
		|	КартинкиИФайлы.Объект = &Объект
		|	И КартинкиИФайлы.Идентификатор = &Идентификатор"";

	Запрос.УстановитьПараметр(""Идентификатор"", Идентификатор);
	Запрос.УстановитьПараметр(""Объект"", Объект);

	РезультатЗапроса = Запрос.Выполнить();

	Выборка = РезультатЗапроса.Выбрать();

	Пока Выборка.Следующий() Цикл
		ДвоичныеДанные = Выборка.Данные.Получить();
		Если ДвоичныеДанные <> Неопределено Тогда
			
			ИмяФайла = ПолучитьИмяВременногоФайла(""mxl"");
			Попытка
				ДвоичныеДанные.Записать(ИмяФайла);
				
				ТабДокумент = Новый ТабличныйДокумент;
				ТабДокумент.Прочитать(ИмяФайла);
				УдалитьФайлы(ИмяФайла);
			Исключение
				ОбщегоНазначения.СообщитьОбОшибке(ОписаниеОшибки(),, ""Не удалось сформировать внешний табличный документ!"");
			КонецПопытки;
		КонецЕсли; 		
		ОбластьМакета = ТабДокумент.ПолучитьОбласть(""Данные"");
		ЭлементыФормы.ПолеТабличногоДокумента.Вывести(ОбластьМакета);
		//ЭлементыФормы.ПолеТабличногоДокумента.от
	КонецЦикла;

	//}}КОНСТРУКТОР_ЗАПРОСА_С_ОБРАБОТКОЙ_РЕЗУЛЬТАТА
	
КонецПроцедуры

Процедура ОсновныеДействияФормыСохранить(Кнопка)
	//Новый ХранилищеЗначения(ПечатныйДокумент, Новый СжатиеДанных(9));
	ИмяФайла = ПолучитьИмяВременногоФайла(""mxl"");
	ЭлементыФормы.ПолеТабличногоДокумента.Записать(ИмяФайла);
	Данные = Новый ХранилищеЗначения(Новый ДвоичныеДанные(ИмяФайла), Новый СжатиеДанных(9));
	
	ПараметрыОтбора = Новый Структура();
	ПараметрыОтбора.Вставить(""Объект"",Объект);
	//ПараметрыОтбора.Вставить(""Идентификатор"",Идентификатор);

	Выборка = РегистрыСведений.КартинкиИФайлы.Выбрать(ПараметрыОтбора);
	Пока Выборка.Следующий() Цикл
		Запись = Выборка.ПолучитьМенеджерЗаписи();
		Запись.Прочитать();
		Запись.Данные = Данные;
		Запись.Записать();
	Конеццикла;
	
КонецПроцедуры
"}
},
{0,
{"ПостроительОтчета",0,0,"","УстановитьПометкуДляТЧ(РулоныНаУпаковку,ЭлементыФормы.РулоныНаУпаковку.ОтборСтрок,Ложь,""Упаковать"");

//+ Доп ТП 16 Раздолье Иванов А.Б. 2013-08-15
Процедура УстановитьПометкуДляТЧ(ТЧ,ОтборСтрок,ЗначениеПометки,ИмяРеквизита=""Пометка"")
	ТЗ =ПолучитьТЗСОтборовВТЧ(ТЧ,ОтборСтрок);
	Для каждого СтрокаТЗ из ТЗ цикл
		ТЧ[СтрокаТЗ.НомерСтроки-1][ИмяРеквизита]=ЗначениеПометки;
	Конеццикла;
КонецПроцедуры
//- Доп ТП 16 Раздолье Иванов А.Б. 2013-08-15

//+ Доп ТП 16 Раздолье Иванов А.Б. 2013-08-15
Функция ПолучитьТЗСОтборовВТЧ(ТЧ,ОтборСтрок) 
	Построитель = Новый ПостроительОтчета;
	Построитель.ИсточникДанных = Новый ОписаниеИсточникаДанных(ТЧ);
	Для каждого ЭлементОтбора Из ОтборСтрок Цикл
	    Если ЭлементОтбора.Использование Тогда
	        НовыйЭлемент = Построитель.Отбор.Добавить(ЭлементОтбора.ПутьКДанным, ЭлементОтбора.Имя, ЭлементОтбора.Представление);
	        НовыйЭлемент.ВидСравнения = ЭлементОтбора.ВидСравнения;
	        НовыйЭлемент.Значение = ЭлементОтбора.Значение;
	        НовыйЭлемент.ЗначениеС = ЭлементОтбора.ЗначениеС;
	        НовыйЭлемент.ЗначениеПо = ЭлементОтбора.ЗначениеПо;
	        НовыйЭлемент.Использование = Истина;
	    КонецЕсли;
	КонецЦикла; 
	РезультатЗапроса = Построитель.Результат;
	Возврат РезультатЗапроса.Выгрузить();
Конецфункции
"}
},
{0,
{"Процедура",0,0,"Про[цедура]","Процедура <?""ИмяЭлемента"">
	ВызватьИсключение ""Ошибка! Нет алгоритма <?""ИмяЭлемента"">"";
	<?>
КонецПроцедуры "}
},
{0,
{"Процедура сервер",0,0,"Прос[ервер]","&НаСервере
Процедура <?""ИмяЭлемента"">
	<?>
КонецПроцедуры "}
},
{0,
{"Функция",0,0,"Фу[нкция]","Функция <?""ИмяЭлемента""> 
	<?>
КонецФункции "}
},
{0,
{"Блок",0,0,"Бл[ок]","//Блок <?""ИмяЭлемента"">
<?>
//Конец блока <?""ИмяЭлемента"">"}
},
{0,
{"ФорматДата",0,0,"ФД","Формат(<?""ИмяЭлемента"">,""ДФ=dd.MM.yyyy"")"}
},
{0,
{"Процедура клиент",0,0,"Прок","&НаКлиенте
Процедура <?""ИмяЭлемента"">
	<?>
КонецПроцедуры "}
},
{0,
{"Транслит",0,0,"","Функция фмТранслитРусАнгл(Стр)
    Рез = СокрЛП(Стр);   
    Рез = СтрЗаменить(Рез,""а"",""a"");
    Рез = СтрЗаменить(Рез,""б"",""b"");
    Рез = СтрЗаменить(Рез,""в"",""v"");
    Рез = СтрЗаменить(Рез,""г"",""g"");
    Рез = СтрЗаменить(Рез,""д"",""d"");
    Рез = СтрЗаменить(Рез,""е"",""e"");
    Рез = СтрЗаменить(Рез,""ё"",""e"");
    Рез = СтрЗаменить(Рез,""ж"",""zh"");
    Рез = СтрЗаменить(Рез,""з"",""z"");
    Рез = СтрЗаменить(Рез,""и"",""i"");
    Рез = СтрЗаменить(Рез,""к"",""k"");
    Рез = СтрЗаменить(Рез,""л"",""l"");
    Рез = СтрЗаменить(Рез,""м"",""m"");
    Рез = СтрЗаменить(Рез,""н"",""n"");
    Рез = СтрЗаменить(Рез,""о"",""o"");
    Рез = СтрЗаменить(Рез,""п"",""p"");
    Рез = СтрЗаменить(Рез,""р"",""r"");
    Рез = СтрЗаменить(Рез,""с"",""s"");
    Рез = СтрЗаменить(Рез,""т"",""t"");
    Рез = СтрЗаменить(Рез,""у"",""u"");
    Рез = СтрЗаменить(Рез,""ф"",""f"");
    Рез = СтрЗаменить(Рез,""х"",""h"");
    Рез = СтрЗаменить(Рез,""ч"",""ch"");
    Рез = СтрЗаменить(Рез,""ш"",""sh"");
    Рез = СтрЗаменить(Рез,""щ"",""sch"");
    Рез = СтрЗаменить(Рез,""ъ"","""");
    Рез = СтрЗаменить(Рез,""ь"","""");
    Рез = СтрЗаменить(Рез,""э"",""e"");
    Рез = СтрЗаменить(Рез,""ю"",""yu"");
    Рез = СтрЗаменить(Рез,""й"",""i"");
    Рез = СтрЗаменить(Рез,""ц"",""c"");
    Рез = СтрЗаменить(Рез,""я"",""ya"");
    Рез = СтрЗаменить(Рез,""ы"",""i"");
    Рез = СтрЗаменить(Рез,""А"",""A"");
    Рез = СтрЗаменить(Рез,""Б"",""B"");
    Рез = СтрЗаменить(Рез,""В"",""V"");
    Рез = СтрЗаменить(Рез,""Г"",""G"");
    Рез = СтрЗаменить(Рез,""Д"",""D"");
    Рез = СтрЗаменить(Рез,""Е"",""E"");
    Рез = СтрЗаменить(Рез,""Ё"",""E"");
    Рез = СтрЗаменить(Рез,""Ж"",""ZH"");
    Рез = СтрЗаменить(Рез,""З"",""Z"");
    Рез = СтрЗаменить(Рез,""И"",""I"");
    Рез = СтрЗаменить(Рез,""К"",""K"");
    Рез = СтрЗаменить(Рез,""Л"",""L"");
    Рез = СтрЗаменить(Рез,""М"",""M"");
    Рез = СтрЗаменить(Рез,""Н"",""N"");
    Рез = СтрЗаменить(Рез,""О"",""O"");
    Рез = СтрЗаменить(Рез,""П"",""P"");
    Рез = СтрЗаменить(Рез,""Р"",""R"");
    Рез = СтрЗаменить(Рез,""С"",""S"");
    Рез = СтрЗаменить(Рез,""Т"",""T"");
    Рез = СтрЗаменить(Рез,""У"",""U"");
    Рез = СтрЗаменить(Рез,""Ф"",""F"");
    Рез = СтрЗаменить(Рез,""Х"",""H"");
    Рез = СтрЗаменить(Рез,""Ч"",""CH"");
    Рез = СтрЗаменить(Рез,""Ш"",""SH"");
    Рез = СтрЗаменить(Рез,""Щ"",""SCH"");
    Рез = СтрЗаменить(Рез,""Ъ"","""");
    Рез = СтрЗаменить(Рез,""Ь"","""");
    Рез = СтрЗаменить(Рез,""Ы"",""I"");
    Рез = СтрЗаменить(Рез,""Ц"",""C"");
    Рез = СтрЗаменить(Рез,""Э"",""E"");
    Рез = СтрЗаменить(Рез,""Ю"",""YU"");
    Рез = СтрЗаменить(Рез,""Я"",""YA"");
    Рез = СтрЗаменить(Рез,""Й"",""I"");
    Возврат(Рез);
КонецФункции
"}
},
{0,
{"ПолучитьПраваИНастройкиПользователя",0,0,"Прав[а]","<?""ИмяНастройки"">=обПолучитьПраваИНастройкиПользователя(ПараметрыСеанса.Пользователь, ""<?""ИмяНастройки"">"");	
Если <?""ИмяНастройки""> Тогда
	<?>
Конецесли;"}
},
{0,
{"Функция сервер",0,0,"Фус","&НаСервере
Функция <?""ИмяЭлемента"">() 
	РезультатФункции = Новый Структура();
	РезультатФункции.Вставить("""",);
	
	<?>
	
	Возврат РезультатФункции;
КонецФункции "}
},
{0,
{"фнмПолучитьЗапрещеноЛиРедактироватьДокумент",0,0,"фнмЗапр","ДопПараметры = Новый Структура();
ДопПараметры.Вставить(""ЭтотОбъект"",ЭтотОбъект);
ДопПараметры.Вставить(""РежимЗаписи"",РежимЗаписиДокумента.Проведение);
ДопПараметры.Вставить(""Отказ"",Ложь);
ДопПараметры.Вставить(""Ошибки"","""");
ДопПараметры.Вставить(""ТекущееВремя"",ТекущаяДата());			
РезультатФункции = фнмПолучитьЗапрещеноЛиРедактироватьДокумент(ДопПараметры);
Возврат РезультатФункции.ЗапрещеноРедактировать;

"}
},
{0,
{"ГУИД через COM",0,0,"","СсылкаВДругойИБ = фнмСоединениеСБПСОМ.String(ОС_БУ.UUID());"}
},
{0,
{"ТекстЗапроса",0,0,"Текс[тЗапроса]","Возврат ""
<?>
|"";
"}
},
{0,
{"ПаузаЧерезСкрипт",0,0,"","Процедура Sleep(ПаузаВСекундах = 0) Экспорт
    
    ИмяСкриптФайла = КаталогВременныхФайлов()+""\sleep.js"";
    
    Если ПаузаВСекундах <= 0 Тогда
        Если НайтиФайлы(ИмяСкриптФайла).Количество() = 0 Тогда
            Скрипт=Новый ТекстовыйДокумент();
            Скрипт.УстановитьТекст(
            ""if (WScript.Arguments.Count()==0)
            |    WScript.Quit();
            |else
            |    if (isNaN(parseInt(WScript.Arguments(0))))
            |        WScript.Quit();
            |WScript.Sleep(WScript.Arguments(0));"");
            Скрипт.Записать(ИмяСкриптФайла,КодировкаТекста.ANSI);
        Иначе
            УдалитьФайлы(ИмяСкриптФайла);
        КонецЕсли;
        Возврат;
    Иначе
        Если НайтиФайлы(ИмяСкриптФайла).Количество() = 0 Тогда
            Sleep();
        КонецЕсли;
    КонецЕсли;
    
    Run = ""wscript.exe "" + """" + ИмяСкриптФайла + """" + "" "" + Формат(ПаузаВСекундах * 1000,""ЧДЦ=0; ЧГ="");
    Shell=Новый COMОбъект(""wscript.shell"");
    Shell.Run(Run,0,-1);
    Shell = Неопределено;

КонецПроцедуры;


//Другой вариант

// Делаем три попытки с паузой в одну минуту
 
Пока Повтор = 1 По 3 Цикл
   // что-то делаем... а потом пауза
 
   // А ведь никто не спросил ""А зачем это нужно?"" - значит кому-то ""это"" нужно :)
 
   Попытка
      ФоновыеЗадания.ПолучитьФоновыеЗадания(Новый Структура(""Наименование"", ""Моё первое задание""))[0].ОжидатьЗавершения(60);
   Исключение
   КонецПопытки;
КонецЦикла;

//3-ий вариант

Пока НЕ ТекущаяДата() = ТекДата + 10 Цикл 
//.... думаем 10 секунд :) 
КонецЦикла;"}
},
{0,
{"Многопоточность ФоновыеЗадания",0,0,"","Процедура КнопкаВыполнитьНажатие(Кнопка)

    //указывает число потоков, которые будут запущены одновременно
    ЧислоПараллельныхПотоков = 10;

    МассивЗаданий = Новый Массив;

    Запрос = Новый Запрос(
    ""ВЫБРАТЬ РАЗЛИЧНЫЕ
    |    ПартииТоваровНаСкладах.Склад
    |ИЗ
    |    РегистрНакопления.ПартииТоваровНаСкладах КАК ПартииТоваровНаСкладах
    |ГДЕ
    |    ПартииТоваровНаСкладах.Период МЕЖДУ &Дата1 И &Дата2"");
    Запрос.УстановитьПараметр(""Дата1"", ДатаНачала);
    Запрос.УстановитьПараметр(""Дата2"", ДатаОкончания);

    Результат = Запрос.Выполнить().Выгрузить();

    Для каждого Стр из Результат Цикл

        МассивПараметров = Новый Массив;
        МассивПараметров.Добавить(ДатаНачала);
        МассивПараметров.Добавить(ДатаОкончания);
        МассивПараметров.Добавить(Стр.Склад);

        Задание = ФоновыеЗадания.Выполнить(""ВыгрузкаДанныхНаСервере.ВыгрузитьДанныеПоПартиям"", МассивПараметров);

        МассивЗаданий.Добавить(Задание);

        Если МассивЗаданий.Количество() >= ЧислоПараллельныхПотоков Тогда
            Попытка
                ФоновыеЗадания.ОжидатьЗавершения(МассивЗаданий);
            Исключение
            КонецПопытки;
            МассивЗаданий.Очистить();
        КонецЕсли;

    КонецЦикла;

    Если МассивЗаданий.Количество() > 0 Тогда
        Попытка
            ФоновыеЗадания.ОжидатьЗавершения(МассивЗаданий);
        Исключение
        КонецПопытки;
        МассивЗаданий.Очистить();
    КонецЕсли;

    Сообщить(""Время выполнения процедуры - "" + (ТекущаяДата() - ВремяНачала) + "" с."");

КонецПроцедуры


//2)      Процедура, которую непосредственно выполняет фоновое задание (основная логика):

// Общий модуль «ВыгрузкаДанныхНаСервере», выполняемый на сервере:

Процедура ВыгрузитьДанныеПоПартиям(ДатаНачала, ДатаОкончания, Склад) Экспорт

    Запрос = Новый Запрос(
    ""ВЫБРАТЬ
    |    *
    |ИЗ
    |    РегистрНакопления.ПартииТоваровНаСкладах КАК ПартииТоваровНаСкладах
    |ГДЕ
    |    ПартииТоваровНаСкладах.Период МЕЖДУ &Дата1 И &Дата2
    |    И ПартииТоваровНаСкладах.Склад = &Склад"");

    Запрос.УстановитьПараметр(""Дата1"", ДатаНачала);
    Запрос.УстановитьПараметр(""Дата2"", ДатаОкончания);
    Запрос.УстановитьПараметр(""Склад"", Склад);

    Результат = Запрос.Выполнить().Выгрузить();

    Для каждого Стр из Результат Цикл
        //Что-то делаем с данными
    КонецЦикла;

КонецПроцедуры"}
},
{0,
{"Расчет рабочих дней в запросе через индекс",0,0,"","ВЫБРАТЬ
    РеализацияТоваровУслуг.Ссылка,
    НАЧАЛОПЕРИОДА(РеализацияТоваровУслуг.Дата, ДЕНЬ) КАК Дата,
    РеализацияТоваровУслуг.ДоговорКонтрагента.ДопустимоеЧислоДнейЗадолженности КАК ДнейОтсрочкиДолга
ПОМЕСТИТЬ ВТ
ИЗ
    Документ.РеализацияТоваровУслуг КАК РеализацияТоваровУслуг
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
    РегламентированныйПроизводственныйКалендарь.ДатаКалендаря
ПОМЕСТИТЬ ВТ_РеглКалендарь
ИЗ
    РегистрСведений.РегламентированныйПроизводственныйКалендарь КАК РегламентированныйПроизводственныйКалендарь
ГДЕ
    РегламентированныйПроизводственныйКалендарь.ВидДня В(&ВидДня)
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
    ВТ_РеглКалендарь.ДатаКалендаря,
    КОЛИЧЕСТВО(РАЗЛИЧНЫЕ ВТ_РеглКалендарь1.ДатаКалендаря) КАК ИндексРегламентированногоКалендаря
ПОМЕСТИТЬ ВТ_РеглКалендарьСИндексами
ИЗ
    ВТ_РеглКалендарь КАК ВТ_РеглКалендарь
        ВНУТРЕННЕЕ СОЕДИНЕНИЕ ВТ_РеглКалендарь КАК ВТ_РеглКалендарь1
        ПО ВТ_РеглКалендарь.ДатаКалендаря >= ВТ_РеглКалендарь1.ДатаКалендаря

СГРУППИРОВАТЬ ПО
    ВТ_РеглКалендарь.ДатаКалендаря
ИНДЕКСИРОВАТЬ ПО
        ИндексРегламентированногоКалендаря
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
    ВТ.Ссылка,
    ВТ.Дата,
    ВТ.ДнейОтсрочкиДолга,
    ВТ_РеглКалендарьСИндексами.ИндексРегламентированногоКалендаря КАК ИндексДатыДолга
ПОМЕСТИТЬ ВТ_СИндексом
ИЗ
    ВТ КАК ВТ
        ЛЕВОЕ СОЕДИНЕНИЕ ВТ_РеглКалендарьСИндексами КАК ВТ_РеглКалендарьСИндексами
        ПО ВТ.Дата = ВТ_РеглКалендарьСИндексами.ДатаКалендаря
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
    ВТ_СИндексом.Ссылка,
    ВТ_СИндексом.Дата КАК ДатаВозникновенияДолга,
        ВТ_СИндексом.ДнейОтсрочкиДолга,
    ВТ_РеглКалендарьСИндексами.ДатаКалендаря КАК ДатаВозникновенияПросроченногоДолга
ИЗ
    ВТ_СИндексом КАК ВТ_СИндексом
        ЛЕВОЕ СОЕДИНЕНИЕ ВТ_РеглКалендарьСИндексами КАК ВТ_РеглКалендарьСИндексами
        ПО (ВТ_РеглКалендарьСИндексами.ИндексРегламентированногоКалендаря - ВТ_СИндексом.ИндексДатыДолга = ВТ_СИндексом.ДнейОтсрочкиДолга)"}
},
{0,
{"Многопоточность Фоновые задания",0,0,"","Процедура КнопкаВыполнитьНажатие(Кнопка)

    //указывает число потоков, которые будут запущены одновременно
    ЧислоПараллельныхПотоков = 10;

    МассивЗаданий = Новый Массив;

    Запрос = Новый Запрос(
    ""ВЫБРАТЬ РАЗЛИЧНЫЕ
    |    ПартииТоваровНаСкладах.Склад
    |ИЗ
    |    РегистрНакопления.ПартииТоваровНаСкладах КАК ПартииТоваровНаСкладах
    |ГДЕ
    |    ПартииТоваровНаСкладах.Период МЕЖДУ &Дата1 И &Дата2"");
    Запрос.УстановитьПараметр(""Дата1"", ДатаНачала);
    Запрос.УстановитьПараметр(""Дата2"", ДатаОкончания);

    Результат = Запрос.Выполнить().Выгрузить();

    Для каждого Стр из Результат Цикл

        МассивПараметров = Новый Массив;
        МассивПараметров.Добавить(ДатаНачала);
        МассивПараметров.Добавить(ДатаОкончания);
        МассивПараметров.Добавить(Стр.Склад);

        Задание = ФоновыеЗадания.Выполнить(""ВыгрузкаДанныхНаСервере.ВыгрузитьДанныеПоПартиям"", МассивПараметров);

        МассивЗаданий.Добавить(Задание);

        Если МассивЗаданий.Количество() >= ЧислоПараллельныхПотоков Тогда
            Попытка
                ФоновыеЗадания.ОжидатьЗавершения(МассивЗаданий);
            Исключение
            КонецПопытки;
            МассивЗаданий.Очистить();
        КонецЕсли;

    КонецЦикла;

    Если МассивЗаданий.Количество() > 0 Тогда
        Попытка
            ФоновыеЗадания.ОжидатьЗавершения(МассивЗаданий);
        Исключение
        КонецПопытки;
        МассивЗаданий.Очистить();
    КонецЕсли;

    Сообщить(""Время выполнения процедуры - "" + (ТекущаяДата() - ВремяНачала) + "" с."");

КонецПроцедуры"}
},
{0,
{"ВыбратьДатыЗаПериодЗапросом",0,0,"","ВЫБРАТЬ
	0 КАК Поле
ПОМЕСТИТЬ Цифры

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	1

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	2

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	3
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ ПЕРВЫЕ 1024
	Числа1.Поле + 4 * Числа2.Поле + 16 * Числа3.Поле + 64 * Числа4.Поле + 256 * Числа5.Поле + 1 КАК Поле
ПОМЕСТИТЬ Числа
ИЗ
	Цифры КАК Числа1,
	Цифры КАК Числа2,
	Цифры КАК Числа3,
	Цифры КАК Числа4,
	Цифры КАК Числа5

УПОРЯДОЧИТЬ ПО
	Поле
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ДОБАВИТЬКДАТЕ(&ДатаНач, ДЕНЬ, Числа.Поле) КАК ПолеДата
ИЗ
	Числа КАК Числа
ГДЕ
	Числа.Поле <= РАЗНОСТЬДАТ(&ДатаНач, &ДатаКон, ДЕНЬ)"}
},
{0,
{"Получение данных динамического списка",0,0,"","//Получение данных динамического списка
Схема = Элементы.Список.ПолучитьИсполняемуюСхемуКомпоновкиДанных();
Настройки = Элементы.Список.ПолучитьИсполняемыеНастройкиКомпоновкиДанных();
КомпоновщикМакета = Новый КомпоновщикМакетаКомпоновкиДанных();
МакетКомпоновки = КомпоновщикМакета.Выполнить(Схема,Настройки);
ПроцессорКомпоновки = Новый ПроцессорКомпоновкиДанных;
ПроцессорКомпоновки.Инициализировать(МакетКомпоновки);
ПроцессорВывода = Новый ПроцессорВыводаРезультатаКомпоновкиДанныхВКоллекциюЗначений;
Результат = ПроцессорВывода.Вывести(ПроцессорКомпоновки);"}
},
{0,
{"Функция клиент",0,0,"Фук","&НаКлиенте
Функция <?""ИмяЭлемента"">() 
	РезультатФункции = Новый Структура();
	РезультатФункции.Вставить("""",);
	
	<?>
	
	Возврат РезультатФункции;
КонецФункции "}
},
{0,
{"НЕ ЗначениеЗаполнено",0,0,"Нез","Если НЕ ЗначениеЗаполнено(<?""ИмяРеквизита"">) Тогда
	Продолжить;
Конецесли;
<?>"}
},
{0,
{"Параметры.ЗначениеКопирования.Пустой()",0,0,"","&НаСервере
Процедура ПриСозданииНаСервере(Отказ, СтандартнаяОбработка)
	Если НЕ Параметры.ЗначениеКопирования.Пустой() Тогда
		Запись.ДатаНачала = Дата(1,1,1);
		Запись.ДатаОкончания = Дата(1,1,1);
	КонецЕсли;	

КонецПроцедуры
"}
},
{0,
{"Отладить Запрос",0,0,"","http://курсы-по-1с.рф/articles/2017-09-07-4-methods-of-query-debugging/

//Для каждой временной таблицы можно получить имя (свойство ПолноеИмя) и список колонок (свойство Колонки). Метод ПолучитьДанные() 
//временной таблицы запроса возвращает значение типа РезультатЗапроса. Соответственно, можно вывести содержимое самой временной таблицы:  
МенеджерВременныхТаблиц.Таблицы[0].ПолучитьДанные().Выгрузить();


//Результат работы этого метода аналогичен методу ВыполнитьПакет(), но есть важное отличие. Когда используется метод ВыполнитьПакет(), 
//то для временной таблицы в результате мы получаем количество записей, которое было помещено во временную таблицу. 
//При использовании метода ВыполнитьПакетСПромежуточнымиДанными() вместо количества записей будет возвращено содержимое этой временной таблицы: 
Запрос.ВыполнитьПакетСПромежуточнымиДанными();



//ВнешниеОбработки.Создать(""D:\Documents\Ivanov\1_Обработки\OtladkaZaprosa.epf"").Отладить(Запрос, Истина);

ВнешниеОбработки.Создать(""D:\Documents\Ivanov\1_Обработки\OtladkaZaprosa.epf"").ОтладитьЗапрос(ЗапросАвтоЗаполнения, Истина)"}
},
{0,
{"Блокировка",0,0,"","Блокировка = Новый БлокировкаДанных;
ЭлементБлокировки = Блокировка.Добавить(""РегистрНакопления.Партии"");
ЭлементБлокировки.Режим = РежимБлокировкиДанных.Исключительный;
ЭлементБлокировки.УстановитьЗначение(""Склад"", Склад);
ЭлементБлокировки.ИсточникДанных = ЭтотОбъект.Товары;
ЭлементБлокировки.ИспользоватьИзИсточникаДанных(""Номенклатура"", ""Номенклатура"");
Блокировка.Заблокировать();


Если Режим = РежимПроведенияДокумента.Оперативный Тогда
	Движения.Партии.Очистить();
	Движения.Партии.БлокироватьДляИзменения = Истина;
	Движения.Записать();
КонецЕсли;

//http://forum.chistov.pro/index.php?topic=1999.msg22182#msg22182
Движения.ОстаткиНоменклатуры.БлокироватьДляИзменения = Истина;    
Движения.ОстаткиНоменклатуры.Записать();           

Блокирока = Новый БлокировкаДанных;   
ЭлементБлокировки = Блокирока.Добавить(""РегистрНакопления.ОстаткиНоменклатуры"");   
ЭлементБлокировки.Режим = РежимБлокировкиДанных.Исключительный;    
ЭлементБлокировки.ИсточникДанных = СписокНоменклатуры;   
ЭлементБлокировки.ИспользоватьИзИсточникаДанных(""Номенклатура"",""Номенклатура"");   
Блокирока.Заблокировать();"}
},
{0,
{"РегистраторыРегистров",0,0,"","	НаборЗаписей = РегистрыНакопления.фнмДоходыИРасходы.СоздатьНаборЗаписей();
	МассивТипов = НаборЗаписей.Отбор.Регистратор.ТипЗначения.Типы();
	Для каждого ТипДокумента Из МассивТипов Цикл
	    ДокументСсылка = Новый(ТипДокумента);
	    Имя = ДокументСсылка.Метаданные().Имя; 
	    Синоним = ДокументСсылка.Метаданные().Синоним;
	    Сообщить(Имя);
	КонецЦикла;	
"}
},
{0,
{"ИнтервалыЗапросом (+ перевод из строки в число) + туры",0,0,"","//Общий запрос

ВЫБРАТЬ
    Слева.Дата КАК НачалоИнтервала,
    МИНИМУМ(Справа.Дата) КАК КонецИнтервала
ИЗ 
    Даты КАК Слева 
    ВНУТРЕННЕЕ СОЕДИНЕНИЕ Даты КАК Справа
        ПО Слева.Дата < Справа.Дата
СГРУППИРОВАТЬ ПО 
    Слева.Дата
	
	
//Интервалы запросом и перевод из строки в число запросом
//
|ВЫБРАТЬ РАЗЛИЧНЫЕ
|	ПОДСТРОКА(ШтрихКоды.ШтрихКод, 1, 12) КАК ШтрихКод
|ПОМЕСТИТЬ ВТШтрихКодыПредв
|ИЗ
|	РегистрСведений.ШтрихКоды КАК ШтрихКоды
|ГДЕ
|	ПОДСТРОКА(ШтрихКоды.ШтрихКод, 1, 2) = &ПрефиксШтучногоШК
|	И ШтрихКоды.ШтрихКод МЕЖДУ &мШтрихКодНачалоИнтервала И &мШтрихКодКонецИнтервала
|ОБЪЕДИНИТЬ
|
|ВЫБРАТЬ
|	ПОДСТРОКА(&мШтрихКодНачалоИнтервала, 1, 12) КАК ШтрихКод 	
|	
|ОБЪЕДИНИТЬ
|
|ВЫБРАТЬ
|	ПОДСТРОКА(&мШтрихКодКонецИнтервала, 1, 12) КАК ШтрихКод 		
|;
|;
|
|ВЫБРАТЬ    """"0"""" КАК Цифра, 0 КАК Позиция, 1 КАК Вес
|ПОМЕСТИТЬ СистемаСчисления
|ОБЪЕДИНИТЬ ВЫБРАТЬ """"1"""", 1, 10
|ОБЪЕДИНИТЬ ВЫБРАТЬ """"2"""", 2, 100
|ОБЪЕДИНИТЬ ВЫБРАТЬ """"3"""", 3, 1000
|ОБЪЕДИНИТЬ ВЫБРАТЬ """"4"""", 4, 10000
|ОБЪЕДИНИТЬ ВЫБРАТЬ """"5"""", 5, 100000
|ОБЪЕДИНИТЬ ВЫБРАТЬ """"6"""", 6, 1000000
|ОБЪЕДИНИТЬ ВЫБРАТЬ """"7"""", 7, 10000000
|ОБЪЕДИНИТЬ ВЫБРАТЬ """"8"""", 8, 100000000
|ОБЪЕДИНИТЬ ВЫБРАТЬ """"9"""", 9, 1000000000
|ОБЪЕДИНИТЬ ВЫБРАТЬ """"10"""",10,10000000000
|ОБЪЕДИНИТЬ ВЫБРАТЬ """"11"""",11,100000000000
|
|;
|
|
|ВЫБРАТЬ  
|	ВТШтрихКодыПредв.ШтрихКод КАК ШтрихКодСтрока, 
|	СУММА(СтепениДесяти.Вес * Цифры.Позиция) / МИНИМУМ(СтепениДесяти.Вес) КАК ШтрихКод
|ПОМЕСТИТЬ ВТШтрихКоды
|ИЗ ВТШтрихКодыПредв
|	СОЕДИНЕНИЕ СистемаСчисления КАК СтепениДесяти ПО (ИСТИНА)
|	СОЕДИНЕНИЕ СистемаСчисления КАК Цифры ПО (ПОДСТРОКА(ВТШтрихКодыПредв.ШтрихКод, 12 - СтепениДесяти.Позиция, 1) = Цифры.Цифра)
|СГРУППИРОВАТЬ ПО
|	ВТШтрихКодыПредв.ШтрихКод
|;
|
|
|////////////////////////////////////////////////////////////////////////////////
|ВЫБРАТЬ
|	ВТШтрихКодыСлева.ШтрихКод КАК НачалоИнтервала,
|	МИНИМУМ(ВТШтрихКодыСправа.ШтрихКод) КАК КонецИнтервала
|ПОМЕСТИТЬ ВТРезультат
|ИЗ
|	ВТШтрихКоды КАК ВТШтрихКодыСлева
|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ ВТШтрихКоды КАК ВТШтрихКодыСправа
|		ПО ВТШтрихКодыСлева.ШтрихКод < ВТШтрихКодыСправа.ШтрихКод
|
|СГРУППИРОВАТЬ ПО
|	ВТШтрихКодыСлева.ШтрихКод
|;
|
|
|////////////////////////////////////////////////////////////////////////////////
|ВЫБРАТЬ
|	ВТРезультат.НачалоИнтервала,
|	ВТРезультат.КонецИнтервала,
|	ВТРезультат.КонецИнтервала - ВТРезультат.НачалоИнтервала КАК КоличествоШКВИнтервале
|ИЗ
|	ВТРезультат КАК ВТРезультат
|ГДЕ
|	ВТРезультат.КонецИнтервала - ВТРезультат.НачалоИнтервала > 1
|
|УПОРЯДОЧИТЬ ПО
|	ВТРезультат.НачалоИнтервала
	


"}
},
{0,
{"ИнтерваылЗапросом через туры",0,0,"","|ВЫБРАТЬ РАЗЛИЧНЫЕ
|	ПОДСТРОКА(ШтрихКоды.ШтрихКод, 1, 12) КАК ШтрихКод
|ПОМЕСТИТЬ ВТШтрихКодыПредв
|ИЗ
|	РегистрСведений.ШтрихКоды КАК ШтрихКоды
|ГДЕ
|	ПОДСТРОКА(ШтрихКоды.ШтрихКод, 1, 2) = &ПрефиксШтучногоШК
|	И ШтрихКоды.ШтрихКод МЕЖДУ &мШтрихКодНачалоИнтервала И &мШтрихКодКонецИнтервала
|
|ОБЪЕДИНИТЬ
|
|ВЫБРАТЬ
|	ПОДСТРОКА(&мШтрихКодНачалоИнтервала, 1, 12)
|
|ОБЪЕДИНИТЬ
|
|ВЫБРАТЬ
|	ПОДСТРОКА(&мШтрихКодКонецИнтервала, 1, 12)
|;
|
|ВЫБРАТЬ    """"0"""" КАК Цифра, 0 КАК Позиция, 1 КАК Вес
|ПОМЕСТИТЬ СистемаСчисления
|ОБЪЕДИНИТЬ ВЫБРАТЬ """"1"""", 1, 10
|ОБЪЕДИНИТЬ ВЫБРАТЬ """"2"""", 2, 100
|ОБЪЕДИНИТЬ ВЫБРАТЬ """"3"""", 3, 1000
|ОБЪЕДИНИТЬ ВЫБРАТЬ """"4"""", 4, 10000
|ОБЪЕДИНИТЬ ВЫБРАТЬ """"5"""", 5, 100000
|ОБЪЕДИНИТЬ ВЫБРАТЬ """"6"""", 6, 1000000
|ОБЪЕДИНИТЬ ВЫБРАТЬ """"7"""", 7, 10000000
|ОБЪЕДИНИТЬ ВЫБРАТЬ """"8"""", 8, 100000000
|ОБЪЕДИНИТЬ ВЫБРАТЬ """"9"""", 9, 1000000000
|ОБЪЕДИНИТЬ ВЫБРАТЬ """"10"""",10,10000000000
|ОБЪЕДИНИТЬ ВЫБРАТЬ """"11"""",11,100000000000
|
|;
|
|////////////////////////////////////////////////////////////////////////////////
|ВЫБРАТЬ
|	ВТШтрихКодыПредв.ШтрихКод КАК ШтрихКодСтрока,
|	СУММА(СтепениДесяти.Вес * Цифры.Позиция) / МИНИМУМ(СтепениДесяти.Вес) КАК ШтрихКод
|ПОМЕСТИТЬ ВТШтрихКоды
|ИЗ
|	ВТШтрихКодыПредв КАК ВТШтрихКодыПредв
|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ СистемаСчисления КАК СтепениДесяти
|		ПО (ИСТИНА)
|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ СистемаСчисления КАК Цифры
|		ПО (ПОДСТРОКА(ВТШтрихКодыПредв.ШтрихКод, 12 - СтепениДесяти.Позиция, 1) = Цифры.Цифра)
|
|СГРУППИРОВАТЬ ПО
|	ВТШтрихКодыПредв.ШтрихКод
|;
|
|////////////////////////////////////////////////////////////////////////////////
|ВЫБРАТЬ
|	ВТШтрихКоды.ШтрихКод - &мШтрихКодНачалоИнтервалаЧисло12 КАК НомерПары,
|	ВТШтрихКоды.ШтрихКод КАК НижняяГраница,
|	ВТШтрихКоды.ШтрихКод КАК ВерхняяГраница
|ПОМЕСТИТЬ Тур0
|ИЗ
|	ВТШтрихКоды КАК ВТШтрихКоды
|;
|
|////////////////////////////////////////////////////////////////////////////////
|ВЫБРАТЬ
|	ВЫРАЗИТЬ(Тур0.НомерПары / 2 КАК ЧИСЛО(10, 0)) КАК НомерПары,
|	МИНИМУМ(Тур0.НижняяГраница) КАК НижняяГраница,
|	МАКСИМУМ(Тур0.ВерхняяГраница) КАК ВерхняяГраница,
|	МИНИМУМ(Тур0.ВерхняяГраница) КАК НачалоИнтервала,
|	МАКСИМУМ(Тур0.НижняяГраница) КАК КонецИнтервала
|ПОМЕСТИТЬ Тур1
|ИЗ
|	Тур0 КАК Тур0
|
|СГРУППИРОВАТЬ ПО
|	ВЫРАЗИТЬ(Тур0.НомерПары / 2 КАК ЧИСЛО(10, 0))
|;
|
|////////////////////////////////////////////////////////////////////////////////
|ВЫБРАТЬ
|	ВЫРАЗИТЬ(Тур1.НомерПары / 2 КАК ЧИСЛО(10, 0)) КАК НомерПары,
|	МИНИМУМ(Тур1.НижняяГраница) КАК НижняяГраница,
|	МАКСИМУМ(Тур1.ВерхняяГраница) КАК ВерхняяГраница,
|	МИНИМУМ(Тур1.ВерхняяГраница) КАК НачалоИнтервала,
|	МАКСИМУМ(Тур1.НижняяГраница) КАК КонецИнтервала
|ПОМЕСТИТЬ Тур2
|ИЗ
|	Тур1 КАК Тур1
|
|СГРУППИРОВАТЬ ПО
|	ВЫРАЗИТЬ(Тур1.НомерПары / 2 КАК ЧИСЛО(10, 0))
|;
|
|////////////////////////////////////////////////////////////////////////////////
|ВЫБРАТЬ
|	ВЫРАЗИТЬ(Тур2.НомерПары / 2 КАК ЧИСЛО(10, 0)) КАК НомерПары,
|	МИНИМУМ(Тур2.НижняяГраница) КАК НижняяГраница,
|	МАКСИМУМ(Тур2.ВерхняяГраница) КАК ВерхняяГраница,
|	МИНИМУМ(Тур2.ВерхняяГраница) КАК НачалоИнтервала,
|	МАКСИМУМ(Тур2.НижняяГраница) КАК КонецИнтервала
|ПОМЕСТИТЬ Тур3
|ИЗ
|	Тур2 КАК Тур2
|
|СГРУППИРОВАТЬ ПО
|	ВЫРАЗИТЬ(Тур2.НомерПары / 2 КАК ЧИСЛО(10, 0))
|;
|
|////////////////////////////////////////////////////////////////////////////////
|ВЫБРАТЬ
|	ВЫРАЗИТЬ(Тур3.НомерПары / 2 КАК ЧИСЛО(10, 0)) КАК НомерПары,
|	МИНИМУМ(Тур3.НижняяГраница) КАК НижняяГраница,
|	МАКСИМУМ(Тур3.ВерхняяГраница) КАК ВерхняяГраница,
|	МИНИМУМ(Тур3.ВерхняяГраница) КАК НачалоИнтервала,
|	МАКСИМУМ(Тур3.НижняяГраница) КАК КонецИнтервала
|ПОМЕСТИТЬ Тур4
|ИЗ
|	Тур3 КАК Тур3
|
|СГРУППИРОВАТЬ ПО
|	ВЫРАЗИТЬ(Тур3.НомерПары / 2 КАК ЧИСЛО(10, 0))
|;
|
|////////////////////////////////////////////////////////////////////////////////
|ВЫБРАТЬ
|	ВЫРАЗИТЬ(Тур4.НомерПары / 2 КАК ЧИСЛО(10, 0)) КАК НомерПары,
|	МИНИМУМ(Тур4.НижняяГраница) КАК НижняяГраница,
|	МАКСИМУМ(Тур4.ВерхняяГраница) КАК ВерхняяГраница,
|	МИНИМУМ(Тур4.ВерхняяГраница) КАК НачалоИнтервала,
|	МАКСИМУМ(Тур4.НижняяГраница) КАК КонецИнтервала
|ПОМЕСТИТЬ Тур5
|ИЗ
|	Тур4 КАК Тур4
|
|СГРУППИРОВАТЬ ПО
|	ВЫРАЗИТЬ(Тур4.НомерПары / 2 КАК ЧИСЛО(10, 0))
|;
|
|////////////////////////////////////////////////////////////////////////////////
|ВЫБРАТЬ
|	ВЫРАЗИТЬ(Тур5.НомерПары / 2 КАК ЧИСЛО(10, 0)) КАК НомерПары,
|	МИНИМУМ(Тур5.НижняяГраница) КАК НижняяГраница,
|	МАКСИМУМ(Тур5.ВерхняяГраница) КАК ВерхняяГраница,
|	МИНИМУМ(Тур5.ВерхняяГраница) КАК НачалоИнтервала,
|	МАКСИМУМ(Тур5.НижняяГраница) КАК КонецИнтервала
|ПОМЕСТИТЬ Тур6
|ИЗ
|	Тур5 КАК Тур5
|
|СГРУППИРОВАТЬ ПО
|	ВЫРАЗИТЬ(Тур5.НомерПары / 2 КАК ЧИСЛО(10, 0))
|;
|
|////////////////////////////////////////////////////////////////////////////////
|ВЫБРАТЬ
|	ВЫРАЗИТЬ(Тур6.НомерПары / 2 КАК ЧИСЛО(10, 0)) КАК НомерПары,
|	МИНИМУМ(Тур6.НижняяГраница) КАК НижняяГраница,
|	МАКСИМУМ(Тур6.ВерхняяГраница) КАК ВерхняяГраница,
|	МИНИМУМ(Тур6.ВерхняяГраница) КАК НачалоИнтервала,
|	МАКСИМУМ(Тур6.НижняяГраница) КАК КонецИнтервала
|ПОМЕСТИТЬ Тур7
|ИЗ
|	Тур6 КАК Тур6
|
|СГРУППИРОВАТЬ ПО
|	ВЫРАЗИТЬ(Тур6.НомерПары / 2 КАК ЧИСЛО(10, 0))
|;
|
|////////////////////////////////////////////////////////////////////////////////
|ВЫБРАТЬ
|	ВЫРАЗИТЬ(Тур7.НомерПары / 2 КАК ЧИСЛО(10, 0)) КАК НомерПары,
|	МИНИМУМ(Тур7.НижняяГраница) КАК НижняяГраница,
|	МАКСИМУМ(Тур7.ВерхняяГраница) КАК ВерхняяГраница,
|	МИНИМУМ(Тур7.ВерхняяГраница) КАК НачалоИнтервала,
|	МАКСИМУМ(Тур7.НижняяГраница) КАК КонецИнтервала
|ПОМЕСТИТЬ Тур8
|ИЗ
|	Тур7 КАК Тур7
|
|СГРУППИРОВАТЬ ПО
|	ВЫРАЗИТЬ(Тур7.НомерПары / 2 КАК ЧИСЛО(10, 0))
|;
|
|////////////////////////////////////////////////////////////////////////////////
|ВЫБРАТЬ
|	ВЫРАЗИТЬ(Тур8.НомерПары / 2 КАК ЧИСЛО(10, 0)) КАК НомерПары,
|	МИНИМУМ(Тур8.НижняяГраница) КАК НижняяГраница,
|	МАКСИМУМ(Тур8.ВерхняяГраница) КАК ВерхняяГраница,
|	МИНИМУМ(Тур8.ВерхняяГраница) КАК НачалоИнтервала,
|	МАКСИМУМ(Тур8.НижняяГраница) КАК КонецИнтервала
|ПОМЕСТИТЬ Тур9
|ИЗ
|	Тур8 КАК Тур8
|
|СГРУППИРОВАТЬ ПО
|	ВЫРАЗИТЬ(Тур8.НомерПары / 2 КАК ЧИСЛО(10, 0))
|;
|
|////////////////////////////////////////////////////////////////////////////////
|ВЫБРАТЬ
|	ВЫРАЗИТЬ(Тур9.НомерПары / 2 КАК ЧИСЛО(10, 0)) КАК НомерПары,
|	МИНИМУМ(Тур9.НижняяГраница) КАК НижняяГраница,
|	МАКСИМУМ(Тур9.ВерхняяГраница) КАК ВерхняяГраница,
|	МИНИМУМ(Тур9.ВерхняяГраница) КАК НачалоИнтервала,
|	МАКСИМУМ(Тур9.НижняяГраница) КАК КонецИнтервала
|ПОМЕСТИТЬ Тур10
|ИЗ
|	Тур9 КАК Тур9
|
|СГРУППИРОВАТЬ ПО
|	ВЫРАЗИТЬ(Тур9.НомерПары / 2 КАК ЧИСЛО(10, 0))
|;
|
|////////////////////////////////////////////////////////////////////////////////
|ВЫБРАТЬ
|	ВЫРАЗИТЬ(Тур10.НомерПары / 2 КАК ЧИСЛО(10, 0)) КАК НомерПары,
|	МИНИМУМ(Тур10.НижняяГраница) КАК НижняяГраница,
|	МАКСИМУМ(Тур10.ВерхняяГраница) КАК ВерхняяГраница,
|	МИНИМУМ(Тур10.ВерхняяГраница) КАК НачалоИнтервала,
|	МАКСИМУМ(Тур10.НижняяГраница) КАК КонецИнтервала
|ПОМЕСТИТЬ Тур11
|ИЗ
|	Тур10 КАК Тур10
|
|СГРУППИРОВАТЬ ПО
|	ВЫРАЗИТЬ(Тур10.НомерПары / 2 КАК ЧИСЛО(10, 0))
|;
|
|////////////////////////////////////////////////////////////////////////////////
|ВЫБРАТЬ
|	ВЫРАЗИТЬ(Тур11.НомерПары / 2 КАК ЧИСЛО(10, 0)) КАК НомерПары,
|	МИНИМУМ(Тур11.НижняяГраница) КАК НижняяГраница,
|	МАКСИМУМ(Тур11.ВерхняяГраница) КАК ВерхняяГраница,
|	МИНИМУМ(Тур11.ВерхняяГраница) КАК НачалоИнтервала,
|	МАКСИМУМ(Тур11.НижняяГраница) КАК КонецИнтервала
|ПОМЕСТИТЬ Тур12
|ИЗ
|	Тур11 КАК Тур11
|
|СГРУППИРОВАТЬ ПО
|	ВЫРАЗИТЬ(Тур11.НомерПары / 2 КАК ЧИСЛО(10, 0))
|;
|
|////////////////////////////////////////////////////////////////////////////////
|ВЫБРАТЬ
|	ВЫРАЗИТЬ(Тур12.НомерПары / 2 КАК ЧИСЛО(10, 0)) КАК НомерПары,
|	МИНИМУМ(Тур12.НижняяГраница) КАК НижняяГраница,
|	МАКСИМУМ(Тур12.ВерхняяГраница) КАК ВерхняяГраница,
|	МИНИМУМ(Тур12.ВерхняяГраница) КАК НачалоИнтервала,
|	МАКСИМУМ(Тур12.НижняяГраница) КАК КонецИнтервала
|ПОМЕСТИТЬ Тур13
|ИЗ
|	Тур12 КАК Тур12
|
|СГРУППИРОВАТЬ ПО
|	ВЫРАЗИТЬ(Тур12.НомерПары / 2 КАК ЧИСЛО(10, 0))
|;
|
|////////////////////////////////////////////////////////////////////////////////
|ВЫБРАТЬ
|	ВЫРАЗИТЬ(Тур13.НомерПары / 2 КАК ЧИСЛО(10, 0)) КАК НомерПары,
|	МИНИМУМ(Тур13.НижняяГраница) КАК НижняяГраница,
|	МАКСИМУМ(Тур13.ВерхняяГраница) КАК ВерхняяГраница,
|	МИНИМУМ(Тур13.ВерхняяГраница) КАК НачалоИнтервала,
|	МАКСИМУМ(Тур13.НижняяГраница) КАК КонецИнтервала
|ПОМЕСТИТЬ Тур14
|ИЗ
|	Тур13 КАК Тур13
|
|СГРУППИРОВАТЬ ПО
|	ВЫРАЗИТЬ(Тур13.НомерПары / 2 КАК ЧИСЛО(10, 0))
|;
|
|////////////////////////////////////////////////////////////////////////////////
|ВЫБРАТЬ
|	ВЫРАЗИТЬ(Тур14.НомерПары / 2 КАК ЧИСЛО(10, 0)) КАК НомерПары,
|	МИНИМУМ(Тур14.НижняяГраница) КАК НижняяГраница,
|	МАКСИМУМ(Тур14.ВерхняяГраница) КАК ВерхняяГраница,
|	МИНИМУМ(Тур14.ВерхняяГраница) КАК НачалоИнтервала,
|	МАКСИМУМ(Тур14.НижняяГраница) КАК КонецИнтервала
|ПОМЕСТИТЬ Тур15
|ИЗ
|	Тур14 КАК Тур14
|
|СГРУППИРОВАТЬ ПО
|	ВЫРАЗИТЬ(Тур14.НомерПары / 2 КАК ЧИСЛО(10, 0))
|;
|
|////////////////////////////////////////////////////////////////////////////////
|ВЫБРАТЬ
|	ВЫРАЗИТЬ(Тур15.НомерПары / 2 КАК ЧИСЛО(10, 0)) КАК НомерПары,
|	МИНИМУМ(Тур15.НижняяГраница) КАК НижняяГраница,
|	МАКСИМУМ(Тур15.ВерхняяГраница) КАК ВерхняяГраница,
|	МИНИМУМ(Тур15.ВерхняяГраница) КАК НачалоИнтервала,
|	МАКСИМУМ(Тур15.НижняяГраница) КАК КонецИнтервала
|ПОМЕСТИТЬ Тур16
|ИЗ
|	Тур15 КАК Тур15
|
|СГРУППИРОВАТЬ ПО
|	ВЫРАЗИТЬ(Тур15.НомерПары / 2 КАК ЧИСЛО(10, 0))
|;
|
|////////////////////////////////////////////////////////////////////////////////
|ВЫБРАТЬ
|	ВЫРАЗИТЬ(Тур16.НомерПары / 2 КАК ЧИСЛО(10, 0)) КАК НомерПары,
|	МИНИМУМ(Тур16.НижняяГраница) КАК НижняяГраница,
|	МАКСИМУМ(Тур16.ВерхняяГраница) КАК ВерхняяГраница,
|	МИНИМУМ(Тур16.ВерхняяГраница) КАК НачалоИнтервала,
|	МАКСИМУМ(Тур16.НижняяГраница) КАК КонецИнтервала
|ПОМЕСТИТЬ Тур17
|ИЗ
|	Тур16 КАК Тур16
|
|СГРУППИРОВАТЬ ПО
|	ВЫРАЗИТЬ(Тур16.НомерПары / 2 КАК ЧИСЛО(10, 0))
|;
|
|////////////////////////////////////////////////////////////////////////////////
|ВЫБРАТЬ
|	ВЫРАЗИТЬ(Тур17.НомерПары / 2 КАК ЧИСЛО(10, 0)) КАК НомерПары,
|	МИНИМУМ(Тур17.НижняяГраница) КАК НижняяГраница,
|	МАКСИМУМ(Тур17.ВерхняяГраница) КАК ВерхняяГраница,
|	МИНИМУМ(Тур17.ВерхняяГраница) КАК НачалоИнтервала,
|	МАКСИМУМ(Тур17.НижняяГраница) КАК КонецИнтервала
|ПОМЕСТИТЬ Тур18
|ИЗ
|	Тур17 КАК Тур17
|
|СГРУППИРОВАТЬ ПО
|	ВЫРАЗИТЬ(Тур17.НомерПары / 2 КАК ЧИСЛО(10, 0))
|;
|
|////////////////////////////////////////////////////////////////////////////////
|ВЫБРАТЬ
|	ВЫРАЗИТЬ(Тур18.НомерПары / 2 КАК ЧИСЛО(10, 0)) КАК НомерПары,
|	МИНИМУМ(Тур18.НижняяГраница) КАК НижняяГраница,
|	МАКСИМУМ(Тур18.ВерхняяГраница) КАК ВерхняяГраница,
|	МИНИМУМ(Тур18.ВерхняяГраница) КАК НачалоИнтервала,
|	МАКСИМУМ(Тур18.НижняяГраница) КАК КонецИнтервала
|ПОМЕСТИТЬ Тур19
|ИЗ
|	Тур18 КАК Тур18
|
|СГРУППИРОВАТЬ ПО
|	ВЫРАЗИТЬ(Тур18.НомерПары / 2 КАК ЧИСЛО(10, 0))
|;
|
|////////////////////////////////////////////////////////////////////////////////
|ВЫБРАТЬ
|	ВЫРАЗИТЬ(Тур19.НомерПары / 2 КАК ЧИСЛО(10, 0)) КАК НомерПары,
|	МИНИМУМ(Тур19.НижняяГраница) КАК НижняяГраница,
|	МАКСИМУМ(Тур19.ВерхняяГраница) КАК ВерхняяГраница,
|	МИНИМУМ(Тур19.ВерхняяГраница) КАК НачалоИнтервала,
|	МАКСИМУМ(Тур19.НижняяГраница) КАК КонецИнтервала
|ПОМЕСТИТЬ Тур20
|ИЗ
|	Тур19 КАК Тур19
|
|СГРУППИРОВАТЬ ПО
|	ВЫРАЗИТЬ(Тур19.НомерПары / 2 КАК ЧИСЛО(10, 0))
|;
|
|////////////////////////////////////////////////////////////////////////////////
|ВЫБРАТЬ
|	ВЫРАЗИТЬ(Тур20.НомерПары / 2 КАК ЧИСЛО(10, 0)) КАК НомерПары,
|	МИНИМУМ(Тур20.НижняяГраница) КАК НижняяГраница,
|	МАКСИМУМ(Тур20.ВерхняяГраница) КАК ВерхняяГраница,
|	МИНИМУМ(Тур20.ВерхняяГраница) КАК НачалоИнтервала,
|	МАКСИМУМ(Тур20.НижняяГраница) КАК КонецИнтервала
|ПОМЕСТИТЬ Тур21
|ИЗ
|	Тур20 КАК Тур20
|
|СГРУППИРОВАТЬ ПО
|	ВЫРАЗИТЬ(Тур20.НомерПары / 2 КАК ЧИСЛО(10, 0))
|;
|
|////////////////////////////////////////////////////////////////////////////////
|ВЫБРАТЬ
|	ВЫРАЗИТЬ(Тур21.НомерПары / 2 КАК ЧИСЛО(10, 0)) КАК НомерПары,
|	МИНИМУМ(Тур21.НижняяГраница) КАК НижняяГраница,
|	МАКСИМУМ(Тур21.ВерхняяГраница) КАК ВерхняяГраница,
|	МИНИМУМ(Тур21.ВерхняяГраница) КАК НачалоИнтервала,
|	МАКСИМУМ(Тур21.НижняяГраница) КАК КонецИнтервала
|ПОМЕСТИТЬ Тур22
|ИЗ
|	Тур21 КАК Тур21
|
|СГРУППИРОВАТЬ ПО
|	ВЫРАЗИТЬ(Тур21.НомерПары / 2 КАК ЧИСЛО(10, 0))
|;
|
|////////////////////////////////////////////////////////////////////////////////
|ВЫБРАТЬ
|	ВЫРАЗИТЬ(Тур22.НомерПары / 2 КАК ЧИСЛО(10, 0)) КАК НомерПары,
|	МИНИМУМ(Тур22.НижняяГраница) КАК НижняяГраница,
|	МАКСИМУМ(Тур22.ВерхняяГраница) КАК ВерхняяГраница,
|	МИНИМУМ(Тур22.ВерхняяГраница) КАК НачалоИнтервала,
|	МАКСИМУМ(Тур22.НижняяГраница) КАК КонецИнтервала
|ПОМЕСТИТЬ Тур23
|ИЗ
|	Тур22 КАК Тур22
|
|СГРУППИРОВАТЬ ПО
|	ВЫРАЗИТЬ(Тур22.НомерПары / 2 КАК ЧИСЛО(10, 0))
|;
|
|////////////////////////////////////////////////////////////////////////////////
|ВЫБРАТЬ
|	ВЫРАЗИТЬ(Тур23.НомерПары / 2 КАК ЧИСЛО(10, 0)) КАК НомерПары,
|	МИНИМУМ(Тур23.НижняяГраница) КАК НижняяГраница,
|	МАКСИМУМ(Тур23.ВерхняяГраница) КАК ВерхняяГраница,
|	МИНИМУМ(Тур23.ВерхняяГраница) КАК НачалоИнтервала,
|	МАКСИМУМ(Тур23.НижняяГраница) КАК КонецИнтервала
|ПОМЕСТИТЬ Тур24
|ИЗ
|	Тур23 КАК Тур23
|
|СГРУППИРОВАТЬ ПО
|	ВЫРАЗИТЬ(Тур23.НомерПары / 2 КАК ЧИСЛО(10, 0))
|;
|
|////////////////////////////////////////////////////////////////////////////////
|ВЫБРАТЬ
|	ВЫРАЗИТЬ(Тур24.НомерПары / 2 КАК ЧИСЛО(10, 0)) КАК НомерПары,
|	МИНИМУМ(Тур24.НижняяГраница) КАК НижняяГраница,
|	МАКСИМУМ(Тур24.ВерхняяГраница) КАК ВерхняяГраница,
|	МИНИМУМ(Тур24.ВерхняяГраница) КАК НачалоИнтервала,
|	МАКСИМУМ(Тур24.НижняяГраница) КАК КонецИнтервала
|ПОМЕСТИТЬ Тур25
|ИЗ
|	Тур24 КАК Тур24
|
|СГРУППИРОВАТЬ ПО
|	ВЫРАЗИТЬ(Тур24.НомерПары / 2 КАК ЧИСЛО(10, 0))
|;
|
|////////////////////////////////////////////////////////////////////////////////
|ВЫБРАТЬ
|	ВЫРАЗИТЬ(Тур25.НомерПары / 2 КАК ЧИСЛО(10, 0)) КАК НомерПары,
|	МИНИМУМ(Тур25.НижняяГраница) КАК НижняяГраница,
|	МАКСИМУМ(Тур25.ВерхняяГраница) КАК ВерхняяГраница,
|	МИНИМУМ(Тур25.ВерхняяГраница) КАК НачалоИнтервала,
|	МАКСИМУМ(Тур25.НижняяГраница) КАК КонецИнтервала
|ПОМЕСТИТЬ Тур26
|ИЗ
|	Тур25 КАК Тур25
|
|СГРУППИРОВАТЬ ПО
|	ВЫРАЗИТЬ(Тур25.НомерПары / 2 КАК ЧИСЛО(10, 0))
|;
|
|////////////////////////////////////////////////////////////////////////////////
|ВЫБРАТЬ
|	ВЫРАЗИТЬ(Тур26.НомерПары / 2 КАК ЧИСЛО(10, 0)) КАК НомерПары,
|	МИНИМУМ(Тур26.НижняяГраница) КАК НижняяГраница,
|	МАКСИМУМ(Тур26.ВерхняяГраница) КАК ВерхняяГраница,
|	МИНИМУМ(Тур26.ВерхняяГраница) КАК НачалоИнтервала,
|	МАКСИМУМ(Тур26.НижняяГраница) КАК КонецИнтервала
|ПОМЕСТИТЬ Тур27
|ИЗ
|	Тур26 КАК Тур26
|
|СГРУППИРОВАТЬ ПО
|	ВЫРАЗИТЬ(Тур26.НомерПары / 2 КАК ЧИСЛО(10, 0))
|;
|
|////////////////////////////////////////////////////////////////////////////////
|ВЫБРАТЬ
|	ВЫРАЗИТЬ(Тур27.НомерПары / 2 КАК ЧИСЛО(10, 0)) КАК НомерПары,
|	МИНИМУМ(Тур27.НижняяГраница) КАК НижняяГраница,
|	МАКСИМУМ(Тур27.ВерхняяГраница) КАК ВерхняяГраница,
|	МИНИМУМ(Тур27.ВерхняяГраница) КАК НачалоИнтервала,
|	МАКСИМУМ(Тур27.НижняяГраница) КАК КонецИнтервала
|ПОМЕСТИТЬ Тур28
|ИЗ
|	Тур27 КАК Тур27
|
|СГРУППИРОВАТЬ ПО
|	ВЫРАЗИТЬ(Тур27.НомерПары / 2 КАК ЧИСЛО(10, 0))
|;
|
|////////////////////////////////////////////////////////////////////////////////
|ВЫБРАТЬ
|	ВЫРАЗИТЬ(Тур28.НомерПары / 2 КАК ЧИСЛО(10, 0)) КАК НомерПары,
|	МИНИМУМ(Тур28.НижняяГраница) КАК НижняяГраница,
|	МАКСИМУМ(Тур28.ВерхняяГраница) КАК ВерхняяГраница,
|	МИНИМУМ(Тур28.ВерхняяГраница) КАК НачалоИнтервала,
|	МАКСИМУМ(Тур28.НижняяГраница) КАК КонецИнтервала
|ПОМЕСТИТЬ Тур29
|ИЗ
|	Тур28 КАК Тур28
|
|СГРУППИРОВАТЬ ПО
|	ВЫРАЗИТЬ(Тур28.НомерПары / 2 КАК ЧИСЛО(10, 0))
|;
|
|////////////////////////////////////////////////////////////////////////////////
|ВЫБРАТЬ
|	ВЫРАЗИТЬ(Тур29.НомерПары / 2 КАК ЧИСЛО(10, 0)) КАК НомерПары,
|	МИНИМУМ(Тур29.НижняяГраница) КАК НижняяГраница,
|	МАКСИМУМ(Тур29.ВерхняяГраница) КАК ВерхняяГраница,
|	МИНИМУМ(Тур29.ВерхняяГраница) КАК НачалоИнтервала,
|	МАКСИМУМ(Тур29.НижняяГраница) КАК КонецИнтервала
|ПОМЕСТИТЬ Тур30
|ИЗ
|	Тур29 КАК Тур29
|
|СГРУППИРОВАТЬ ПО
|	ВЫРАЗИТЬ(Тур29.НомерПары / 2 КАК ЧИСЛО(10, 0))
|;
|
|////////////////////////////////////////////////////////////////////////////////
|ВЫБРАТЬ
|	ВЫРАЗИТЬ(Тур30.НомерПары / 2 КАК ЧИСЛО(10, 0)) КАК НомерПары,
|	МИНИМУМ(Тур30.НижняяГраница) КАК НижняяГраница,
|	МАКСИМУМ(Тур30.ВерхняяГраница) КАК ВерхняяГраница,
|	МИНИМУМ(Тур30.ВерхняяГраница) КАК НачалоИнтервала,
|	МАКСИМУМ(Тур30.НижняяГраница) КАК КонецИнтервала
|ПОМЕСТИТЬ Тур31
|ИЗ
|	Тур30 КАК Тур30
|
|СГРУППИРОВАТЬ ПО
|	ВЫРАЗИТЬ(Тур30.НомерПары / 2 КАК ЧИСЛО(10, 0))
|;
|
|////////////////////////////////////////////////////////////////////////////////
|ВЫБРАТЬ
|	ВЫРАЗИТЬ(Тур31.НомерПары / 2 КАК ЧИСЛО(10, 0)) КАК НомерПары,
|	МИНИМУМ(Тур31.НижняяГраница) КАК НижняяГраница,
|	МАКСИМУМ(Тур31.ВерхняяГраница) КАК ВерхняяГраница,
|	МИНИМУМ(Тур31.ВерхняяГраница) КАК НачалоИнтервала,
|	МАКСИМУМ(Тур31.НижняяГраница) КАК КонецИнтервала
|ПОМЕСТИТЬ Тур32
|ИЗ
|	Тур31 КАК Тур31
|
|СГРУППИРОВАТЬ ПО
|	ВЫРАЗИТЬ(Тур31.НомерПары / 2 КАК ЧИСЛО(10, 0))
|;
|
|////////////////////////////////////////////////////////////////////////////////
|ВЫБРАТЬ
|	Тур1.НачалоИнтервала,
|	Тур1.КонецИнтервала
|ПОМЕСТИТЬ ВТРезультат
|ИЗ
|	Тур1 КАК Тур1
|ГДЕ
|	Тур1.НачалоИнтервала < Тур1.КонецИнтервала
|
|ОБЪЕДИНИТЬ
|
|ВЫБРАТЬ
|	Тур2.НачалоИнтервала,
|	Тур2.КонецИнтервала
|ИЗ
|	Тур2 КАК Тур2
|ГДЕ
|	Тур2.НачалоИнтервала < Тур2.КонецИнтервала
|
|ОБЪЕДИНИТЬ
|
|ВЫБРАТЬ
|	Тур3.НачалоИнтервала,
|	Тур3.КонецИнтервала
|ИЗ
|	Тур3 КАК Тур3
|ГДЕ
|	Тур3.НачалоИнтервала < Тур3.КонецИнтервала
|
|ОБЪЕДИНИТЬ
|
|ВЫБРАТЬ
|	Тур4.НачалоИнтервала,
|	Тур4.КонецИнтервала
|ИЗ
|	Тур4 КАК Тур4
|ГДЕ
|	Тур4.НачалоИнтервала < Тур4.КонецИнтервала
|
|ОБЪЕДИНИТЬ
|
|ВЫБРАТЬ
|	Тур5.НачалоИнтервала,
|	Тур5.КонецИнтервала
|ИЗ
|	Тур5 КАК Тур5
|ГДЕ
|	Тур5.НачалоИнтервала < Тур5.КонецИнтервала
|
|ОБЪЕДИНИТЬ
|
|ВЫБРАТЬ
|	Тур6.НачалоИнтервала,
|	Тур6.КонецИнтервала
|ИЗ
|	Тур6 КАК Тур6
|ГДЕ
|	Тур6.НачалоИнтервала < Тур6.КонецИнтервала
|
|ОБЪЕДИНИТЬ
|
|ВЫБРАТЬ
|	Тур7.НачалоИнтервала,
|	Тур7.КонецИнтервала
|ИЗ
|	Тур7 КАК Тур7
|ГДЕ
|	Тур7.НачалоИнтервала < Тур7.КонецИнтервала
|
|ОБЪЕДИНИТЬ
|
|ВЫБРАТЬ
|	Тур8.НачалоИнтервала,
|	Тур8.КонецИнтервала
|ИЗ
|	Тур8 КАК Тур8
|ГДЕ
|	Тур8.НачалоИнтервала < Тур8.КонецИнтервала
|
|ОБЪЕДИНИТЬ
|
|ВЫБРАТЬ
|	Тур9.НачалоИнтервала,
|	Тур9.КонецИнтервала
|ИЗ
|	Тур9 КАК Тур9
|ГДЕ
|	Тур9.НачалоИнтервала < Тур9.КонецИнтервала
|
|ОБЪЕДИНИТЬ
|
|ВЫБРАТЬ
|	Тур10.НачалоИнтервала,
|	Тур10.КонецИнтервала
|ИЗ
|	Тур10 КАК Тур10
|ГДЕ
|	Тур10.НачалоИнтервала < Тур10.КонецИнтервала
|
|ОБЪЕДИНИТЬ
|
|ВЫБРАТЬ
|	Тур11.НачалоИнтервала,
|	Тур11.КонецИнтервала
|ИЗ
|	Тур11 КАК Тур11
|ГДЕ
|	Тур11.НачалоИнтервала < Тур11.КонецИнтервала
|
|ОБЪЕДИНИТЬ
|
|ВЫБРАТЬ
|	Тур12.НачалоИнтервала,
|	Тур12.КонецИнтервала
|ИЗ
|	Тур12 КАК Тур12
|ГДЕ
|	Тур12.НачалоИнтервала < Тур12.КонецИнтервала
|
|ОБЪЕДИНИТЬ
|
|ВЫБРАТЬ
|	Тур13.НачалоИнтервала,
|	Тур13.КонецИнтервала
|ИЗ
|	Тур13 КАК Тур13
|ГДЕ
|	Тур13.НачалоИнтервала < Тур13.КонецИнтервала
|
|ОБЪЕДИНИТЬ
|
|ВЫБРАТЬ
|	Тур14.НачалоИнтервала,
|	Тур14.КонецИнтервала
|ИЗ
|	Тур14 КАК Тур14
|ГДЕ
|	Тур14.НачалоИнтервала < Тур14.КонецИнтервала
|
|ОБЪЕДИНИТЬ
|
|ВЫБРАТЬ
|	Тур15.НачалоИнтервала,
|	Тур15.КонецИнтервала
|ИЗ
|	Тур15 КАК Тур15
|ГДЕ
|	Тур15.НачалоИнтервала < Тур15.КонецИнтервала
|
|ОБЪЕДИНИТЬ
|
|ВЫБРАТЬ
|	Тур16.НачалоИнтервала,
|	Тур16.КонецИнтервала
|ИЗ
|	Тур16 КАК Тур16
|ГДЕ
|	Тур16.НачалоИнтервала < Тур16.КонецИнтервала
|
|ОБЪЕДИНИТЬ
|
|ВЫБРАТЬ
|	Тур17.НачалоИнтервала,
|	Тур17.КонецИнтервала
|ИЗ
|	Тур17 КАК Тур17
|ГДЕ
|	Тур17.НачалоИнтервала < Тур17.КонецИнтервала
|
|ОБЪЕДИНИТЬ
|
|ВЫБРАТЬ
|	Тур18.НачалоИнтервала,
|	Тур18.КонецИнтервала
|ИЗ
|	Тур18 КАК Тур18
|ГДЕ
|	Тур18.НачалоИнтервала < Тур18.КонецИнтервала
|
|ОБЪЕДИНИТЬ
|
|ВЫБРАТЬ
|	Тур19.НачалоИнтервала,
|	Тур19.КонецИнтервала
|ИЗ
|	Тур19 КАК Тур19
|ГДЕ
|	Тур19.НачалоИнтервала < Тур19.КонецИнтервала
|
|ОБЪЕДИНИТЬ
|
|ВЫБРАТЬ
|	Тур20.НачалоИнтервала,
|	Тур20.КонецИнтервала
|ИЗ
|	Тур20 КАК Тур20
|ГДЕ
|	Тур20.НачалоИнтервала < Тур20.КонецИнтервала
|
|ОБЪЕДИНИТЬ
|
|ВЫБРАТЬ
|	Тур21.НачалоИнтервала,
|	Тур21.КонецИнтервала
|ИЗ
|	Тур21 КАК Тур21
|ГДЕ
|	Тур21.НачалоИнтервала < Тур21.КонецИнтервала
|
|ОБЪЕДИНИТЬ
|
|ВЫБРАТЬ
|	Тур22.НачалоИнтервала,
|	Тур22.КонецИнтервала
|ИЗ
|	Тур22 КАК Тур22
|ГДЕ
|	Тур22.НачалоИнтервала < Тур22.КонецИнтервала
|
|ОБЪЕДИНИТЬ
|
|ВЫБРАТЬ
|	Тур23.НачалоИнтервала,
|	Тур23.КонецИнтервала
|ИЗ
|	Тур23 КАК Тур23
|ГДЕ
|	Тур23.НачалоИнтервала < Тур23.КонецИнтервала
|
|ОБЪЕДИНИТЬ
|
|ВЫБРАТЬ
|	Тур24.НачалоИнтервала,
|	Тур24.КонецИнтервала
|ИЗ
|	Тур24 КАК Тур24
|ГДЕ
|	Тур24.НачалоИнтервала < Тур24.КонецИнтервала
|
|ОБЪЕДИНИТЬ
|
|ВЫБРАТЬ
|	Тур25.НачалоИнтервала,
|	Тур25.КонецИнтервала
|ИЗ
|	Тур25 КАК Тур25
|ГДЕ
|	Тур25.НачалоИнтервала < Тур25.КонецИнтервала
|
|ОБЪЕДИНИТЬ
|
|ВЫБРАТЬ
|	Тур26.НачалоИнтервала,
|	Тур26.КонецИнтервала
|ИЗ
|	Тур26 КАК Тур26
|ГДЕ
|	Тур26.НачалоИнтервала < Тур26.КонецИнтервала
|
|ОБЪЕДИНИТЬ
|
|ВЫБРАТЬ
|	Тур27.НачалоИнтервала,
|	Тур27.КонецИнтервала
|ИЗ
|	Тур27 КАК Тур27
|ГДЕ
|	Тур27.НачалоИнтервала < Тур27.КонецИнтервала
|
|ОБЪЕДИНИТЬ
|
|ВЫБРАТЬ
|	Тур28.НачалоИнтервала,
|	Тур28.КонецИнтервала
|ИЗ
|	Тур28 КАК Тур28
|ГДЕ
|	Тур28.НачалоИнтервала < Тур28.КонецИнтервала
|
|ОБЪЕДИНИТЬ
|
|ВЫБРАТЬ
|	Тур29.НачалоИнтервала,
|	Тур29.КонецИнтервала
|ИЗ
|	Тур29 КАК Тур29
|ГДЕ
|	Тур29.НачалоИнтервала < Тур29.КонецИнтервала
|
|ОБЪЕДИНИТЬ
|
|ВЫБРАТЬ
|	Тур30.НачалоИнтервала,
|	Тур30.КонецИнтервала
|ИЗ
|	Тур30 КАК Тур30
|ГДЕ
|	Тур30.НачалоИнтервала < Тур30.КонецИнтервала
|
|ОБЪЕДИНИТЬ
|
|ВЫБРАТЬ
|	Тур31.НачалоИнтервала,
|	Тур31.КонецИнтервала
|ИЗ
|	Тур31 КАК Тур31
|ГДЕ
|	Тур31.НачалоИнтервала < Тур31.КонецИнтервала
|
|ОБЪЕДИНИТЬ
|
|ВЫБРАТЬ
|	Тур32.НачалоИнтервала,
|	Тур32.КонецИнтервала
|ИЗ
|	Тур32 КАК Тур32
|ГДЕ
|	Тур32.НачалоИнтервала < Тур32.КонецИнтервала
|;
|
|////////////////////////////////////////////////////////////////////////////////
|ВЫБРАТЬ
|	ВТРезультат.НачалоИнтервала,
|	ВТРезультат.КонецИнтервала,
|	ВТРезультат.КонецИнтервала - ВТРезультат.НачалоИнтервала КАК Разница
|ИЗ
|	ВТРезультат КАК ВТРезультат
|ГДЕ
|	ВТРезультат.КонецИнтервала - ВТРезультат.НачалоИнтервала > 1"}
},
{0,
{"Падежи",0,0,"","// (c) Jurer Production Begin ( Start )
 
// В случае, если программа окажется для Вас полезной, и Вы представляете только свои интересы, а не интересы фирмы,
 
// автор будет весьма признателен, если Вы перечислите ему, то есть мне, некую сумму на Ваше усмотрение
 
// Счет для я-деньги: 4100131343416 - будьте ж несдержаней в своих инициативах
 
// 
 
// http://superjur.narod.ru
 
// 
 
// Удаление этих строк незнаконно!
 
// Гарантия 91 года и 1 месяц!!!
 
// Послегарантийное обслуживание - бесплатно!!!
 
// Круглосуточная поддержка - все 48 часов в бою!
 
// Ссылка на источник обязательна!
 
// Эти программы защищены законом об авторских правах. Запрещается перепродажа данной программы. Продажа тоже запрещена.
 
// ПРОВЕРЕНО! ВИРУСОВ НЕТ!!! АНТИВИРУСОВ ТОЖЕ!!!
 
// Смотри Милячуша в творительном !!
 
// скупой слепой тупой - пропой!!
 
// !№№!
 
// !57! поправки для творительного падежа на -ин -ов окончание -ым, -ич -ыш окончание -ем, иначе -ом
 
// !56! укратил
 
// !55! ПадежЫ - для оглы и кызы
 
// !54! 
 
// !53! Очередное сокращение кода
 
// !51! Прегромадное спасибо Олегу Дубровскому за оказанную моральную, информационную и материальную поддержку сего проекта.
 
//      Сергею Толкачёву за напоминание о том, что в русском языке всегда есть место исключениям!
 
// !50! П:Ответственный за электрохозяйство  Ф:Ацута Груша  
 
// !48! исправлена ошибка при склонении фамилий (спасибо, Mario).
 
// !47! исправлена ошибка при склонении профессий ( спасибо, Павел Ковалев).
 
// !46! оптимизация + четвертый параметр задает, что вернуть - фамилия, имя или отчество или всё сразу в нужном падеже
 
// !42! Осел + Соловей + Воробей + Немец + Кормилец + Силиец
 
// !41! отчества оканчивающиеся на ""ы"" считаются женскими ?
 
// Функция для склонения одного слова!!!
 
// z1 - само слово
 
// z2 - номер падежа
 
// z3 - пол
 
// z4 - 1-склонять как фамилию, 2-имя, 3-отчество
 
Функция ПадежС(z1,Знач z2=2,Знач z3=""*"",z4=0) Экспорт
  z5=Найти(z1,""-"");
  z6=?(z5=0,"""",""-""+ПадежС(Сред(z1,z5+1,СтрДлина(z1)-z5+1),z2,z3,z4));
  z1=НРег(?(z5=0,z1,Лев(z1,z5-1)));
  z7=Прав(z1,3);z8=Прав(z7,2);z9=Прав(z8,1);
  z5=СтрДлина(z1);
  za=Найти(""ая ия ел ок яц ий па да ца ша ба та га ка"",z8);
  zb=Найти(""аеёийоуэюяжнгхкчшщ"",Лев(z7,1));
  zc=Макс(z2,-z2);
  zd=?(za=4,5,Найти(""айяь"",z9));
  zd=?((zc=1)или(z9=""."")или((z4=2)и(Найти(""оиеу""+?(z3=""ч"","""",""бвгджзклмнпрстфхцчшщъ""),z9)>0))или((z4=1)и(Найти(""мия мяэ лия кия жая лея"",z7)>0)),9,?((zd=4)и(z3=""ч""),2,?(z4=1,?(Найти(""оеиую"",z9)+Найти(""их ых аа еа ёа иа оа уа ыа эа юа яа"",z8)>0,9,?(z3<>""ч"",?(za=1,7,?(z9=""а"",?(za>18,1,6),9)),?(((Найти(""ой ый"",z8)>0)и(z5>4)и(Найти(""опой вбой"",Прав(z1,4))=0))или((zb>10)и(za=16)),8,zd))),zd)));
  ze=Найти(""лец нёк вей бей дец пец мец нец рец вец аец иец ыец бер"",z7);
  zf=?((zd=8)и(zc<>5),?((zb>15)или(Найти(""жий ний"",z7)>0),""е"",""о""),?(z1=""лев"",""ьв"",?((Найти(""аеёийоуэюя"",Сред(z1,z5-3 ,1))=0)и((zb>11)или(zb=0))и(ze<>49),"""",?(za=7,""л"",?(za=10,""к"",?(za=13,""йц"",?(ze=0,"""",?(ze<16,""ь""+?(ze=1,""ц"",?(ze=5,""к"","""")),?(ze<41,""ц"",?(ze<53,""йц"",""р""))))))))));
  zf=?((zd=9)или((z4=3)и(Прав(z1,1)=""ы"")),z1,Лев(z1,z5-?((zd>6)или(zf<>""""),2,?(zd>0,1,0)))+zf+СокрП(Сред(""а у а ""+?((z8=""ич"")или(z8=""ыш""),""е"",?((z8=""ов"")or(z8=""ин""),""ы"",""о""))+""ме ""+?(Найти(""гжкхш"",Лев(z8,1))>0,""и"",""ы"")+"" е у ойе я ю я ем""+?(za=16,""и"",""е"")+"" и е ю ейе и и ь ьюи и и ю ейи ойойу ойойойойуюойойгомуго""+?((zf=""е"")или(za=16)или((zb>12)и(zb<16)),""и"",""ы"")+""мм"",10*zd+2*zc-3,2)));
Возврат ?(""""=z1,"""",?(z4>0,ВРег(Лев(zf,1))+?((z2<0)и(z4>1),""."",Сред(zf,2)),zf)+z6);
КонецФункции
//_____________________________________________________________________________
 
// z1 - фамилия имя отчество например Железняков Юрий Юрьевич
 
// z2 - Падеж ( по  умолчанию = 2 - родительный)
 
// 2 - родительный  ( нет кого?    ) Железнякова Юрия Юрьевича     
 
// 3 - дательный    ( кому?        ) Железнякову Юрию Юрьевичу 
 
// 4 - винительный  ( вижу кого?   ) Железнякова Юрия Юрьевича  
 
// 5 - творительный ( кем?         ) Железняковым Юрием Юрьевичем    
 
// 6 - предложный   ( о ком?       ) Железнякове Юрии Юрьевиче 
 
// Если задать Z2 меньше 0, то на выходе получим от -1=Железняков Ю. Ю. до -6=Железнякове Ю. Ю.
 
// z3 - параметр Пол может не указываться, но при наличии фамилий с 
 
// инициалами точное определение пола невозможно, поэтому предлагается задавать пол этим
 
// параметром  1 - мужской 2 - женский  
 
// ДЛЯ СКЛОНЕНИЯ ПРОФЕССИЙ ИСПОЛЬЗУЙТЕ ФУНКЦИЮ ПАДЕЖП И БУДЕТ ВАМ СЧАСТЬЕ!
 
// ---------------------------------------------------------------------------------------
 
// Бибик Галушка Цой Николайчик Наталия Петровна Герценберг Кривошей Капица-Метелица
 
// Если Падеж(Фио ,1 ,3),       то на выходе получим Фамилия Имя Отчество и т.д.
 
// Если Падеж(Фио ,1 ,3,""1"" ),  то                   Фамилия 
 
// Если Падеж(Фио ,1 ,3,""2"" ),  то                   Имя 
 
// Если Падеж(Фио ,1 ,3,""3"" ),  то                   Отчество 
 
// Если Падеж(Фио, 1 ,3,""12"" ), то                   Фамилия Имя 
 
// Если Падеж(Фио, 1 ,3,""23"" ), то                   Имя Отчество 
 
// Если Падеж(Фио,-1 ,3,""231"" ),то                   И. О. Фамилия 
 
// Если Падеж(Фио,-1 ,3,""23"" ), то                   И. О.  
 
// 10-11-2003 3-20
 
Функция Падеж(z1,z2=2,z3=3,z4=""123"",z5=1) Экспорт
    z6=Нрег(Прав(СокрП(z1),4));
    z7=Прав(z6,1);
  Возврат?(z5<4,Падеж(СокрЛП(СтрЗаменить(Сред(z1,Найти(z1+"" "","" "")+1),""."","". "")),z2,z3,СтрЗаменить(z4,z5,ПадежС(?((z5=3)и(z7=""ы""),z1,Лев(z1,Найти(z1+"" "","" "")-1)),z2,Сред(""ча""+z7,?(z3=3,?(z6=""оглы"",1,?(z6=""кызы"",1,3)),z3),1),z5)+"" ""),z5+1),z4);
КонецФункции

Функция ПадежП(Знач z1,Знач z2,z3=0) Экспорт
  z1=СокрЛП(z1);z4=Найти(z1+"" "","" "")+1;z5=Лев(z1,z4-2);z6=Прав(z5,2);
  z7=?((Найти(""ая ий ый"",z6)>0)и(Найти(""ющий нный"",Сред(z1,z4-5,4))=0)и(z3=0),""1"",""*"");
Возврат НРег(?((z6=""ая"")или(Прав(z6,1)=""а""),ПадежС(z5,z2,z7,1)+"" ""+ПадежС(Сред(z1,z4),z2),ПадежС(z5,z2,""ч"",1)+?((z6=""ий"")и(Найти(z1,"" "")=0),"""","" ""+?(z7=""1"",ПадежП(Сред(z1,z4),z2,Число(z7)),Сред(z1,z4)))));
КонецФункции
"}
},
{0,
{"ЗапросЧерезCOM",0,0,"","V8Запрос = Соединение.NewObject(""Запрос"");"}
},
{0,
{"КешПоиска",0,0,"","Перем мТЗПоискКэш Экспорт;

#Область ПоискИРаботаСКэшем
Процедура СоздатьСтруктурумТЗПоискКэш() 
	мТЗПоискКэш = Новый ТаблицаЗначений();
	мТЗПоискКэш.Колонки.Добавить(""МетаданныеИмя"");
	мТЗПоискКэш.Колонки.Добавить(""Код"");
	мТЗПоискКэш.Колонки.Добавить(""фнмКодДляСинхронизации"");
	мТЗПоискКэш.Колонки.Добавить(""Наименование"");
	мТЗПоискКэш.Колонки.Добавить(""ЭтоГруппа"");
	мТЗПоискКэш.Колонки.Добавить(""Ссылка"");
	мТЗПоискКэш.Колонки.Добавить(""ДатаНачала"");
	
	мТЗПоискКэш.Индексы.Добавить(""МетаданныеИмя"");
КонецПроцедуры //Получить

Функция ПолучитьЗначениеИзКэша(МетаданныеИмя,ПараметрыПоиска) 
	РезультатФункции = Новый Структура();
	пЗначениеИзКэша = Неопределено;
	ЭтоЗначениеИзКэша = Ложь;	
	ПараметрыОтбора=Новый Структура();
	ПараметрыОтбора.Вставить(""МетаданныеИмя"",МетаданныеИмя);
	ПараметрыПойскаСтрока = """";
	Для каждого СтрокаПараметрыПоиска из ПараметрыПоиска цикл
		ПараметрыОтбора.Вставить(СтрокаПараметрыПоиска.Ключ,СтрокаПараметрыПоиска.Значение);
		ПараметрыПойскаСтрока = ПараметрыПойскаСтрока + """" +СтрокаПараметрыПоиска.Ключ + "" [""+СтрокаПараметрыПоиска.Значение+""]"";
	Конеццикла;
	НайденныеСтроки = мТЗПоискКэш.НайтиСтроки(ПараметрыОтбора);
	Если НайденныеСтроки.Количество()=1 тогда
		пЗначениеИзКэша = НайденныеСтроки[0].Ссылка;
		ЭтоЗначениеИзКэша = Истина;
	ИначеЕсли НайденныеСтроки.Количество()>1 Тогда
		Сообщить(""Ошибка! Найдено более 1 значения в кэше МетаданныеИмя [""+МетаданныеИмя+""] по указанным параметрам поиска""
			+"" ""+ПараметрыПойскаСтрока);
	Иначе
		//Сообщить(""Не найден "");		
	Конецесли;
	РезультатФункции.Вставить(""ЭтоЗначениеИзКэша"",ЭтоЗначениеИзКэша);
	РезультатФункции.Вставить(""ЗначениеИзКэша"",пЗначениеИзКэша);
	Возврат РезультатФункции;	
КонецФункции //ПолучитьЗначениеИзКэша(ДопПараметры)

Процедура ДобавитьЗначениеВКэш(СсылкаНаОбъект,МетаданныеИмя,ПараметрыПоиска) 
	СтрокамТЗПоискКэш = мТЗПоискКэш.Добавить();
	ЗаполнитьЗначенияСвойств(СтрокамТЗПоискКэш,ПараметрыПоиска);
	СтрокамТЗПоискКэш.Ссылка = СсылкаНаОбъект;
	СтрокамТЗПоискКэш.МетаданныеИмя = МетаданныеИмя;
КонецПроцедуры //ДобавитьЗначениеВКэш(Справочники.Модели.ПустаяСсылка(),""Модели"",ПараметрыПоиска)

Функция ПолучитьСсылкуНаОбъект(МетаданныеИмя,КлючПоиска,ЗначениеДляПоиска)  
	пСсылкаНаОбъект = Неопределено;

	ПараметрыПоиска = Новый Структура();
	ПараметрыПоиска.Вставить(КлючПоиска,ЗначениеДляПоиска);
	РезультатФункции = ПолучитьЗначениеИзКэша(МетаданныеИмя,ПараметрыПоиска);	
	Если РезультатФункции.ЭтоЗначениеИзКэша Тогда
		пСсылкаНаОбъект = РезультатФункции.ЗначениеИзКэша;
		Возврат пСсылкаНаОбъект;
	Конецесли;
	Если НЕ ЗначениеЗаполнено(ЗначениеДляПоиска) Тогда
		ДобавитьЗначениеВКэш(пСсылкаНаОбъект,МетаданныеИмя,ПараметрыПоиска);		
		Возврат пСсылкаНаОбъект;
	Конецесли;
	
	Запрос = Новый Запрос;
	Запрос.Текст = ПолучитьТекстЗапросаДляПоиска(МетаданныеИмя);	 
	Запрос.УстановитьПараметр(КлючПоиска, ЗначениеДляПоиска);
	РезультатЗапроса = Запрос.Выполнить();

	пСсылкаНаОбъект = ПолучитьЗначениеИзЗапроса(РезультатЗапроса,МетаданныеИмя,ПараметрыПоиска);
	Возврат пСсылкаНаОбъект;
	
КонецФункции //ПолучитьСсылкуНаОбъект()

Функция ПолучитьТекстЗапросаДляПоиска(МетаданныеИмя)  
	ТекстЗапроса = Неопределено;
	Если МетаданныеИмя = ""Периоды"" Тогда
		ТекстЗапроса = ""
		|ВЫБРАТЬ
		|	Периоды.Ссылка,
		|	Периоды.Наименование
		|ИЗ
		|	Справочник.Периоды КАК Периоды
		|ГДЕ
		|	Периоды.ДатаНачала = &ДатаНачала
		|	И Периоды.Периодичность = ЗНАЧЕНИЕ(Перечисление.Периодичность.Месяц)"";
		
	ИначеЕсли МетаданныеИмя = ""фнмСтатьиБюджета"" Тогда
		ТекстЗапроса = ""ВЫБРАТЬ
		|	фнмСтатьиБюджета.Ссылка,
		|	фнмСтатьиБюджета.Наименование
		|ИЗ
		|	Справочник.фнмСтатьиБюджета КАК фнмСтатьиБюджета
		|ГДЕ
		|	фнмСтатьиБюджета.фнмКодДляСинхронизации = &фнмКодДляСинхронизации"";	
	ИначеЕсли МетаданныеИмя = ""Организации"" Тогда
		ТекстЗапроса = ""ВЫБРАТЬ
		|	Организации.Ссылка,
		|	Организации.Наименование
		|ИЗ
		|	Справочник.Организации КАК Организации
		|ГДЕ
		|	Организации.фнмКодДляСинхронизации = &фнмКодДляСинхронизации"";				
	Иначе		
		ВызватьИсключение ""Ошибка! Нет текста запроса для поиска""+МетаданныеИмя;
	Конецесли;
	Возврат ТекстЗапроса;	
КонецФункции //ПолучитьТекстЗапросаДляПоиска()

Функция ПолучитьЗначениеИзЗапроса(РезультатЗапроса,МетаданныеИмя,ПараметрыПоиска)  
	пЗначениеИзЗапроса = Неопределено;
	Выборка = РезультатЗапроса.Выбрать();
	ВыборкаКоличество = Выборка.Количество();
	Если ВыборкаКоличество = 0 Тогда		
		ДобавитьЗначениеВКэш(Неопределено,МетаданныеИмя,ПараметрыПоиска);
		ТекстОшибки = ""ВНИМАНИЕ! Не найдена ""+МетаданныеИмя + Символы.ПС;
		Для каждого ЭлПараметрыПоиска из ПараметрыПоиска цикл
			ТекстОшибки = ТекстОшибки + "" - Ключ ""+ЭлПараметрыПоиска.Ключ + "" Значение [""+ЭлПараметрыПоиска.Значение+""]"" + Символы.ПС;
		Конеццикла;
		Сообщить(ТекстОшибки);
	ИначеЕсли ВыборкаКоличество > 1 Тогда
		ТекстОшибки = ""ВНИМАНИЕ! Найдено более 1 ""+МетаданныеИмя + Символы.ПС;
		Для каждого ЭлПараметрыПоиска из ПараметрыПоиска цикл
			ТекстОшибки = ТекстОшибки + "" - Ключ ""+ЭлПараметрыПоиска.Ключ + "" Значение [""+ЭлПараметрыПоиска.Значение+""]"" + Символы.ПС;
		Конеццикла;
		Сообщить(ТекстОшибки);
		Пока Выборка.Следующий() Цикл
			ДобавитьЗначениеВКэш(Неопределено,МетаданныеИмя,ПараметрыПоиска);
		КонецЦикла;		
	Иначе
		Выборка.Следующий();
		пЗначениеИзЗапроса = Выборка.Ссылка;
		ДобавитьЗначениеВКэш(пЗначениеИзЗапроса,МетаданныеИмя,ПараметрыПоиска);
	Конецесли;
	Возврат пЗначениеИзЗапроса;
КонецФункции //ПолучитьЗначениеИзЗапроса()

#КонецОбласти
"}
},
{0,
{"КешПоиска v2",0,0,"","Перем мТЗПоискКэш;

#Область ПоискИРаботаСКэшем
Процедура СоздатьСтруктурумТЗПоискКэш() 
	мТЗПоискКэш = Новый ТаблицаЗначений();
	мТЗПоискКэш.Колонки.Добавить(""МетаданныеИмя"");
	мТЗПоискКэш.Колонки.Добавить(""Код"");
	мТЗПоискКэш.Колонки.Добавить(""УИД"");
	мТЗПоискКэш.Колонки.Добавить(""Наименование"");
	мТЗПоискКэш.Колонки.Добавить(""ЭтоГруппа"");
	мТЗПоискКэш.Колонки.Добавить(""Ссылка"");
	
	мТЗПоискКэш.Индексы.Добавить(""МетаданныеИмя"");
КонецПроцедуры //Получить

Функция ПолучитьЗначениеИзКэша(МетаданныеИмя,ПараметрыПоиска) 
	РезультатФункции = Новый Структура();
	пЗначениеИзКэша = Неопределено;
	ЭтоЗначениеИзКэша = Ложь;	
	ПараметрыОтбора=Новый Структура();
	ПараметрыОтбора.Вставить(""МетаданныеИмя"",МетаданныеИмя);
	ПараметрыПойскаСтрока = """";
	Для каждого СтрокаПараметрыПоиска из ПараметрыПоиска цикл
		ПараметрыОтбора.Вставить(СтрокаПараметрыПоиска.Ключ,СтрокаПараметрыПоиска.Значение);
		ПараметрыПойскаСтрока = ПараметрыПойскаСтрока + """" +СтрокаПараметрыПоиска.Ключ + "" [""+СтрокаПараметрыПоиска.Значение+""]"";
	Конеццикла;
	НайденныеСтроки = мТЗПоискКэш.НайтиСтроки(ПараметрыОтбора);
	Если НайденныеСтроки.Количество()=1 тогда
		пЗначениеИзКэша = НайденныеСтроки[0].Ссылка;
		ЭтоЗначениеИзКэша = Истина;
	ИначеЕсли НайденныеСтроки.Количество()>1 Тогда
		
		ТекстСообщения = НСтр(""ru = 'Ошибка! Найдено более 1 значения в кэше МетаданныеИмя [%1] по указанным параметрам поиска ""
			+ ПараметрыПойскаСтрока + ""'"");
		ТекстСообщения = СтрШаблон(ТекстСообщения,МетаданныеИмя);
		
		Сообщение = Новый СообщениеПользователю;
		Сообщение.Текст = """" + ТекстСообщения;
		Сообщение.Сообщить();		
		
		ДобавитьЗаписьВЖурналРегистрации(ТекстСообщения,ИмяСобытияДляЖР(),УровеньЖурналаРегистрации.Ошибка);
	Иначе
		//Сообщить(""Не найден "");		
	Конецесли;
	РезультатФункции.Вставить(""ЭтоЗначениеИзКэша"",ЭтоЗначениеИзКэша);
	РезультатФункции.Вставить(""ЗначениеИзКэша"",пЗначениеИзКэша);
	Возврат РезультатФункции;	
КонецФункции //ПолучитьЗначениеИзКэша(ДопПараметры)

Процедура ДобавитьЗначениеВКэш(СсылкаНаОбъект,МетаданныеИмя,ПараметрыПоиска) 
	СтрокамТЗПоискКэш = мТЗПоискКэш.Добавить();
	ЗаполнитьЗначенияСвойств(СтрокамТЗПоискКэш,ПараметрыПоиска);
	СтрокамТЗПоискКэш.Ссылка = СсылкаНаОбъект;
	СтрокамТЗПоискКэш.МетаданныеИмя = МетаданныеИмя;
КонецПроцедуры //ДобавитьЗначениеВКэш(Справочники.Модели.ПустаяСсылка(),""Модели"",ПараметрыПоиска)

// { АЛП Иванов А.Б., 17.01.2020 14:52  Модуль Казначейство
Процедура ИзменитьЗначениеВКэше(СсылкаНаОбъект,МетаданныеИмя,ПараметрыПоиска)
	
	РезультатФункции = Новый Структура();
	ПараметрыОтбора=Новый Структура();
	ПараметрыОтбора.Вставить(""МетаданныеИмя"",МетаданныеИмя);
	ПараметрыПойскаСтрока = """";
	Для каждого СтрокаПараметрыПоиска из ПараметрыПоиска цикл
		ПараметрыОтбора.Вставить(СтрокаПараметрыПоиска.Ключ,СтрокаПараметрыПоиска.Значение);
		ПараметрыПойскаСтрока = ПараметрыПойскаСтрока + """" +СтрокаПараметрыПоиска.Ключ + "" [""+СтрокаПараметрыПоиска.Значение+""]"";
	Конеццикла;
	
	НайденныеСтроки = мТЗПоискКэш.НайтиСтроки(ПараметрыОтбора);
	Если НайденныеСтроки.Количество()=1 тогда
		СтрокаВКэше = НайденныеСтроки[0];
		СтрокаВКэше.Ссылка = СсылкаНаОбъект;
	ИначеЕсли НайденныеСтроки.Количество()>1 Тогда
		ТекстСообщения = НСтр(""ru = 'Ошибка! Найдено более 1 значения в кэше МетаданныеИмя [%1] по указанным параметрам поиска ""
			+ ПараметрыПойскаСтрока + ""'"");
		ТекстСообщения = СтрШаблон(ТекстСообщения,МетаданныеИмя);
		
		Сообщение = Новый СообщениеПользователю;
		Сообщение.Текст = """" + ТекстСообщения;
		Сообщение.Сообщить();		
		
		ДобавитьЗаписьВЖурналРегистрации(ТекстСообщения,ИмяСобытияДляЖР(),УровеньЖурналаРегистрации.Ошибка);	Иначе
		//Сообщить(""Не найден "");		
	Конецесли;
	
КонецПроцедуры 
// } АЛП Иванов А.Б., 17.01.2020 14:52  Модуль Казначейство 

Функция ПолучитьСсылкуНаОбъект(МетаданныеИмя,КлючПоиска,ЗначениеДляПоиска)  
	пСсылкаНаОбъект = Неопределено;

	ПараметрыПоиска = Новый Структура();
	ПараметрыПоиска.Вставить(КлючПоиска,ЗначениеДляПоиска);
	РезультатФункции = ПолучитьЗначениеИзКэша(МетаданныеИмя,ПараметрыПоиска);	
	Если РезультатФункции.ЭтоЗначениеИзКэша Тогда
		пСсылкаНаОбъект = РезультатФункции.ЗначениеИзКэша;
		Возврат пСсылкаНаОбъект;
	Конецесли;
	Если НЕ ЗначениеЗаполнено(ЗначениеДляПоиска) Тогда
		ДобавитьЗначениеВКэш(пСсылкаНаОбъект,МетаданныеИмя,ПараметрыПоиска);		
		Возврат пСсылкаНаОбъект;
	Конецесли;
	
	// { АЛП Иванов А.Б., 17.01.2020 11:57  Модуль Казначейство
	Если КлючПоиска = ""УИД"" Тогда
		Если МетаданныеИмя = ""АЛП_ЦФО"" Тогда
			УИД = Новый УникальныйИдентификатор(ЗначениеДляПоиска);
			пСсылкаНаОбъект = Справочники.АЛП_ЦФО.ПолучитьСсылку(УИД);
			
			Если НЕ ЗначениеЗаполнено(пСсылкаНаОбъект)
				ИЛИ пСсылкаНаОбъект.Пустая()
				ИЛИ пСсылкаНаОбъект.ПолучитьОбъект() = Неопределено Тогда
				пСсылкаНаОбъект = Неопределено;
				
				ТекстСообщения = НСтр(""ru = 'ВНИМАНИЕ! не удалось найти ЦФО по УИД [%1]'"");
				ТекстСообщения = СтрШаблон(ТекстСообщения,УИД);
				
				ДобавитьЗаписьВЖурналРегистрации(ТекстСообщения,ИмяСобытияДляЖР(),УровеньЖурналаРегистрации.Ошибка);
				
				Сообщение = Новый СообщениеПользователю;
				Сообщение.Текст = ТекстСообщения;
				Сообщение.Сообщить();
				
			Конецесли;
			
			ДобавитьЗначениеВКэш(пСсылкаНаОбъект,МетаданныеИмя,ПараметрыПоиска);	
			
			Возврат пСсылкаНаОбъект;
		Иначе
			ТекстСообщения = НСтр(""ru = 'Ошибка! Нет алгоритма поиска для КлючПоиска [%1] МетаданныеИмя [%2] '"");
			ТекстСообщения = СтрШаблон(ТекстСообщения,КлючПоиска,МетаданныеИмя);
			ДобавитьЗаписьВЖурналРегистрации(ТекстСообщения,ИмяСобытияДляЖР(),УровеньЖурналаРегистрации.Ошибка);
			ВызватьИсключение ТекстСообщения; 
		Конецесли;
	Конецесли;
	// } АЛП Иванов А.Б., 17.01.2020 11:57  Модуль Казначейство 
	
	Запрос = Новый Запрос;
	Запрос.Текст = ПолучитьТекстЗапросаДляПоиска(МетаданныеИмя);	 
	Запрос.УстановитьПараметр(КлючПоиска, ЗначениеДляПоиска);
	РезультатЗапроса = Запрос.Выполнить();

	пСсылкаНаОбъект = ПолучитьЗначениеИзЗапроса(РезультатЗапроса,МетаданныеИмя,ПараметрыПоиска);
	Возврат пСсылкаНаОбъект;
	
КонецФункции //ПолучитьСсылкуНаОбъект()

Функция ПолучитьТекстЗапросаДляПоиска(МетаданныеИмя)  
	ТекстЗапроса = Неопределено;
	Если МетаданныеИмя = ""АЛП_ЦФО"" Тогда
		ТекстЗапроса = ""
		|ВЫБРАТЬ
		|	АЛП_ЦФО.Ссылка
		|ИЗ
		|	Справочник.АЛП_ЦФО КАК АЛП_ЦФО
		|ГДЕ
		|	АЛП_ЦФО.Код = &Код
		|"";
	ИначеЕсли МетаданныеИмя = ""Проекты"" Тогда
		ТекстЗапроса = ""ВЫБРАТЬ
		|	Проекты.Ссылка КАК Ссылка
		|ИЗ
		|	Справочник.Проекты КАК Проекты
		|ГДЕ
		|	Проекты.Код = &Код"";
	
	Иначе		
		ТекстСообщения = НСтр(""ru = 'Ошибка! Нет текста запроса для поиска МетаданныеИмя [%1] '"");
		ТекстСообщения = СтрШаблон(ТекстСообщения,МетаданныеИмя);
		ДобавитьЗаписьВЖурналРегистрации(ТекстСообщения,ИмяСобытияДляЖР(),УровеньЖурналаРегистрации.Ошибка);
		ВызватьИсключение ТекстСообщения;
	Конецесли;
	Возврат ТекстЗапроса;	
КонецФункции //ПолучитьТекстЗапросаДляПоиска()

Функция ПолучитьЗначениеИзЗапроса(РезультатЗапроса,МетаданныеИмя,ПараметрыПоиска)  
	пЗначениеИзЗапроса = Неопределено;
	Выборка = РезультатЗапроса.Выбрать();
	ВыборкаКоличество = Выборка.Количество();
	Если ВыборкаКоличество = 0 Тогда		
		ДобавитьЗначениеВКэш(Неопределено,МетаданныеИмя,ПараметрыПоиска);
		
		ТекстСообщения = ""ru = 'ВНИМАНИЕ! Не найдена [%1] "";		
		Для каждого ЭлПараметрыПоиска из ПараметрыПоиска цикл
			ТекстСообщения = ТекстСообщения 
				+ "" - Ключ ""+ЭлПараметрыПоиска.Ключ 
				+ "" Значение [""+ЭлПараметрыПоиска.Значение+""]"" 
				+ Символы.ПС;
		Конеццикла;
			
		ТекстСообщения = ТекстСообщения + ""'"";
		ТекстСообщения = НСтр(ТекстСообщения);
		ТекстСообщения = СтрШаблон(ТекстСообщения,МетаданныеИмя);
		
		Сообщение = Новый СообщениеПользователю;
		Сообщение.Текст = ТекстСообщения;
		Сообщение.Сообщить();
		
		ДобавитьЗаписьВЖурналРегистрации(ТекстСообщения,ИмяСобытияДляЖР(),УровеньЖурналаРегистрации.Ошибка);
		
	ИначеЕсли ВыборкаКоличество > 1 Тогда
		
		ТекстСообщения = ""ru = 'ВНИМАНИЕ! Найдено более 1 [%1] "";		
		Для каждого ЭлПараметрыПоиска из ПараметрыПоиска цикл
			ТекстСообщения = ТекстСообщения 
				+ "" - Ключ ""+ЭлПараметрыПоиска.Ключ 
				+ "" Значение [""+ЭлПараметрыПоиска.Значение+""]"" 
				+ Символы.ПС;
		Конеццикла;
		ТекстСообщения = ТекстСообщения + ""'"";	
		ТекстСообщения = НСтр(ТекстСообщения);
		ТекстСообщения = СтрШаблон(ТекстСообщения,МетаданныеИмя);
		
		Сообщение = Новый СообщениеПользователю;
		Сообщение.Текст = ТекстСообщения;
		Сообщение.Сообщить();

		ДобавитьЗаписьВЖурналРегистрации(ТекстСообщения,ИмяСобытияДляЖР(),УровеньЖурналаРегистрации.Ошибка);
		
		Пока Выборка.Следующий() Цикл
			ДобавитьЗначениеВКэш(Неопределено,МетаданныеИмя,ПараметрыПоиска);
		КонецЦикла;		
	Иначе
		Выборка.Следующий();
		пЗначениеИзЗапроса = Выборка.Ссылка;
		ДобавитьЗначениеВКэш(пЗначениеИзЗапроса,МетаданныеИмя,ПараметрыПоиска);
	Конецесли;
	Возврат пЗначениеИзЗапроса;
КонецФункции //ПолучитьЗначениеИзЗапроса()

Функция ПеременнаяСодержитСвойство(Переменная, ИмяСвойства) 
	ПеременнаяСодержитСвойство = Ложь; 
	
	Если Переменная = Неопределено Тогда 
		Возврат ПеременнаяСодержитСвойство; 
	КонецЕсли;
	
	СтруктураПроверка = Новый Структура;
	СтруктураПроверка.Вставить(ИмяСвойства, NULL); 
	ЗаполнитьЗначенияСвойств(СтруктураПроверка, Переменная);
	
	Если СтруктураПроверка[ИмяСвойства] <> NULL Тогда 
		ПеременнаяСодержитСвойство = Истина; 
	КонецЕсли; 
	
	Возврат ПеременнаяСодержитСвойство; 
КонецФункции


#КонецОбласти"}
},
{0,
{"ЗагрузкаДанныхИзМакета",0,0,"","Макет = ПолучитьМакет(""СоответствиеПолей_ЗагрузкаИзSalesPortal"");

Для НомерСтроки = 2 По Макет.ВысотаТаблицы Цикл
	ИмяПоляКлиенты = СокрЛП(Макет.Область(НомерСтроки,1).Текст);
	ИмяПоляГруппыКлиентов = СокрЛП(Макет.Область(НомерСтроки,2).Текст);
	ИмяПараметраФункции = СокрЛП(Макет.Область(НомерСтроки,3).Текст);
	
	СтрокаТЗСоответствиеИменПолейРодителейИДетей = ТЗСоответствиеИменПолейРодителейИДетей.Добавить();
	СтрокаТЗСоответствиеИменПолейРодителейИДетей.ИмяПоляКлиенты = ИмяПоляКлиенты;
	СтрокаТЗСоответствиеИменПолейРодителейИДетей.ИмяПоляГруппыКлиентов = ИмяПоляГруппыКлиентов;
	СтрокаТЗСоответствиеИменПолейРодителейИДетей.ИмяПараметраФункции = ИмяПараметраФункции;
	
КонецЦикла;
"}
},
{0,
{"РегламентныеЗадания",0,0,"","	СписокАдресовЭлектроннойПочты = Новый СписокЗначений();
	Для каждого ЭлМассиваКонтроллеровРегламентныхЗаданий из МассивКонтроллеровРегламентныхЗаданий цикл
		СписокАдресовЭлектроннойПочты.Добавить(ЭлМассиваКонтроллеровРегламентныхЗаданий);			
	Конеццикла;
	
	МассивОшибок = Новый Массив();
	Для каждого ЭлМассиваКонтролируемыхРегламентныхЗаданий из МассивКонтролируемыхРегламентныхЗаданий цикл
		ИмяРеглЗадания = ЭлМассиваКонтролируемыхРегламентныхЗаданий;
		Отбор = Новый Структура();
		Отбор.Вставить(""Метаданные"",ИмяРеглЗадания);
		Регламентные = РегламентныеЗадания.ПолучитьРегламентныеЗадания(Отбор);
		
		Для Каждого РеглЗадание из Регламентные Цикл
			Если НЕ РеглЗадание.Использование Тогда
				ТекстОшибки = ""Ошибка! отключено использование контролируемого регламентного задания [""+РеглЗадание.Наименование+""]""
					+"" Использование = Ложь"" ;
				МассивОшибок.Добавить(ТекстОшибки);
				Продолжить;
			Конецесли;
			ДолжноБытьВыполненоСегодня = Ложь;
			Расписание = РеглЗадание.Расписание;			
			ЗапускаетсяДнейВНеделю = Расписание.ДниНедели.Количество()+1;
			Если Расписание.ПериодПовтораДней = 1
				И ЗапускаетсяДнейВНеделю = 7 Тогда
				ДолжноБытьВыполненоСегодня = Истина;
			Иначе
				Если Расписание.ТребуетсяВыполнение(ДатаПроверки) Тогда
					ДолжноБытьВыполненоСегодня = Истина;
				Конецесли;
			Конецесли;
			Если НЕ ДолжноБытьВыполненоСегодня Тогда
				Продолжить;
			Конецесли;
			ПоследнееЗадание = РеглЗадание.ПоследнееЗадание;
			Если ПоследнееЗадание = Неопределено Тогда
				ТекстОшибки = ""Ошибка! не удалось получить последнее фоновое задание ""
					"" для регламентного задания [""+ИмяРеглЗадания+""]""
					+"" Это может быть следующее: "" + Символы.ПС
					+""1) в течении дня службу 1с перезапускали и список фоновых заданий очистился и это не ошибка;"" + Символы.ПС
					+""2) вообще отключены регламентные задания и это ошибка.""+ Символы.ПС
					+""3) не запускалось регламентное задания и это ошибка."";
				МассивОшибок.Добавить(ТекстОшибки);
				Продолжить;				
			КонецЕсли;
			СостояниеПоследнегоЗадания = ПоследнееЗадание.Состояние;
			Если СостояниеПоследнегоЗадания = СостояниеФоновогоЗадания.ЗавершеноАварийно Тогда
				ТекстОшибки = ""Ошибка! задание не выполнилось успешно. "" + Символы.ПС
					+"" регламентное задание [""+РеглЗадание.Наименование+""] ""
					+"" СостояниеПоследнегоЗадания [""+СостояниеПоследнегоЗадания+""]"";
				МассивОшибок.Добавить(ТекстОшибки);
				Продолжить;						
			Конецесли;
			ДатаНачалаПоследнегоЗадания = ПоследнееЗадание.Начало;
			ДатаЗавершенияПоследнегоЗадания = ПоследнееЗадание.Конец;
			
			Если СостояниеПоследнегоЗадания = СостояниеФоновогоЗадания.Активно Тогда
				ДлительностьВыполненияЧасов = Окр((ТекущаяДата() - ДатаНачалаПоследнегоЗадания)/3600,2);
				Если ДлительностьВыполненияЧасов > 3 Тогда
					ТекстОшибки = ""Ошибка! задание выполняется уже больше 3-х часов. ""
						+"" регламентное задание [""+РеглЗадание.Наименование+""] "" + Символы.ПС
						+"" ДатаНачалаПоследнегоЗадания [""+ДатаНачалаПоследнегоЗадания+""]"" + Символы.ПС
						+"" ДлительностьВыполненияЧасов [""+ДлительностьВыполненияЧасов+""]"";
					МассивОшибок.Добавить(ТекстОшибки);					
				Конецесли;
				Продолжить;						
			Конецесли;			
			
			Если НачалоДня(ДатаПроверки) <> НачалоДня(ДатаНачалаПоследнегоЗадания) Тогда
				ТекстОшибки = ""Ошибка! сегодня не выполнялось""
					+"" регламентное задание [""+РеглЗадание.Наименование+""] "" + Символы.ПС
					+"" ДатаНачалаПоследнегоЗадания [""+ДатаНачалаПоследнегоЗадания+""]"" + Символы.ПС
					+"" ДатаЗавершенияПоследнегоЗадания [""+ДатаЗавершенияПоследнегоЗадания+""]""
					;
				МассивОшибок.Добавить(ТекстОшибки);
				Продолжить;						
			Конецесли;
		КонецЦикла;
		
	Конеццикла;
"}
},
{0,
{"ПарсингТабличногоДокумента",0,0,"","Функция ПолучитьТаблицуВерсийИзТабличногоДокумента(ТабличныйДокумент)
		
	ТаблицаВерсий = Новый ТаблицаЗначений;
	ТаблицаВерсий.Колонки.Добавить(""НомерВерсии"", Новый ОписаниеТипов(""Число""));
	ТаблицаВерсий.Колонки.Добавить(""ИмяПользователя"", Новый ОписаниеТипов(""Строка""));
	ТаблицаВерсий.Колонки.Добавить(""ДатаСоздания"", Новый ОписаниеТипов(""Дата""));
	ТаблицаВерсий.Колонки.Добавить(""Комментарий"", Новый ОписаниеТипов(""Строка""));
	
	НачинаяСоСтроки = 1;
	Пока ТабличныйДокумент.ВысотаТаблицы >= НачинаяСоСтроки Цикл
		ОбластьПоиска = ТабличныйДокумент.Область(НачинаяСоСтроки,1,ТабличныйДокумент.ВысотаТаблицы,1);
		ОбластьРезультат = ТабличныйДокумент.НайтиТекст(""Версия:"",,ОбластьПоиска, Истина, Истина, Истина, Ложь); 		
		Если ОбластьРезультат <> Неопределено Тогда
			НоваяСтрока = ТаблицаВерсий.Добавить();
			НоваяСтрока.НомерВерсии = Число(ТабличныйДокумент.Область(ОбластьРезультат.Верх, 2).Текст);
			НоваяСтрока.ИмяПользователя = ТабличныйДокумент.Область(ОбластьРезультат.Верх + 1, 2).Текст;
			ДатаСоздания = ТабличныйДокумент.Область(ОбластьРезультат.Верх + 2, 2).Текст;
			ВремяСоздания = ТабличныйДокумент.Область(ОбластьРезультат.Верх + 3, 2).Текст;
			НоваяСтрока.ДатаСоздания = Дата(ДатаСоздания + "" "" + ВремяСоздания);
			НоваяСтрока.Комментарий = ТабличныйДокумент.Область(ОбластьРезультат.Верх + 4, 2).Текст;
			
			НачинаяСоСтроки = ОбластьРезультат.Верх + 5;
		Иначе
			Прервать;
	    КонецЕсли;
	КонецЦикла;
	
	Возврат ТаблицаВерсий;
		
КонецФункции
"}
},
{0,
{"РазностьДатВМесяцах",0,0,"","Функция РазностьДатМесяц(ДатаНачало,ДатаКонца)
   Возврат ?(НачалоМесяца(ДатаНачало) >= НачалоМесяца(ДатаКонца), 0, 1 + РазностьДатМесяц(ДатаНачало,НачалоМесяца(ДатаКонца)-1));
КонецФункции
"}
},
{0,
{"РезультатФункции",0,0,"Резу[льтат]","РезультатФункции = Новый Структура();
РезультатФункции.Вставить(""<?>"",);

Возврат РезультатФункции;"}
},
{0,
{"ПолучениеДействующихЗаписейВРС",0,0,"","|	И фнмПравилаПереносаВРегистрБюджеты.ДатаНачала <= &ПериодОтчетаДатаНачала
|	И (фнмПравилаПереносаВРегистрБюджеты.ДатаОкончания >= &ПериодОтчетаДатаНачала
|			ИЛИ фнмПравилаПереносаВРегистрБюджеты.ДатаОкончания = ДАТАВРЕМЯ(1, 1, 1))
"}
},
{0,
{"АльфаПраваНаСправочник",0,0,"","//МодульОбъекта

Перем Права Экспорт;


// Стандартный обработчик копирования объекта
Процедура ПриКопировании(ОбъектКопирования)	
	Если НЕ спПриКопировании(ЭтотОбъект, ОбъектКопирования) Тогда 
		Возврат; 
	КонецЕсли;
КонецПроцедуры


Процедура ПередЗаписью(Отказ)
	Если НЕ спПередЗаписью(ЭтотОбъект, Отказ) Тогда 
		Возврат; 
	КонецЕсли;
КонецПроцедуры

// Стандартный обработчик ПриЗаписи элемента справочника
Процедура ПриЗаписи(Отказ)		
	Если НЕ спПриЗаписи(ЭтотОбъект, Отказ) Тогда 
		Возврат; 
	КонецЕсли;
КонецПроцедуры

// Стандартный обработчик ПередУдалением элемента
Процедура ПередУдалением(Отказ)
	Если НЕ спПередУдалением(ЭтотОбъект, Отказ) Тогда Возврат; КонецЕсли;
КонецПроцедуры

// Проверяет корректность заполнения объекта.
// Возвращает Истина если все заполнено корректно и Ложь иначе.
// В случае некорректного заполнения формирует строку описанием возникших ошибок ""Ошибки""
// На вход может быть передана структура ДопРеквизиты с дополнительными реквизитами для проверки
// может управляться булевыми флагами выполняемых проверок Заполнение, Уникальность
// (могут быть и другие необязательные)
// Обычно выполняется универсальным обработчиком, но могут быть добавлены доп. проверки
//
// Параметры:
//  Ошибки 			– Строка		– Описание ошибок.
//  ДопРеквизиты	– Структура		– Дополнительные реквизиты для проверки.
//  Заполнение		– Булево		– Флаг для проверки заполнения.
//  Уникальность	– Булево		– Флаг для проверки уникальности.
//
// Возвращаемое значение:
//   Булево				   			– Правильность заполнения объекта.
//
Функция ПроверитьКорректность(Ошибки="""", ДопРеквизиты=Неопределено, Заполнение=Истина, Уникальность=Истина) Экспорт
	Возврат спПроверитьКорректность(ЭтотОбъект, Ошибки, ДопРеквизиты, Заполнение, Уникальность);
КонецФункции // ПроверитьКорректность()

// Возвращает структуру обязательных / уникальных реквизитов элемента
// Если ДляЭлемента = Истина, возвращаемая структура содержит реквизиты для проверки элемента
// Если ДляГруппы = Истина, аналогично для группы
// Возвращаемая структура содержит строковые идентификаторы реквизитов или вложенные структуры для табличных частей
// Для реквизита значение структуры содержит число 1-Обязательный, 3-Уникальный
Функция ПолучитьОбязательныеРеквизиты(ДляЭлемента=Истина, ДляГруппы=Ложь) Экспорт
	ОбязательныеРеквизиты=Новый Структура();
	Возврат ОбязательныеРеквизиты;
КонецФункции

"}
},
{0,
{"Последовательность_фнмДоходыРасходы",0,0,"","Процедура ПередЗаписью()
	ДополнительныеСвойства.Вставить(""ПериодТекущийДокументСтарый"",Ссылка.Дата);
Конецпроцедуры

Процедура ОбработкаПроведения()
	НаборЗаписей_фнмДоходыИРасходы = Последовательности.фнмДоходыИРасходы.СоздатьНаборЗаписей();
	НаборЗаписей_фнмДоходыИРасходы.ИзменитьГраницуПоследовательности_фнмДоходыИРасходы(ЭтотОбъект,Отказ,РежимЗаписиДокумента.Проведение);		
КонецПроцедуры

Процедура ОбработкаУдаленияПроведения(Отказ)
	//+ #288 Иванов А.Б. 2016-12-19
	НаборЗаписей_фнмДоходыИРасходы = Последовательности.фнмДоходыИРасходы.СоздатьНаборЗаписей();
	НаборЗаписей_фнмДоходыИРасходы.ИзменитьГраницуПоследовательности_фнмДоходыИРасходы(ЭтотОбъект,Отказ,РежимЗаписиДокумента.ОтменаПроведения);
	//- #288 Иванов А.Б. 2016-12-19
	
КонецПроцедуры
"}
},
{0,
{"ЗаблокироватьДокОбъект",0,0,"Забл","УдалосьЗаблокировать = Ложь;
Попытка
	ДокОбъект.Заблокировать();
	УдалосьЗаблокировать = Истина;
Исключение
	УдалосьЗаблокировать = Ложь;
КонецПопытки;
Если НЕ УдалосьЗаблокировать Тогда 
	Сообщить(""-------------ОШИБКА! Не удалось заблокировать документ ""+ДокОбъект);
	Продолжить;
Конецесли;
<?>"}
},
{0,
{"ВыполнитьОбновление",0,0,"","
Процедура КнопкаВыполнитьНажатие(Кнопка)
	ВремяНачала=ТекущаяДата();

	ВыполнитьОбновление();
	
	ВремяКонца=ТекущаяДата();
	Сообщить(""------------------------------------------------------------------"");
	Сообщить(""ВремяНачала -""+ВремяНачала);
	Сообщить(""ВремяКонца  -""+ВремяКонца);
	Сообщить(""Общее время выполнения - ""+ОКР(((ВремяКонца-ВремяНачала)/60),2) +"" мин."");
	Сообщить(""------------------------------------------------------------------"");	
КонецПроцедуры

Процедура ВыполнитьОбновление()
	Отказ = Ложь;
	
	Запрос = Новый Запрос;
	Запрос.Текст = 
	""ВЫБРАТЬ
	|	фнмСервисныйКонтракт.Ссылка
	|ИЗ
	|	Документ.фнмСервисныйКонтракт КАК фнмСервисныйКонтракт
	|ГДЕ
	|	фнмСервисныйКонтракт.ХозОперация = &ХозОперацияПустаяСсылка
	|
	|УПОРЯДОЧИТЬ ПО
	|	фнмСервисныйКонтракт.Дата"";
	
	Запрос.УстановитьПараметр(""ХозОперацияПустаяСсылка"",Справочники.ХозОперации.ПустаяСсылка());
	РезультатЗапроса = Запрос.Выполнить();
	
	
	
	Выборка = РезультатЗапроса.Выбрать();
	ВсегоСтрок = Выборка.Количество();
	НС = 1;	
	Пока Выборка.Следующий() Цикл
		ОбработкаПрерыванияПользователя();
		
		СсылкаНаДокумент = Выборка.Ссылка;
		#Если Тромбон тогда
			СсылкаНаДокумент = Документы.фнмСервисныйКонтракт.ПустаяСсылка();
		#Конецесли		
		ДокОбъект = СсылкаНаДокумент.ПолучитьОбъект();
		
		//УдалосьЗаблокировать = Ложь;
		//Попытка
		//	ДокОбъект.Заблокировать();
		//	УдалосьЗаблокировать = Истина;
		//Исключение
		//	УдалосьЗаблокировать = Ложь;
		//КонецПопытки;
		//Если НЕ УдалосьЗаблокировать Тогда 
		//	Сообщить(""-------------ОШИБКА! Не удалось заблокировать документ ""+ДокОбъект);
		//	Продолжить;
		//Конецесли;
		
		ДокОбъект.ОбменДанными.Загрузка = Истина;
		ДокОбъект.ДополнительныеСвойства.Вставить(""фнмЭтоОбработка"",Истина);
		//ДокОбъект.ДополнительныеСвойства.Вставить(""фнмЭтоОбработка_ГраницаЗакрытогоПериода"",Истина);
		//ДокОбъект.ДополнительныеСвойства.Вставить(""фнмНеВыполнятьПроверкуСуммыИсточникаИОснования"",Истина);
		
		Сообщить(""Обработан ""+ ДокОбъект);		
		НС = НС+1;
		Состояние(""Обработано НС ""+НС + "" из ""+ВсегоСтрок);
	КонецЦикла;
	
КонецПроцедуры 
"}
},
{0,
{"ТипЗнч",0,0,"Тип[Знч]","ТипЗнч<?""ИмяЭлемента""> = ТипЗнч(<?""ИмяЭлемента"">);	

Если ТипЗнч<?""ИмяЭлемента""> = Тип(<?>) тогда
	
Конецесли;	

"}
},
{0,
{"СкопироватьВБуферОбмена",0,0,"","Функция УстановитьТекстВБуферОбмена(Текст)
#Если Клиент Тогда 
    ЭлементыФормы.Добавить(Тип(""ПолеHTMLДокумента""), ""ПолеHTMLtest"", Ложь); 
    ОкноТест = ЭлементыФормы.ПолеHTMLtest.Документ.ParentWindow; 
    ОкноТест.ClipboardData.SetData(""Text"", Текст); 
	ЭлементыФормы.Удалить(ЭлементыФормы.Индекс(ЭлементыФормы.Найти(""ПолеHTMLtest""))); 
    Сообщить(""UID скопирован в буфер обмена"");
#КонецЕсли 
КонецФункции

//ДляУпрФорм

&НаКлиенте
Процедура КомандаСкопироватьВБуферОбмена(Команда)
	//КомандаСкопироватьВБуферОбменаНаСервере();
	ТекстДляБуфера = ""Тест123"";
	
	ОбъектКопирования = Новый COMОбъект(""htmlfile""); 
	ОбъектКопирования.ParentWindow.ClipboardData.SetData(""Text"", ТекстДляБуфера);		
КонецПроцедуры

Функция ПолучитьТекстБуфераОбмена() Экспорт
#Если Клиент Тогда
    Объект = Новый COMОбъект(""htmlfile"");
    Возврат Объект.ParentWindow.ClipboardData.Getdata(""Text"");
#КонецЕсли
КонецФункции
 
Функция УстановитьТекстВБуферОбмена(Текст) Экспорт
#Если Клиент Тогда 
    Объект = Новый COMОбъект(""htmlfile"");
    Объект.ParentWindow.ClipboardData.Setdata(""Text"", Текст);
    Возврат Текст;
#КонецЕсли 
КонецФункции  "}
},
{0,
{"ПроведениеСЗамеромПроизводительности",0,0,"","	СетевоеИмяКомпьютера = ИмяКомпьютера(); 
	ТекПользователь = ПараметрыСеанса.ТекущийПользователь;
	ДокОбъект = СсылкаНаДокумент.ПолучитьОбъект();
	
	ДатаНачалаМС = ТекущаяУниверсальнаяДатаВМиллисекундах();
	ДокОбъект.Записать(РежимЗаписиДокумента.Проведение);
	ДатаОкончанияМС = ТекущаяУниверсальнаяДатаВМиллисекундах();
	
	КоличествоМСДляПроведения = ДатаОкончанияМС - ДатаНачалаМС;
	КоличествоМинутДляПроведения = Окр((КоличествоМСДляПроведения/1000)/60,2);
	
	КоличествоМСДляПроведения = Формат(КоличествоМСДляПроведения,""ЧГ=0"");
	
	ИмяДокумента = СсылкаНаДокумент.Метаданные().Имя;
	пНомер = СокрЛП(СсылкаНаДокумент.Номер);
	пДатаДокумента = Формат(СсылкаНаДокумент.Дата,""ДФ=dd.MM.yyyy"");
	Сообщить(""Для проведения потребовалось ""+ КоличествоМСДляПроведения+""(мс)"" 
		+ "" это ""+КоличествоМинутДляПроведения + ""(мин)""
		+""   ;ТехИнформация;""
		+ ""КоличествоМС;"" + КоличествоМСДляПроведения+"";"" 
		+ ""Документ;""+ИмяДокумента+"";""
		+ ""Номер;""+пНомер+"";""
		+ ""Дата;""+пДатаДокумента+"";""
		+ ""ИмяКомпьютера;""+СетевоеИмяКомпьютера+"";""
		+ ""Пользователь;""+ТекПользователь+"";"");
"}
},
{0,
{"КакПроверитьСвойствоУЛюбогоОбъекта",0,0,"","Функция ПеременнаяСодержитСвойство(Переменная, ИмяСвойства)
	// Инициализируем структуру для теста с ключом (значение переменной ""ИмяСвойства"") и значением NULL
	СтруктураПроверка = Новый Структура;
	СтруктураПроверка.Вставить(ИмяСвойства, NULL);
	// Заполняем созданную структуру из переданного значения переменной
	ЗаполнитьЗначенияСвойств(СтруктураПроверка, Переменная);
	// Если значение для свойства структуры осталось NULL, то искомое свойство не найдено, и наоборот.
	Если СтруктураПроверка[ИмяСвойства]= NULL Тогда
		Возврат Ложь;
	Иначе
		Возврат Истина;
	КонецЕсли;
КонецФункции"}
},
{0,
{"Запрос",0,0,"Запр[ос]","
Запрос = Новый Запрос;
Запрос.Текст = ПолучитьТекстЗапроса();

Запрос.УстановитьПараметр("""",);

РезультатЗапроса = Запрос.Выполнить();

Если РезультатЗапроса.Пустой() Тогда
	Возврат;
КонецЕсли;

Выборка = РезультатЗапроса.Выбрать();

Пока Выборка.Следующий() Цикл
	<?> = Выборка.Ссылка;
КонецЦикла;

"}
},
{0,
{"Как определить ссылка пустая через COM",0,0,"","//Сам метод ПеременнаяСодержитСвойство
//в ОМ ОбщегоНазначения
//у Ссылки есть ли свойство ссылка"}
},
{0,
{"Расшифровка ТЗ и сохранение ТЗ в Excel",0,0,"","ТабДокумент = Новый ТабличныйДокумент;

Построитель = Новый ПостроительОтчета();

Построитель.ИсточникДанных = Новый ОписаниеИсточникаДанных(ТЗРезультат);
Построитель.ВыводитьЗаголовокОтчета = Ложь;
Построитель.Вывести(ТабДокумент );

ИмяФайла = ""ДаннныеОПродажах_""+Формат(ТекущаяДата(),""ДФ=ddMMyyyy_hhmmss"")+"".xls"";

ПолноеИмяФайла = ""D:\Documents\Ivanov\#862 Изменение в упр.учете2017\#2757 Сформировать выгрузку для Буркова 270318\""+ ИмяФайла;

ТабДокумент.Записать(ИмяФайла,ТипФайлаТабличногоДокумента.XLSX);	

Сообщить(""Сохранен ""+ИмяФайла);

ТабДокумент.Показать(ИмяФайла);
"}
},
{0,
{"+""",0,0,"+""","+ "" [""+ +""]""

"}
},
{0,
{"ВыбратьВсеЧисловыеРеквизитыВТЧ",0,0,"","ТипЧисло = Тип(""Число"");
МассивРеквизитовВзносы = Новый Массив();
РеквизитыТЧ = Метаданные.Документы.ОтражениеЗарплатыВБухучете.ТабличныеЧасти.НачисленнаяЗарплатаИВзносы.Реквизиты;
Для каждого Реквизит из РеквизитыТЧ цикл
	Если Реквизит.Тип.Типы().Найти(ТипЧисло) = Неопределено Тогда
		Продолжить;
	Конецесли;
	
	Если Реквизит.Имя = ""Сумма"" Тогда
		Продолжить;
	Конецесли;
	
	МассивРеквизитовВзносы.Добавить(Реквизит.Имя);
Конеццикла;"}
},
{0,
{"НСтр",0,0,"НСтр","ТекстСообщения = НСтр(""ru = 'Ошибка! [%1] '"");
ТекстСообщения = СтрШаблон(ТекстСообщения,<?>);"}
},
{0,
{"ИмяЗначенияПеречисленияЧерез COM",0,0,"","ИмяЗначенияПеречисления = СоединениеСОМ.XMLСтрока(СсылкаНаПеречисление)"}
},
{0,
{"КонецЕ",0,0,"Кон","КонецЕсли;"}
},
{0,
{"HTMLТаблицаПоТЗ",0,0,"","Функция АЛП_ПолучитьТаблицуЭтаповИОбъектовHTML(ТаблицаОбъектов) 
	
	ТаблицуЭтаповИОбъектовHTML = """";
		
	ТекстШапки = ""<style>table {border: solid 1px blue; border-collapse: collapse}	td {border: solid 1px blue;}</style>"";
	ТекстШапки = ТекстШапки + ""<table><tr style=""""background-color:#eeeeee;font-family:Tahoma;""
		+""font-weight:bold;text-align:center""""><td>Дата автосогласования</td><td>Наименование объекта</td>""
		+""<td>Ссылка на объект</td><td>Наименование этапа согласования</td><td>Ответственный/Роль</td></tr>"";
	Инд = 0;
	Текст = """";
	Для каждого СтрокаТаблицаОбъектов из ТаблицаОбъектов Цикл
		
		Если Текст = """" Тогда
			Текст = ТекстШапки;
		КонецЕсли;
		
		Текст = Текст + ""
						|<tr style=""""""; 
		Текст = Текст + ?(ОбщегоНазначенияУХ.ЧетноеЧисло(Инд), ""background-color:#eeeeee;"", """");
		Текст = Текст + ""font-family:Tahoma""""><td>"";
		Текст = Текст + СтрокаТаблицаОбъектов.ДатаАвтосогласования;
		Текст = Текст + ""</td><td>"";
		Текст = Текст + СтрокаТаблицаОбъектов.НаименованиеОбъекта;
		Текст = Текст + ""</td><td>"";
		Текст = Текст + СтрокаТаблицаОбъектов.Ссылка;
		Текст = Текст + ""</td><td>"";
		Текст = Текст + СтрокаТаблицаОбъектов.ЭтапПроцесса;
		Текст = Текст + ""</td><td>"";
		Текст = Текст + СтрокаТаблицаОбъектов.Пользователь;
		Текст = Текст + ""</td>"";
		Текст = Текст + ""</tr>"";
		
		Инд = Инд + 1;
	КонецЦикла;
	Текст = Текст + ""</table>"";
	ТаблицуЭтаповИОбъектовHTML = Текст;
	
	//ТаблицуЭтаповИОбъектовHTML = СтрЗаменить(ТаблицуЭтаповИОбъектовHTML, ""<a href = e1cib"", ""<a href = '#e1cib"");
	
	Возврат ТаблицуЭтаповИОбъектовHTML;
	
КонецФункции"}
}
}
}